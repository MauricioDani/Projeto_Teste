/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { NgForm } from '@angular/forms';
import { ActivatedRoute, Router } from '@angular/router';
import { ChangeDetectorRef, Component, IterableDiffers, ViewChild, ViewContainerRef } from '@angular/core';
import { isExternalLink } from '../../utils/util';
import { ThfComponentInjectorService } from '@totvs/thf-ui';
import { ThfModalPasswordRecoveryComponent } from '../thf-modal-password-recovery/thf-modal-password-recovery.component';
import { ThfModalPasswordRecoveryType } from '../thf-modal-password-recovery/enums/thf-modal-password-recovery-type.enum';
import { ThfPageLoginBaseComponent } from './thf-page-login-base.component';
import { ThfPageLoginService } from './thf-page-login.service';
/**
 * \@docsExtends ThfPageLoginBaseComponent
 *
 * \@example
 *
 * <example name="thf-page-login-basic" title="Totvs Page Login Basic">
 *  <file name="sample-thf-page-login-basic/sample-thf-page-login-basic.component.html"> </file>
 *  <file name="sample-thf-page-login-basic/sample-thf-page-login-basic.component.ts"> </file>
 * </example>
 *
 * <example name="thf-page-login-labs" title="Totvs Page Login Labs">
 *  <file name="sample-thf-page-login-labs/sample-thf-page-login-labs.component.html"> </file>
 *  <file name="sample-thf-page-login-labs/sample-thf-page-login-labs.component.ts"> </file>
 * </example>
 *
 * <example name="thf-page-login-human-resources" title="Totvs Page Login - Human Resources">
 *  <file name="sample-thf-page-login-human-resources/sample-thf-page-login-human-resources.component.html"> </file>
 *  <file name="sample-thf-page-login-human-resources/sample-thf-page-login-human-resources.component.ts"> </file>
 *  <file name="sample-thf-page-login-human-resources/sample-thf-page-login-human-resources.module.ts"> </file>
 * </example>
 *
 * <example name="thf-page-login-automatic-service" title="Totvs Page Login - Automatic Service">
 *  <file name="sample-thf-page-login-automatic-service/sample-thf-page-login-automatic-service.component.html"> </file>
 *  <file name="sample-thf-page-login-automatic-service/sample-thf-page-login-automatic-service.component.ts"> </file>
 * </example>
 */
var ThfPageLoginComponent = /** @class */ (function (_super) {
    tslib_1.__extends(ThfPageLoginComponent, _super);
    function ThfPageLoginComponent(changeDetector, activatedRoute, thfComponentInjector, differs, loginService, router) {
        var _this = _super.call(this, loginService, router) || this;
        _this.changeDetector = changeDetector;
        _this.activatedRoute = activatedRoute;
        _this.thfComponentInjector = thfComponentInjector;
        _this.componentRef = null;
        _this.customPasswordError = { custom: false };
        _this.differ = differs.find([]).create(null);
        return _this;
    }
    /**
     * @return {?}
     */
    ThfPageLoginComponent.prototype.ngAfterViewChecked = /**
     * @return {?}
     */
    function () {
        if (this.differ) {
            this.validateArrayChanges(this.differ, [
                { array: this.loginErrors, callback: this.generateLoginError.bind(this) },
                { array: this.passwordErrors, callback: this.generatePasswordError.bind(this) }
            ]);
        }
    };
    /**
     * @return {?}
     */
    ThfPageLoginComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.checkingForRouteMetadata(this.activatedRoute.snapshot.data);
    };
    /**
     * @return {?}
     */
    ThfPageLoginComponent.prototype.changeLoginModel = /**
     * @return {?}
     */
    function () {
        if (this.authenticationUrl) {
            this.loginErrors = [];
        }
        else {
            this.setLoginErrors(this.loginErrors);
            this.loginChange.emit(this.login);
        }
    };
    /**
     * @return {?}
     */
    ThfPageLoginComponent.prototype.changePasswordModel = /**
     * @return {?}
     */
    function () {
        if (this.authenticationUrl) {
            this.passwordErrors = [];
        }
        else {
            this.setPasswordErrors(this.passwordErrors);
            this.passwordChange.emit(this.password);
        }
    };
    /**
     * @private
     * @param {?} object
     * @param {?} property
     * @return {?}
     */
    ThfPageLoginComponent.prototype.checkingForMetadataProperty = /**
     * @private
     * @param {?} object
     * @param {?} property
     * @return {?}
     */
    function (object, property) {
        if (Object.prototype.hasOwnProperty.call(object, property)) {
            return object[property];
        }
    };
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    ThfPageLoginComponent.prototype.checkingForRouteMetadata = /**
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (Object.keys(data).length !== 0) {
            this.authenticationUrl = this.checkingForMetadataProperty(data, 'serviceApi') || this.authenticationUrl;
            this.authenticationType = this.checkingForMetadataProperty(data, 'authenticationType') || this.authenticationType;
            this.environment = this.checkingForMetadataProperty(data, 'environment') || this.environment;
            this.recovery = this.checkingForMetadataProperty(data, 'recovery') || this.recovery;
            this.registerUrl = this.checkingForMetadataProperty(data, 'registerUrl') || this.registerUrl;
        }
    };
    /**
     * @private
     * @param {?} thfPageLoginRecovery
     * @return {?}
     */
    ThfPageLoginComponent.prototype.createModalPasswordRecoveryComponent = /**
     * @private
     * @param {?} thfPageLoginRecovery
     * @return {?}
     */
    function (thfPageLoginRecovery) {
        var _this = this;
        if (this.componentRef) {
            this.thfComponentInjector.destroyComponentInApplication(this.componentRef);
        }
        this.componentRef = this.thfComponentInjector.createComponentInApplication(ThfModalPasswordRecoveryComponent);
        this.componentRef.instance.urlRecovery = thfPageLoginRecovery.url;
        this.componentRef.instance.contactEmail = thfPageLoginRecovery.contactMail;
        this.componentRef.instance.phoneMask = thfPageLoginRecovery.phoneMask;
        this.componentRef.instance.type = thfPageLoginRecovery.type || ThfModalPasswordRecoveryType.Email;
        this.componentRef.changeDetectorRef.detectChanges();
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.componentRef.instance.open();
        }));
    };
    /**
     * @private
     * @return {?}
     */
    ThfPageLoginComponent.prototype.generateLoginError = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.loginErrors && this.loginErrors.length) {
            this.setLoginErrors(this.loginErrors);
        }
        else {
            /** @type {?} */
            var control = this.loginForm.form.controls['login'];
            if (control) {
                this.resetControl(control);
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    ThfPageLoginComponent.prototype.generatePasswordError = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.passwordErrors && this.passwordErrors.length) {
            this.setPasswordErrors(this.passwordErrors);
        }
        else {
            /** @type {?} */
            var control = this.loginForm.form.controls['password'];
            if (control) {
                this.resetControl(control);
            }
        }
    };
    /**
     * @private
     * @param {?} control
     * @return {?}
     */
    ThfPageLoginComponent.prototype.resetControl = /**
     * @private
     * @param {?} control
     * @return {?}
     */
    function (control) {
        control.markAsPristine();
        control.markAsUntouched();
        control.updateValueAndValidity();
    };
    /**
     * @private
     * @param {?} allErrors
     * @param {?} control
     * @param {?} errors
     * @param {?} patternError
     * @return {?}
     */
    ThfPageLoginComponent.prototype.setControlErrors = /**
     * @private
     * @param {?} allErrors
     * @param {?} control
     * @param {?} errors
     * @param {?} patternError
     * @return {?}
     */
    function (allErrors, control, errors, patternError) {
        if (control) {
            this[allErrors] = control.hasError('pattern') ? tslib_1.__spread(errors, [patternError]) : tslib_1.__spread(errors);
            if (errors && errors.length && (control.valid || control.pristine)) {
                control.markAsTouched();
                control.markAsDirty();
                control.setErrors(this.customPasswordError);
            }
        }
    };
    /**
     * @private
     * @param {?} url
     * @return {?}
     */
    ThfPageLoginComponent.prototype.setUrlRedirect = /**
     * @private
     * @param {?} url
     * @return {?}
     */
    function (url) {
        isExternalLink(url) ? window.open(url, '_blank') : this.router.navigate([url]);
    };
    /**
     * @private
     * @param {?} differ
     * @param {?} array
     * @return {?}
     */
    ThfPageLoginComponent.prototype.validateArrayChanges = /**
     * @private
     * @param {?} differ
     * @param {?} array
     * @return {?}
     */
    function (differ, array) {
        var _this = this;
        array.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            /** @type {?} */
            var changes = differ.diff(element.array);
            if (changes) {
                element.callback();
                _this.changeDetector.detectChanges();
            }
        }));
    };
    /**
     * @protected
     * @param {?} recovery
     * @return {?}
     */
    ThfPageLoginComponent.prototype.openUrl = /**
     * @protected
     * @param {?} recovery
     * @return {?}
     */
    function (recovery) {
        switch (typeof recovery) {
            case 'string': {
                this.setUrlRedirect(recovery);
                break;
            }
            case 'function': {
                recovery();
                break;
            }
            case 'object': {
                this.createModalPasswordRecoveryComponent(recovery);
                break;
            }
        }
    };
    /**
     * @protected
     * @param {?} errors
     * @return {?}
     */
    ThfPageLoginComponent.prototype.setLoginErrors = /**
     * @protected
     * @param {?} errors
     * @return {?}
     */
    function (errors) {
        /** @type {?} */
        var control = this.loginForm.form.controls['login'];
        this.setControlErrors('allLoginErrors', control, errors, this.literals.loginErrorPattern);
    };
    /**
     * @protected
     * @param {?} errors
     * @return {?}
     */
    ThfPageLoginComponent.prototype.setPasswordErrors = /**
     * @protected
     * @param {?} errors
     * @return {?}
     */
    function (errors) {
        /** @type {?} */
        var control = this.loginForm.form.controls['password'];
        this.setControlErrors('allPasswordErrors', control, errors, this.literals.passwordErrorPattern);
    };
    /**
     * @param {?} language
     * @return {?}
     */
    ThfPageLoginComponent.prototype.onSelectedLanguage = /**
     * @param {?} language
     * @return {?}
     */
    function (language) {
        this.selectedLanguage = language;
        this.getLiterals(language, this.containsCustomLiterals ? this.customizedDefaultLiterals : undefined);
        this.setTitleLiteral(language, this.productName);
        this.setLoginHintLiteral(language, this.contactEmail);
    };
    ThfPageLoginComponent.decorators = [
        { type: Component, args: [{
                    selector: 'thf-page-login',
                    template: "<thf-page-background #pageLogin\n  t-show-select-language\n  [t-background]=\"background\"\n  [t-highlight-info]=\"literals.highlightInfo\"\n  [t-logo]=\"logo\"\n  [t-secondary-logo]=\"secondaryLogo\"\n  (t-selected-language)=\"onSelectedLanguage($event)\">\n\n  <div class=\"thf-page-login-header thf-mb-2 thf-mb-sm-1 thf-pt-sm-1\">\n    <div class=\"thf-page-login-header-title thf-mb-sm-1\">{{ literals.title }}</div>\n    <thf-tag\n      *ngIf=\"environment\"\n      t-type=\"warning\"\n      [t-value]=\"environment\">\n    </thf-tag>\n  </div>\n\n  <form #loginForm=\"ngForm\" class=\"thf-page-login-form\">\n    <div class=\"thf-row\">\n      <div class=\"thf-lg-12\">\n        <div class=\"thf-page-login-hint thf-page-login-info-container\">\n          <thf-login\n            class=\"thf-page-login-info-field\"\n            name=\"login\"\n            [(ngModel)]=\"login\"\n            t-focus\n            t-required\n            [t-label]=\"literals.loginLabel\"\n            [t-pattern]=\"loginPattern\"\n            [t-placeholder]=\"literals.loginPlaceholder\"\n            (click)=\"closePopover()\"\n            (keyup.enter)=\"loginForm.valid && onLoginSubmit()\"\n            (t-change-model)=\"changeLoginModel()\">\n          </thf-login>\n\n          <div class=\"thf-page-login-info-icon-container\">\n            <span\n              class=\"thf-icon thf-field-icon thf-icon-info\"\n              t-tooltip-position=\"right\"\n              [t-tooltip]=\"literals.loginHint\">\n            </span>\n          </div>\n        </div>\n\n        <div class=\"thf-field-container-bottom thf-field-container-error-container\">\n          <div *ngFor=\"let error of allLoginErrors\u001C\" class=\"thf-field-container-bottom-text-error thf-field-container-error-item\">\n            <span class=\"thf-icon thf-icon-exclamation\"></span>\n            <span class=\"thf-field-container-error-text\">{{error}}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"thf-lg-12\">\n        <div class=\"thf-page-login-password-container\">\n          <thf-password\n            class=\"thf-page-login-field-size thf-page-login-password-item\"\n            name=\"password\"\n            [(ngModel)]=\"password\"\n            t-required\n            [t-label]=\"literals.passwordLabel\"\n            [t-pattern]=\"passwordPattern\"\n            [t-placeholder]=\"literals.passwordPlaceholder\"\n            (click)=\"closePopover()\"\n            (keyup.enter)=\"loginForm.valid && onLoginSubmit()\"\n            (t-change-model)=\"changePasswordModel()\">\n          </thf-password>\n          <div class=\"thf-page-login-password-item thf-page-login-password-popover-container\">\n            <thf-page-login-popover *ngIf=\"showExceededAttemptsWarning && exceededAttemptsWarning\"\n              [t-recovery]=\"recovery\"\n              [t-remaining-attempts]=\"exceededAttemptsWarning\"\n              [t-selected-language]=\"selectedLanguage\"\n              (t-forgot-password) = \"openUrl($event)\">\n            </thf-page-login-popover>\n          </div>\n        </div>\n        <div class=\"thf-field-container-bottom thf-field-container-error-container\">\n          <div *ngFor=\"let error of allPasswordErrors\" class=\"thf-field-container-bottom-text-error thf-field-container-error-item\">\n            <span class=\"thf-icon thf-icon-exclamation\"></span>\n            <span class=\"thf-field-container-error-text\">{{error}}</span>\n          </div>\n        </div>\n      </div>\n\n      <thf-input *ngIf=\"customField && customFieldType === 'input'\"\n        class=\"thf-page-login-field-size thf-lg-12\"\n        name=\"customFieldInput\"\n        [(ngModel)]=\"customFieldObject.value\"\n        t-required\n        [t-error-pattern]=\"customFieldObject.errorPattern || literals.customFieldErrorPattern\"\n        [t-pattern]=\"customFieldObject.pattern\"\n        [t-placeholder]=\"customFieldObject.placeholder || literals.customFieldPlaceholder\"\n        (keyup.enter)=\"loginForm.valid && onLoginSubmit()\">\n      </thf-input>\n\n      <thf-combo *ngIf=\"customField && customFieldType === 'combo'\"\n        class=\"thf-page-login-field-size thf-lg-12\"\n        name=\"customFieldCombo\"\n        [(ngModel)]=\"customFieldObject.value\"\n        t-required\n        [t-field-value]=\"customFieldObject.fieldValue\"\n        [t-filter-service]=\"customFieldObject.url\"\n        [t-placeholder]=\"customFieldObject.placeholder || literals.customFieldPlaceholder\">\n      </thf-combo>\n\n      <thf-select *ngIf=\"customField && customFieldType === 'select'\"\n        class=\"thf-page-login-field-size thf-lg-12\"\n        name=\"customFieldSelect\"\n        [(ngModel)]=\"customFieldObject.value\"\n        t-required\n        [t-placeholder]=\"customFieldObject.placeholder || literals.customFieldPlaceholder\"\n        [t-options]=\"customFieldObject.options\">\n      </thf-select>\n\n      <div class=\"thf-lg-12\">\n        <div *ngIf=\"!hideRememberUser\" class=\"thf-page-login-hint thf-page-login-info-container\">\n          <thf-switch\n            class=\"thf-page-login-info-field thf-lg-7 thf-offset-lg-5 thf-offset-xl-5\"\n            name=\"rememberUser\"\n            [(ngModel)]=\"rememberUser\"\n            t-label-position=\"1\"\n            [t-label-off]=\"literals.rememberUser\"\n            [t-label-on]=\"literals.rememberUser\"\n            (keyup.enter)=\"loginForm.valid && onLoginSubmit()\">\n          </thf-switch>\n\n          <div class=\"thf-page-login-info-icon-container thf-page-login-info-icon-remember-user\">\n            <span\n              class=\"thf-icon thf-field-icon thf-icon-info\"\n              t-tooltip-position=\"right\"\n              [t-tooltip]=\"literals.rememberUserHint\">\n            </span>\n          </div>\n        </div>\n      </div>\n\n\n      <thf-button\n        class=\"thf-lg-12 thf-page-login-button thf-page-login-field-size\"\n        t-type=\"primary\"\n        [t-disabled]=\"loginForm.invalid\"\n        [t-label]=\"loading ? literals.submittedLabel : literals.submitLabel\"\n        [t-loading]=\"loading\"\n        (t-click)=\"onLoginSubmit()\">\n      </thf-button>\n\n      <div *ngIf=\"recovery\"\n        class=\"thf-page-login-recovery-link\">\n        <a class=\"thf-font-text-large-bold\" (click)=\"openUrl(recovery)\">{{ literals.forgotPassword }}</a>\n      </div>\n\n      <div *ngIf=\"registerUrl\"\n        class=\"thf-page-login-register-link\">\n        <a class=\"thf-font-text-large-bold\" (click)=\"openUrl(registerUrl)\">{{ literals.registerUrl }}</a>\n      </div>\n    </div>\n  </form>\n</thf-page-background>\n"
                }] }
    ];
    /** @nocollapse */
    ThfPageLoginComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef },
        { type: ActivatedRoute },
        { type: ThfComponentInjectorService },
        { type: IterableDiffers },
        { type: ThfPageLoginService },
        { type: Router }
    ]; };
    ThfPageLoginComponent.propDecorators = {
        loginForm: [{ type: ViewChild, args: ['loginForm', { read: NgForm, static: true },] }],
        pageLogin: [{ type: ViewChild, args: ['pageLogin', { read: ViewContainerRef, static: true },] }]
    };
    return ThfPageLoginComponent;
}(ThfPageLoginBaseComponent));
export { ThfPageLoginComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ThfPageLoginComponent.prototype.componentRef;
    /**
     * @type {?}
     * @private
     */
    ThfPageLoginComponent.prototype.differ;
    /**
     * @type {?}
     * @private
     */
    ThfPageLoginComponent.prototype.customPasswordError;
    /** @type {?} */
    ThfPageLoginComponent.prototype.loginForm;
    /** @type {?} */
    ThfPageLoginComponent.prototype.pageLogin;
    /** @type {?} */
    ThfPageLoginComponent.prototype.changeDetector;
    /**
     * @type {?}
     * @private
     */
    ThfPageLoginComponent.prototype.activatedRoute;
    /**
     * @type {?}
     * @private
     */
    ThfPageLoginComponent.prototype.thfComponentInjector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhmLXBhZ2UtbG9naW4uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRvdHZzL3RoZi10ZW1wbGF0ZXMvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90aGYtcGFnZS1sb2dpbi90aGYtcGFnZS1sb2dpbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQW1CLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekQsT0FBTyxFQUFvQixpQkFBaUIsRUFBRSxTQUFTLEVBQWdCLGVBQWUsRUFBVSxTQUFTLEVBQUUsZ0JBQWdCLEVBQzFILE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFNUQsT0FBTyxFQUFFLGlDQUFpQyxFQUFFLE1BQU0sc0VBQXNFLENBQUM7QUFDekgsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sNEVBQTRFLENBQUM7QUFDMUgsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFFNUUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTZCL0Q7SUFLMkMsaURBQXlCO0lBU2xFLCtCQUNTLGNBQWlDLEVBQ2hDLGNBQThCLEVBQzlCLG9CQUFpRCxFQUN6RCxPQUF3QixFQUN4QixZQUFpQyxFQUNqQyxNQUFjO1FBTmhCLFlBUUUsa0JBQU0sWUFBWSxFQUFFLE1BQU0sQ0FBQyxTQUU1QjtRQVRRLG9CQUFjLEdBQWQsY0FBYyxDQUFtQjtRQUNoQyxvQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDOUIsMEJBQW9CLEdBQXBCLG9CQUFvQixDQUE2QjtRQVZu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QU07Ozs0QkFtRDVCLFNBQVMsU0FBQyxXQUFXLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7NEJBQ3JELFNBQVMsU0FBQyxXQUFXLEVBQUUsRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTs7SUEwS2xFLDRCQUFDO0NBQUEsQUF0TEQsQ0FLMkMseUJBQXlCLEdBaUxuRTtTQWpMWSxxQkFBcUI7Ozs7OztJQUVoQyw2Q0FBK0M7Ozs7O0lBQy9DLHVDQUFvQjs7Ozs7SUFDcEIsb0RBQTBEOztJQUUxRCwwQ0FBMEU7O0lBQzFFLDBDQUE4Rjs7SUFHNUYsK0NBQXdDOzs7OztJQUN4QywrQ0FBc0M7Ozs7O0lBQ3RDLHFEQUF5RCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFic3RyYWN0Q29udHJvbCwgTmdGb3JtIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGUsIFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyBBZnRlclZpZXdDaGVja2VkLCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBDb21wb25lbnRSZWYsIEl0ZXJhYmxlRGlmZmVycywgT25Jbml0LCBWaWV3Q2hpbGQsIFZpZXdDb250YWluZXJSZWZcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IGlzRXh0ZXJuYWxMaW5rIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbCc7XG5pbXBvcnQgeyBUaGZDb21wb25lbnRJbmplY3RvclNlcnZpY2UgfSBmcm9tICdAdG90dnMvdGhmLXVpJztcblxuaW1wb3J0IHsgVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50IH0gZnJvbSAnLi4vdGhmLW1vZGFsLXBhc3N3b3JkLXJlY292ZXJ5L3RoZi1tb2RhbC1wYXNzd29yZC1yZWNvdmVyeS5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5VHlwZSB9IGZyb20gJy4uL3RoZi1tb2RhbC1wYXNzd29yZC1yZWNvdmVyeS9lbnVtcy90aGYtbW9kYWwtcGFzc3dvcmQtcmVjb3ZlcnktdHlwZS5lbnVtJztcbmltcG9ydCB7IFRoZlBhZ2VMb2dpbkJhc2VDb21wb25lbnQgfSBmcm9tICcuL3RoZi1wYWdlLWxvZ2luLWJhc2UuY29tcG9uZW50JztcbmltcG9ydCB7IFRoZlBhZ2VMb2dpblJlY292ZXJ5IH0gZnJvbSAnLi9pbnRlcmZhY2VzL3RoZi1wYWdlLWxvZ2luLXJlY292ZXJ5LmludGVyZmFjZSc7XG5pbXBvcnQgeyBUaGZQYWdlTG9naW5TZXJ2aWNlIH0gZnJvbSAnLi90aGYtcGFnZS1sb2dpbi5zZXJ2aWNlJztcblxuLyoqXG4gKiBAZG9jc0V4dGVuZHMgVGhmUGFnZUxvZ2luQmFzZUNvbXBvbmVudFxuICpcbiAqIEBleGFtcGxlXG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWxvZ2luLWJhc2ljXCIgdGl0bGU9XCJUb3R2cyBQYWdlIExvZ2luIEJhc2ljXCI+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS10aGYtcGFnZS1sb2dpbi1iYXNpYy9zYW1wbGUtdGhmLXBhZ2UtbG9naW4tYmFzaWMuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtbG9naW4tYmFzaWMvc2FtcGxlLXRoZi1wYWdlLWxvZ2luLWJhc2ljLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWxvZ2luLWxhYnNcIiB0aXRsZT1cIlRvdHZzIFBhZ2UgTG9naW4gTGFic1wiPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtbG9naW4tbGFicy9zYW1wbGUtdGhmLXBhZ2UtbG9naW4tbGFicy5jb21wb25lbnQuaHRtbFwiPiA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS10aGYtcGFnZS1sb2dpbi1sYWJzL3NhbXBsZS10aGYtcGFnZS1sb2dpbi1sYWJzLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWxvZ2luLWh1bWFuLXJlc291cmNlc1wiIHRpdGxlPVwiVG90dnMgUGFnZSBMb2dpbiAtIEh1bWFuIFJlc291cmNlc1wiPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtbG9naW4taHVtYW4tcmVzb3VyY2VzL3NhbXBsZS10aGYtcGFnZS1sb2dpbi1odW1hbi1yZXNvdXJjZXMuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtbG9naW4taHVtYW4tcmVzb3VyY2VzL3NhbXBsZS10aGYtcGFnZS1sb2dpbi1odW1hbi1yZXNvdXJjZXMuY29tcG9uZW50LnRzXCI+IDwvZmlsZT5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXRoZi1wYWdlLWxvZ2luLWh1bWFuLXJlc291cmNlcy9zYW1wbGUtdGhmLXBhZ2UtbG9naW4taHVtYW4tcmVzb3VyY2VzLm1vZHVsZS50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWxvZ2luLWF1dG9tYXRpYy1zZXJ2aWNlXCIgdGl0bGU9XCJUb3R2cyBQYWdlIExvZ2luIC0gQXV0b21hdGljIFNlcnZpY2VcIj5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXRoZi1wYWdlLWxvZ2luLWF1dG9tYXRpYy1zZXJ2aWNlL3NhbXBsZS10aGYtcGFnZS1sb2dpbi1hdXRvbWF0aWMtc2VydmljZS5jb21wb25lbnQuaHRtbFwiPiA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS10aGYtcGFnZS1sb2dpbi1hdXRvbWF0aWMtc2VydmljZS9zYW1wbGUtdGhmLXBhZ2UtbG9naW4tYXV0b21hdGljLXNlcnZpY2UuY29tcG9uZW50LnRzXCI+IDwvZmlsZT5cbiAqIDwvZXhhbXBsZT5cbiAqL1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0aGYtcGFnZS1sb2dpbicsXG4gIHRlbXBsYXRlVXJsOiAnLi90aGYtcGFnZS1sb2dpbi5jb21wb25lbnQuaHRtbCdcbn0pXG5cbmV4cG9ydCBjbGFzcyBUaGZQYWdlTG9naW5Db21wb25lbnQgZXh0ZW5kcyBUaGZQYWdlTG9naW5CYXNlQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3Q2hlY2tlZCwgT25Jbml0IHtcblxuICBwcml2YXRlIGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPGFueT4gPSBudWxsO1xuICBwcml2YXRlIGRpZmZlcjogYW55O1xuICBwcml2YXRlIHJlYWRvbmx5IGN1c3RvbVBhc3N3b3JkRXJyb3IgPSB7IGN1c3RvbSA6IGZhbHNlIH07XG5cbiAgQFZpZXdDaGlsZCgnbG9naW5Gb3JtJywgeyByZWFkOiBOZ0Zvcm0sIHN0YXRpYzogdHJ1ZSB9KSBsb2dpbkZvcm06IE5nRm9ybTtcbiAgQFZpZXdDaGlsZCgncGFnZUxvZ2luJywgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmLCBzdGF0aWM6IHRydWUgfSkgcGFnZUxvZ2luOiBWaWV3Q29udGFpbmVyUmVmO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBjaGFuZ2VEZXRlY3RvcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgcHJpdmF0ZSBhY3RpdmF0ZWRSb3V0ZTogQWN0aXZhdGVkUm91dGUsXG4gICAgcHJpdmF0ZSB0aGZDb21wb25lbnRJbmplY3RvcjogVGhmQ29tcG9uZW50SW5qZWN0b3JTZXJ2aWNlLFxuICAgIGRpZmZlcnM6IEl0ZXJhYmxlRGlmZmVycyxcbiAgICBsb2dpblNlcnZpY2U6IFRoZlBhZ2VMb2dpblNlcnZpY2UsXG4gICAgcm91dGVyOiBSb3V0ZXIsXG4gICAgKSB7XG4gICAgc3VwZXIobG9naW5TZXJ2aWNlLCByb3V0ZXIpO1xuICAgIHRoaXMuZGlmZmVyID0gZGlmZmVycy5maW5kKFtdKS5jcmVhdGUobnVsbCk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XG4gICAgaWYgKHRoaXMuZGlmZmVyKSB7XG4gICAgICB0aGlzLnZhbGlkYXRlQXJyYXlDaGFuZ2VzKHRoaXMuZGlmZmVyLCBbXG4gICAgICAgIHsgYXJyYXk6IHRoaXMubG9naW5FcnJvcnMsIGNhbGxiYWNrOiB0aGlzLmdlbmVyYXRlTG9naW5FcnJvci5iaW5kKHRoaXMpIH0sXG4gICAgICAgIHsgYXJyYXk6IHRoaXMucGFzc3dvcmRFcnJvcnMsIGNhbGxiYWNrOiB0aGlzLmdlbmVyYXRlUGFzc3dvcmRFcnJvci5iaW5kKHRoaXMpIH1cbiAgICAgIF0pO1xuICAgIH1cbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuY2hlY2tpbmdGb3JSb3V0ZU1ldGFkYXRhKHRoaXMuYWN0aXZhdGVkUm91dGUuc25hcHNob3QuZGF0YSk7XG4gIH1cblxuICBjaGFuZ2VMb2dpbk1vZGVsKCkge1xuICAgIGlmICh0aGlzLmF1dGhlbnRpY2F0aW9uVXJsKSB7XG4gICAgICB0aGlzLmxvZ2luRXJyb3JzID0gW107XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0TG9naW5FcnJvcnModGhpcy5sb2dpbkVycm9ycyk7XG4gICAgICB0aGlzLmxvZ2luQ2hhbmdlLmVtaXQodGhpcy5sb2dpbik7XG4gICAgfVxuICB9XG5cbiAgY2hhbmdlUGFzc3dvcmRNb2RlbCgpIHtcbiAgICBpZiAodGhpcy5hdXRoZW50aWNhdGlvblVybCkge1xuICAgICAgdGhpcy5wYXNzd29yZEVycm9ycyA9IFtdO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldFBhc3N3b3JkRXJyb3JzKHRoaXMucGFzc3dvcmRFcnJvcnMpO1xuICAgICAgdGhpcy5wYXNzd29yZENoYW5nZS5lbWl0KHRoaXMucGFzc3dvcmQpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tpbmdGb3JNZXRhZGF0YVByb3BlcnR5KG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7XG4gICAgICByZXR1cm4gb2JqZWN0W3Byb3BlcnR5XTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNoZWNraW5nRm9yUm91dGVNZXRhZGF0YShkYXRhKSB7XG4gICAgaWYgKE9iamVjdC5rZXlzKGRhdGEpLmxlbmd0aCAhPT0gMCkge1xuICAgICAgdGhpcy5hdXRoZW50aWNhdGlvblVybCA9IHRoaXMuY2hlY2tpbmdGb3JNZXRhZGF0YVByb3BlcnR5KGRhdGEsICdzZXJ2aWNlQXBpJykgfHwgdGhpcy5hdXRoZW50aWNhdGlvblVybDtcbiAgICAgIHRoaXMuYXV0aGVudGljYXRpb25UeXBlID0gdGhpcy5jaGVja2luZ0Zvck1ldGFkYXRhUHJvcGVydHkoZGF0YSwgJ2F1dGhlbnRpY2F0aW9uVHlwZScpIHx8IHRoaXMuYXV0aGVudGljYXRpb25UeXBlO1xuICAgICAgdGhpcy5lbnZpcm9ubWVudCA9IHRoaXMuY2hlY2tpbmdGb3JNZXRhZGF0YVByb3BlcnR5KGRhdGEsICdlbnZpcm9ubWVudCcpIHx8IHRoaXMuZW52aXJvbm1lbnQ7XG4gICAgICB0aGlzLnJlY292ZXJ5ID0gdGhpcy5jaGVja2luZ0Zvck1ldGFkYXRhUHJvcGVydHkoZGF0YSwgJ3JlY292ZXJ5JykgfHwgdGhpcy5yZWNvdmVyeTtcbiAgICAgIHRoaXMucmVnaXN0ZXJVcmwgPSB0aGlzLmNoZWNraW5nRm9yTWV0YWRhdGFQcm9wZXJ0eShkYXRhLCAncmVnaXN0ZXJVcmwnKSB8fCB0aGlzLnJlZ2lzdGVyVXJsO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KHRoZlBhZ2VMb2dpblJlY292ZXJ5OiBUaGZQYWdlTG9naW5SZWNvdmVyeSkge1xuICAgIGlmICh0aGlzLmNvbXBvbmVudFJlZikge1xuICAgICAgdGhpcy50aGZDb21wb25lbnRJbmplY3Rvci5kZXN0cm95Q29tcG9uZW50SW5BcHBsaWNhdGlvbih0aGlzLmNvbXBvbmVudFJlZik7XG4gICAgfVxuXG4gICAgdGhpcy5jb21wb25lbnRSZWYgPSB0aGlzLnRoZkNvbXBvbmVudEluamVjdG9yLmNyZWF0ZUNvbXBvbmVudEluQXBwbGljYXRpb24oVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KTtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS51cmxSZWNvdmVyeSA9IHRoZlBhZ2VMb2dpblJlY292ZXJ5LnVybDtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5jb250YWN0RW1haWwgPSB0aGZQYWdlTG9naW5SZWNvdmVyeS5jb250YWN0TWFpbDtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5waG9uZU1hc2sgPSB0aGZQYWdlTG9naW5SZWNvdmVyeS5waG9uZU1hc2s7XG4gICAgdGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UudHlwZSA9IHRoZlBhZ2VMb2dpblJlY292ZXJ5LnR5cGUgfHwgVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5VHlwZS5FbWFpbDtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5vcGVuKCk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlTG9naW5FcnJvcigpIHtcbiAgICBpZiAodGhpcy5sb2dpbkVycm9ycyAmJiB0aGlzLmxvZ2luRXJyb3JzLmxlbmd0aCkge1xuICAgICAgdGhpcy5zZXRMb2dpbkVycm9ycyh0aGlzLmxvZ2luRXJyb3JzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgY29udHJvbCA9IHRoaXMubG9naW5Gb3JtLmZvcm0uY29udHJvbHNbJ2xvZ2luJ107XG4gICAgICBpZiAoY29udHJvbCkge1xuICAgICAgICB0aGlzLnJlc2V0Q29udHJvbChjb250cm9sKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUGFzc3dvcmRFcnJvcigpIHtcbiAgICBpZiAodGhpcy5wYXNzd29yZEVycm9ycyAmJiB0aGlzLnBhc3N3b3JkRXJyb3JzLmxlbmd0aCkge1xuICAgICAgdGhpcy5zZXRQYXNzd29yZEVycm9ycyh0aGlzLnBhc3N3b3JkRXJyb3JzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgY29udHJvbCA9IHRoaXMubG9naW5Gb3JtLmZvcm0uY29udHJvbHNbJ3Bhc3N3b3JkJ107XG5cbiAgICAgIGlmIChjb250cm9sKSB7XG4gICAgICAgIHRoaXMucmVzZXRDb250cm9sKGNvbnRyb2wpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVzZXRDb250cm9sKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCkge1xuICAgIGNvbnRyb2wubWFya0FzUHJpc3RpbmUoKTtcbiAgICBjb250cm9sLm1hcmtBc1VudG91Y2hlZCgpO1xuICAgIGNvbnRyb2wudXBkYXRlVmFsdWVBbmRWYWxpZGl0eSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRDb250cm9sRXJyb3JzKGFsbEVycm9yczogc3RyaW5nLCBjb250cm9sOiBBYnN0cmFjdENvbnRyb2wsIGVycm9yczogQXJyYXk8c3RyaW5nPiwgcGF0dGVybkVycm9yOiBzdHJpbmcpIHtcblxuICAgIGlmIChjb250cm9sKSB7XG5cbiAgICAgIHRoaXNbYWxsRXJyb3JzXSA9IGNvbnRyb2wuaGFzRXJyb3IoJ3BhdHRlcm4nKSA/IFsuLi5lcnJvcnMsIC4uLltwYXR0ZXJuRXJyb3JdXSA6IFsuLi5lcnJvcnNdO1xuXG4gICAgICBpZiAoZXJyb3JzICYmIGVycm9ycy5sZW5ndGggJiYgKGNvbnRyb2wudmFsaWQgfHwgY29udHJvbC5wcmlzdGluZSkpIHtcbiAgICAgICAgY29udHJvbC5tYXJrQXNUb3VjaGVkKCk7XG4gICAgICAgIGNvbnRyb2wubWFya0FzRGlydHkoKTtcbiAgICAgICAgY29udHJvbC5zZXRFcnJvcnModGhpcy5jdXN0b21QYXNzd29yZEVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIHByaXZhdGUgc2V0VXJsUmVkaXJlY3QodXJsKSB7XG4gICAgaXNFeHRlcm5hbExpbmsodXJsKSA/ICB3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKSA6IHRoaXMucm91dGVyLm5hdmlnYXRlKFt1cmxdKTtcbiAgfVxuXG4gIHByaXZhdGUgdmFsaWRhdGVBcnJheUNoYW5nZXMoZGlmZmVyOiBhbnksIGFycmF5OiBBcnJheTx7IGFycmF5OiBBcnJheTxhbnk+LCBjYWxsYmFjazogYW55IH0+KSB7XG5cbiAgICBhcnJheS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgY29uc3QgY2hhbmdlcyA9IGRpZmZlci5kaWZmKGVsZW1lbnQuYXJyYXkpO1xuICAgICAgaWYgKGNoYW5nZXMpIHtcbiAgICAgICAgZWxlbWVudC5jYWxsYmFjaygpO1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvcGVuVXJsKHJlY292ZXJ5OiBhbnkpOiB2b2lkIHtcbiAgICBzd2l0Y2ggKHR5cGVvZiByZWNvdmVyeSkge1xuICAgICAgY2FzZSAnc3RyaW5nJzoge1xuICAgICAgICB0aGlzLnNldFVybFJlZGlyZWN0KHJlY292ZXJ5KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdmdW5jdGlvbic6IHtcbiAgICAgICAgcmVjb3ZlcnkoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdvYmplY3QnOiB7XG4gICAgICAgIHRoaXMuY3JlYXRlTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KHJlY292ZXJ5KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIHNldExvZ2luRXJyb3JzKGVycm9yczogQXJyYXk8c3RyaW5nPikge1xuICAgIGNvbnN0IGNvbnRyb2wgPSB0aGlzLmxvZ2luRm9ybS5mb3JtLmNvbnRyb2xzWydsb2dpbiddO1xuICAgIHRoaXMuc2V0Q29udHJvbEVycm9ycygnYWxsTG9naW5FcnJvcnMnLCBjb250cm9sLCBlcnJvcnMsIHRoaXMubGl0ZXJhbHMubG9naW5FcnJvclBhdHRlcm4pO1xuICB9XG5cbiAgcHJvdGVjdGVkIHNldFBhc3N3b3JkRXJyb3JzKGVycm9yczogQXJyYXk8c3RyaW5nPikge1xuICAgIGNvbnN0IGNvbnRyb2wgPSB0aGlzLmxvZ2luRm9ybS5mb3JtLmNvbnRyb2xzWydwYXNzd29yZCddO1xuICAgIHRoaXMuc2V0Q29udHJvbEVycm9ycygnYWxsUGFzc3dvcmRFcnJvcnMnLCBjb250cm9sLCBlcnJvcnMsIHRoaXMubGl0ZXJhbHMucGFzc3dvcmRFcnJvclBhdHRlcm4pO1xuICB9XG5cbiAgb25TZWxlY3RlZExhbmd1YWdlKGxhbmd1YWdlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnNlbGVjdGVkTGFuZ3VhZ2UgPSBsYW5ndWFnZTtcbiAgICB0aGlzLmdldExpdGVyYWxzKGxhbmd1YWdlLCB0aGlzLmNvbnRhaW5zQ3VzdG9tTGl0ZXJhbHMgPyB0aGlzLmN1c3RvbWl6ZWREZWZhdWx0TGl0ZXJhbHMgOiB1bmRlZmluZWQpO1xuICAgIHRoaXMuc2V0VGl0bGVMaXRlcmFsKGxhbmd1YWdlLCB0aGlzLnByb2R1Y3ROYW1lKTtcbiAgICB0aGlzLnNldExvZ2luSGludExpdGVyYWwobGFuZ3VhZ2UsIHRoaXMuY29udGFjdEVtYWlsKTtcbiAgfVxuXG59XG4iXX0=