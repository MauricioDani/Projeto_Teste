/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, ViewContainerRef } from '@angular/core';
import { NgForm } from '@angular/forms';
import { ActivatedRoute, Router } from '@angular/router';
import { ThfComponentInjectorService, ThfModalComponent } from '@totvs/thf-ui';
import { browserLanguage, isExternalLink, isTypeof, thfLocaleDefault } from '../../utils/util';
import { ThfModalPasswordRecoveryComponent } from '../thf-modal-password-recovery/thf-modal-password-recovery.component';
import { ThfModalPasswordRecoveryType } from '../thf-modal-password-recovery/enums/thf-modal-password-recovery-type.enum';
import { ThfPageChangePasswordBaseComponent } from './thf-page-change-password-base.component';
import { thfPageChangePasswordLiterals } from './literals/i18n/thf-page-change-password-literals';
import { ThfPageChangePasswordService } from './thf-page-change-password.service';
/**
 * \@docsExtends ThfPageChangePasswordBaseComponent
 *
 * \@example
 *
 * <example name="thf-page-change-password-basic" title="Totvs Page Change Password Basic">
 *  <file name="sample-thf-page-change-password-basic/sample-thf-page-change-password-basic.component.html"> </file>
 *  <file name="sample-thf-page-change-password-basic/sample-thf-page-change-password-basic.component.ts"> </file>
 * </example>
 *
 * <example name="thf-page-change-password-labs" title="Totvs Page Change Password Labs">
 *  <file name="sample-thf-page-change-password-labs/sample-thf-page-change-password-labs.component.html"> </file>
 *  <file name="sample-thf-page-change-password-labs/sample-thf-page-change-password-labs.component.ts"> </file>
 * </example>
 *
 * <example name="thf-page-change-password-modify" title="Totvs Page Change Password Modify">
 *  <file name="sample-thf-page-change-password-modify/sample-thf-page-change-password-modify.component.html"> </file>
 *  <file name="sample-thf-page-change-password-modify/sample-thf-page-change-password-modify.component.ts"> </file>
 * </example>
 *
 * <example name="thf-page-change-password-create" title="Totvs Page Change Password Create">
 *  <file name="sample-thf-page-change-password-create/sample-thf-page-change-password-create.component.html"> </file>
 *  <file name="sample-thf-page-change-password-create/sample-thf-page-change-password-create.component.ts"> </file>
 * </example>
 *
 * <example name="thf-page-change-password-request" title="Totvs Page Change Password Request">
 *  <file name="sample-thf-page-change-password-request/sample-thf-page-change-password-request.component.html"> </file>
 *  <file name="sample-thf-page-change-password-request/sample-thf-page-change-password-request.component.ts"> </file>
 * </example>
 */
export class ThfPageChangePasswordComponent extends ThfPageChangePasswordBaseComponent {
    /**
     * @param {?} activatedRoute
     * @param {?} route
     * @param {?} router
     * @param {?} service
     * @param {?} thfComponentInjector
     * @param {?} viewRef
     */
    constructor(activatedRoute, route, router, service, thfComponentInjector, viewRef) {
        super();
        this.activatedRoute = activatedRoute;
        this.route = route;
        this.router = router;
        this.service = service;
        this.thfComponentInjector = thfComponentInjector;
        this.literals = Object.assign({}, thfPageChangePasswordLiterals[thfLocaleDefault], thfPageChangePasswordLiterals[browserLanguage()]);
        this.componentRef = null;
        this.modalAction = {
            action: this.navigateTo.bind(this, this.urlHome),
            label: this.literals.enterSystemButton
        };
        this.parentRef = viewRef['_view']['component'];
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        if (this.urlNewPassword) {
            this.subscribeToTokenParameter();
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.newPasswordSubscription) {
            this.newPasswordSubscription.unsubscribe();
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.checkingForRouteMetadata(this.activatedRoute.snapshot.data);
    }
    /**
     * @param {?} url
     * @return {?}
     */
    navigateTo(url) {
        isExternalLink(url) ? window.open(url) : this.router.navigate([url || '/']);
    }
    /**
     * @param {?} recovery
     * @return {?}
     */
    onForgotPasswordClick(recovery) {
        if (isTypeof(recovery, 'function')) {
            recovery();
        }
        else {
            this.createModalPasswordRecoveryComponent(recovery);
        }
    }
    /**
     * @return {?}
     */
    onLoginSubmit() {
        /** @type {?} */
        const form = this.getLoginForm();
        if (this.urlNewPassword) {
            this.postUrlNewPassword(form);
        }
        else if (this.submit && this.submit.observers.length) {
            this.emitSubmit(form);
        }
    }
    /**
     * Abre uma modal de confirmação com texto, imagem e botão que redireciona para o link definido na propriedade `t-url-home`
     * @return {?}
     */
    openConfirmation() {
        this.modal.open();
    }
    /**
     * @return {?}
     */
    validatePassword() {
        /** @type {?} */
        const controls = this.passwordForm.form.controls;
        /** @type {?} */
        const controlConfirmPassword = controls['confirmPassword'];
        /** @type {?} */
        const controlNewPassword = controls['newPassword'];
        if (!this.newPassword) {
            this.setFormErrors({ 'required': true }, [controlNewPassword]);
        }
        else if (!this.confirmPassword) {
            this.setFormErrors({ 'required': true }, [controlConfirmPassword]);
        }
        else if (this.newPassword && this.confirmPassword && this.newPassword !== this.confirmPassword) {
            this.setFormErrors({ 'equalPassword': true }, [controlNewPassword, controlConfirmPassword]);
        }
        else {
            this.setFormErrors(null, [controlConfirmPassword, controlNewPassword]);
        }
        if (this.requirements.length && this.requirements.find((/**
         * @param {?} requirement
         * @return {?}
         */
        requirement => this.validateRequirement(requirement) === false))) {
            this.setFormErrors({ 'requirement': true }, [controlNewPassword]);
        }
    }
    /**
     * @param {?} requirement
     * @return {?}
     */
    validateRequirement(requirement) {
        return typeof requirement.status === 'function' ? requirement.status.call(this.parentRef, this.newPassword) : requirement.status;
    }
    /**
     * @private
     * @param {?} object
     * @param {?} property
     * @return {?}
     */
    checkingForMetadataProperty(object, property) {
        if (Object.prototype.hasOwnProperty.call(object, property)) {
            return object[property];
        }
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    checkingForRouteMetadata(data) {
        if (Object.keys(data).length !== 0) {
            this.urlNewPassword = this.checkingForMetadataProperty(data, 'serviceApi') || this.urlNewPassword;
            this.recovery = this.checkingForMetadataProperty(data, 'recovery') || this.recovery;
            this.hideCurrentPassword = this.checkingForMetadataProperty(data, 'hideCurrentPassword') || this.hideCurrentPassword;
        }
    }
    /**
     * @private
     * @param {?} recovery
     * @return {?}
     */
    createModalPasswordRecoveryComponent(recovery) {
        if (this.componentRef) {
            this.thfComponentInjector.destroyComponentInApplication(this.componentRef);
        }
        this.componentRef = this.thfComponentInjector.createComponentInApplication(ThfModalPasswordRecoveryComponent);
        this.componentRef.instance.recovery = recovery.url;
        this.componentRef.instance.contactEmail = recovery.contactMail;
        this.componentRef.instance.phoneMask = recovery.phoneMask;
        this.componentRef.instance.type = recovery.type || ThfModalPasswordRecoveryType.Email;
        this.componentRef.changeDetectorRef.detectChanges();
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.componentRef.instance.open();
        }));
    }
    /**
     * @private
     * @param {?} form
     * @return {?}
     */
    emitSubmit(form) {
        this.submit.emit(form);
    }
    /**
     * @private
     * @return {?}
     */
    getLoginForm() {
        return {
            currentPassword: this.currentPassword,
            newPassword: this.newPassword
        };
    }
    /**
     * @private
     * @param {?} form
     * @return {?}
     */
    postUrlNewPassword(form) {
        form['token'] = this.token;
        this.service.post(this.urlNewPassword, form).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        response => {
            if (response.status === 204) {
                this.openConfirmation();
            }
        }));
    }
    /**
     * @private
     * @param {?} error
     * @param {?=} controls
     * @return {?}
     */
    setFormErrors(error, controls) {
        controls.forEach((/**
         * @param {?} control
         * @return {?}
         */
        control => {
            control.setErrors(error);
        }));
    }
    /**
     * @private
     * @return {?}
     */
    subscribeToTokenParameter() {
        this.route.queryParams.subscribe((/**
         * @param {?} params
         * @return {?}
         */
        params => {
            /** @type {?} */
            const token = params['token'];
            if (token) {
                this.token = token;
            }
        }));
    }
}
ThfPageChangePasswordComponent.decorators = [
    { type: Component, args: [{
                selector: 'thf-page-change-password',
                template: "<div class=\"thf-page-change-password-wrapper\" #pageChangePassword>\n  <div class=\"thf-page-change-password-container\">\n    <thf-page-background class=\"thf-page-change-password\"\n      [t-logo]=\"logo\"\n      [t-secondary-logo]=\"secondaryLogo\">\n\n      <div class=\"thf-page-blocked-user-header thf-row\">\n        <div class=\"thf-md-12\">{{literals.createNewPassword}}</div>\n        <div class=\"thf-md-12 thf-text-center thf-font-text\">\n          {{literals.createNewPasswordPhrase}}\n        </div>\n      </div>\n\n      <form #passwordForm=\"ngForm\">\n\n        <div class=\"thf-row thf-mt-3 thf-mt-sm-1\">\n          <div class=\"thf-md-6\"\n            [ngClass]=\"{'thf-offset-md-3 thf-offset-lg-3 thf-offset-xl-3': !showRequirements}\">\n            <div *ngIf=\"!hideCurrentPassword\">\n              <thf-password\n                name=\"currentPassword\"\n                [(ngModel)]=\"currentPassword\"\n                t-required\n                [t-label]=\"literals.currentPassword\">\n              </thf-password>\n            </div>\n            <div *ngIf=\"!hideCurrentPassword && recovery\" class=\"thf-text-center thf-mb-sm-1 thf-mb-2\">\n              <a *ngIf=\"recoveryUrlType === 'internalLink'\"\n                class=\"thf-font-text-bold thf-page-change-password-forgot-password\"\n                [routerLink]=\"recovery\">\n                {{literals.forgotPassword}}\n              </a>\n              <a *ngIf=\"recoveryUrlType === 'externalLink'\"\n                class=\"thf-font-text-bold thf-page-change-password-forgot-password\"\n                [href]=\"recovery\">\n                {{literals.forgotPassword}}\n              </a>\n              <a *ngIf=\"!recoveryUrlType\"\n                class=\"thf-font-text-bold thf-page-change-password-forgot-password thf-clickable\"\n                (click)=\"onForgotPasswordClick(recovery)\">\n                {{literals.forgotPassword}}\n              </a>\n            </div>\n            <div>\n              <thf-password\n                name=\"newPassword\"\n                [(ngModel)]=\"newPassword\"\n                t-required\n                [t-label]=\"literals.newPassword\"\n                (t-change-model)=\"validatePassword()\">\n              </thf-password>\n            </div>\n            <div>\n              <thf-password\n                name=\"confirmPassword\"\n                [(ngModel)]=\"confirmPassword\"\n                t-required\n                [t-label]=\"literals.confirmPassword\"\n                (t-change-model)=\"validatePassword()\">\n              </thf-password>\n            </div>\n          </div>\n          <div *ngIf=\"showRequirements\"\n            class=\"thf-md-6 thf-page-change-password-required-container\">\n            <thf-container>\n              <ul class=\"thf-page-change-password-required-list\">\n                <li class=\"thf-page-change-password-required-item\">\n                  <p class=\"thf-mb-1 thf-font-text-bold thf-page-change-password-required-title\">\n                    {{literals?.requirements}}\n                  </p>\n                </li>\n                <li *ngFor=\"let requirement of requirements\"\n                  class=\"thf-page-change-password-required-item\">\n                  <span class=\"thf-icon thf-page-change-password-required-icon\"\n                    [ngClass]=\"validateRequirement(requirement) ? 'thf-icon-ok thf-page-change-password-required-ok' : 'thf-icon-minus thf-page-change-password-required-minus'\">\n                  </span>\n                  <p class=\"thf-page-change-password-required-text thf-font-text\">\n                    {{requirement.requirement}}\n                  </p>\n                </li>\n              </ul>\n            </thf-container>\n          </div>\n        </div>\n      </form>\n\n      <thf-divider class=\"thf-sm-12\"></thf-divider>\n\n      <div class=\"thf-page-change-password-tips thf-row\">\n        <div class=\"thf-md-2 thf-mr-3\">\n          <img\n            class=\"thf-page-change-password-lock-image thf-mb-3\"\n            alt=\"Blocked user image\"\n            src=\"./assets/images/big-lock.svg\"\n          />\n        </div>\n        <div class=\"thf-md-9 thf-page-change-password-tips-text\">\n          <div class=\"thf-font-text-bold thf-pb-1\">{{literals.safetyTips}}</div>\n          <div class=\"thf-font-text-small\">\n            <div class=\"thf-row thf-pb-1\">{{literals.safetyTipsPhrase}}</div>\n            <div class=\"thf-row thf-pb-1\">\u2022 {{literals.safetyTipsFirst}}</div>\n            <div class=\"thf-row thf-pb-1\">\u2022 {{literals.safetyTipsSecond}}</div>\n            <div class=\"thf-row thf-pb-1\">\u2022 {{literals.safetyTipsThird}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"thf-page-change-password-buttons thf-row\">\n\n        <thf-divider class=\"thf-sm-12 thf-mobile-only\"></thf-divider>\n\n        <thf-button *ngIf=\"!hideCurrentPassword\"\n          class=\"thf-sm-6 thf-mb-sm-1\"\n          [t-label]=\"literals.backButton\"\n          (t-click)=\"navigateTo(urlBack)\">\n        </thf-button>\n\n        <thf-button\n          [ngClass]=\"hideCurrentPassword ? 'thf-md-12':'thf-sm-6'\"\n          t-type=\"primary\"\n          [t-disabled]=\"passwordForm.invalid\"\n          [t-label]=\"literals.saveButton\"\n          (t-click)=\"onLoginSubmit()\">\n        </thf-button>\n\n      </div>\n\n    </thf-page-background>\n\n  </div>\n</div>\n\n<thf-modal\n  [t-primary-action]=\"modalAction\"\n  t-hide-close\n  t-size=\"auto\"\n  [t-title]=\"hideCurrentPassword ? literals.passwordSuccessfullyCreated : literals.passwordSuccessfullyUpdated\">\n\n  <div class=\"thf-text-center\">\n    <img\n      alt=\"Blocked user image\"\n      class=\"thf-page-change-password-lock-image thf-mb-3\"\n      src=\"./assets/images/success.svg\"\n    />\n  </div>\n</thf-modal>\n"
            }] }
];
/** @nocollapse */
ThfPageChangePasswordComponent.ctorParameters = () => [
    { type: ActivatedRoute },
    { type: ActivatedRoute },
    { type: Router },
    { type: ThfPageChangePasswordService },
    { type: ThfComponentInjectorService },
    { type: ViewContainerRef }
];
ThfPageChangePasswordComponent.propDecorators = {
    modal: [{ type: ViewChild, args: [ThfModalComponent, { static: true },] }],
    pageChangePassword: [{ type: ViewChild, args: ['pageChangePassword', { read: ViewContainerRef, static: true },] }],
    passwordForm: [{ type: ViewChild, args: ['passwordForm', { read: NgForm, static: true },] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    ThfPageChangePasswordComponent.prototype.newPasswordSubscription;
    /** @type {?} */
    ThfPageChangePasswordComponent.prototype.literals;
    /**
     * @type {?}
     * @private
     */
    ThfPageChangePasswordComponent.prototype.componentRef;
    /** @type {?} */
    ThfPageChangePasswordComponent.prototype.modalAction;
    /** @type {?} */
    ThfPageChangePasswordComponent.prototype.parentRef;
    /** @type {?} */
    ThfPageChangePasswordComponent.prototype.modal;
    /** @type {?} */
    ThfPageChangePasswordComponent.prototype.pageChangePassword;
    /** @type {?} */
    ThfPageChangePasswordComponent.prototype.passwordForm;
    /**
     * @type {?}
     * @private
     */
    ThfPageChangePasswordComponent.prototype.activatedRoute;
    /**
     * @type {?}
     * @private
     */
    ThfPageChangePasswordComponent.prototype.route;
    /**
     * @type {?}
     * @private
     */
    ThfPageChangePasswordComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    ThfPageChangePasswordComponent.prototype.service;
    /**
     * @type {?}
     * @private
     */
    ThfPageChangePasswordComponent.prototype.thfComponentInjector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0b3R2cy90aGYtdGVtcGxhdGVzLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkL3RoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBaUIsU0FBUyxFQUFtQyxTQUFTLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkgsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3hDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFJekQsT0FBTyxFQUFFLDJCQUEyQixFQUFrQixpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUvRixPQUFPLEVBQUUsZUFBZSxFQUFFLGNBQWMsRUFBRSxRQUFRLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUUvRixPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSxzRUFBc0UsQ0FBQztBQUN6SCxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSw0RUFBNEUsQ0FBQztBQUUxSCxPQUFPLEVBQUUsa0NBQWtDLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQztBQUMvRixPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSxtREFBbUQsQ0FBQztBQUdsRyxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXFDbEYsTUFBTSxPQUFPLDhCQUErQixTQUFRLGtDQUFrQzs7Ozs7Ozs7O0lBMEJwRixZQUNVLGNBQThCLEVBQzlCLEtBQXFCLEVBQ3JCLE1BQWMsRUFDZCxPQUFxQyxFQUNyQyxvQkFBaUQsRUFDekQsT0FBeUI7UUFDdkIsS0FBSyxF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R0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDO1lBRTdCLElBQUksS0FBSyxFQUFFO2dCQUNULElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO2FBQ3BCO1FBQ0gsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDOzs7WUFsTEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSwwQkFBMEI7Z0JBQ3BDLDZ5TEFBd0Q7YUFDekQ7Ozs7WUFsRFEsY0FBYztZQUFkLGNBQWM7WUFBRSxNQUFNO1lBZXRCLDRCQUE0QjtZQVg1QiwyQkFBMkI7WUFOMkMsZ0JBQWdCOzs7b0JBNEU1RixTQUFTLFNBQUMsaUJBQWlCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO2lDQUM3QyxTQUFTLFNBQUMsb0JBQW9CLEVBQUUsRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTsyQkFDeEUsU0FBUyxTQUFDLGNBQWMsRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTs7Ozs7OztJQXRCekQsaUVBQThDOztJQUU5QyxrREFPSTs7Ozs7SUFFSixzREFBK0M7O0lBRS9DLHFEQUdFOztJQUVGLG1EQUFlOztJQUVmLCtDQUF5RTs7SUFDekUsNERBQWdIOztJQUNoSCxzREFBZ0Y7Ozs7O0lBRzlFLHdEQUFzQzs7Ozs7SUFDdEMsK0NBQTZCOzs7OztJQUM3QixnREFBc0I7Ozs7O0lBQ3RCLGlEQUE2Qzs7Ozs7SUFDN0MsOERBQXlEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWZ0ZXJWaWV3SW5pdCwgQ29tcG9uZW50LCBDb21wb25lbnRSZWYsIE9uRGVzdHJveSwgT25Jbml0LCBWaWV3Q2hpbGQsIFZpZXdDb250YWluZXJSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE5nRm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlLCBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgVGhmQ29tcG9uZW50SW5qZWN0b3JTZXJ2aWNlLCBUaGZNb2RhbEFjdGlvbiwgVGhmTW9kYWxDb21wb25lbnQgfSBmcm9tICdAdG90dnMvdGhmLXVpJztcblxuaW1wb3J0IHsgYnJvd3Nlckxhbmd1YWdlLCBpc0V4dGVybmFsTGluaywgaXNUeXBlb2YsIHRoZkxvY2FsZURlZmF1bHQgfSBmcm9tICcuLi8uLi91dGlscy91dGlsJztcblxuaW1wb3J0IHsgVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50IH0gZnJvbSAnLi4vdGhmLW1vZGFsLXBhc3N3b3JkLXJlY292ZXJ5L3RoZi1tb2RhbC1wYXNzd29yZC1yZWNvdmVyeS5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5VHlwZSB9IGZyb20gJy4uL3RoZi1tb2RhbC1wYXNzd29yZC1yZWNvdmVyeS9lbnVtcy90aGYtbW9kYWwtcGFzc3dvcmQtcmVjb3ZlcnktdHlwZS5lbnVtJztcbmltcG9ydCB7IFRoZlBhZ2VDaGFuZ2VQYXNzd29yZCB9IGZyb20gJy4vaW50ZXJmYWNlcy90aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQuaW50ZXJmYWNlJztcbmltcG9ydCB7IFRoZlBhZ2VDaGFuZ2VQYXNzd29yZEJhc2VDb21wb25lbnQgfSBmcm9tICcuL3RoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNlLmNvbXBvbmVudCc7XG5pbXBvcnQgeyB0aGZQYWdlQ2hhbmdlUGFzc3dvcmRMaXRlcmFscyB9IGZyb20gJy4vbGl0ZXJhbHMvaTE4bi90aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbGl0ZXJhbHMnO1xuaW1wb3J0IHsgVGhmUGFnZUNoYW5nZVBhc3N3b3JkUmVjb3ZlcnkgfSBmcm9tICcuL2ludGVyZmFjZXMvdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLXJlY292ZXJ5LmludGVyZmFjZSc7XG5pbXBvcnQgeyBUaGZQYWdlQ2hhbmdlUGFzc3dvcmRSZXF1aXJlbWVudCB9IGZyb20gJy4vaW50ZXJmYWNlcy90aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtcmVxdWlyZW1lbnQuaW50ZXJmYWNlJztcbmltcG9ydCB7IFRoZlBhZ2VDaGFuZ2VQYXNzd29yZFNlcnZpY2UgfSBmcm9tICcuL3RoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC5zZXJ2aWNlJztcblxuLyoqXG4gKiBAZG9jc0V4dGVuZHMgVGhmUGFnZUNoYW5nZVBhc3N3b3JkQmFzZUNvbXBvbmVudFxuICpcbiAqIEBleGFtcGxlXG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNpY1wiIHRpdGxlPVwiVG90dnMgUGFnZSBDaGFuZ2UgUGFzc3dvcmQgQmFzaWNcIj5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNpYy9zYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWJhc2ljLmNvbXBvbmVudC5odG1sXCI+IDwvZmlsZT5cbiAqICA8ZmlsZSBuYW1lPVwic2FtcGxlLXRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1iYXNpYy9zYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWJhc2ljLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1sYWJzXCIgdGl0bGU9XCJUb3R2cyBQYWdlIENoYW5nZSBQYXNzd29yZCBMYWJzXCI+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS10aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbGFicy9zYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWxhYnMuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWxhYnMvc2FtcGxlLXRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1sYWJzLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1tb2RpZnlcIiB0aXRsZT1cIlRvdHZzIFBhZ2UgQ2hhbmdlIFBhc3N3b3JkIE1vZGlmeVwiPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLW1vZGlmeS9zYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLW1vZGlmeS5jb21wb25lbnQuaHRtbFwiPiA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS10aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbW9kaWZ5L3NhbXBsZS10aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtbW9kaWZ5LmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1jcmVhdGVcIiB0aXRsZT1cIlRvdHZzIFBhZ2UgQ2hhbmdlIFBhc3N3b3JkIENyZWF0ZVwiPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWNyZWF0ZS9zYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLWNyZWF0ZS5jb21wb25lbnQuaHRtbFwiPiA8L2ZpbGU+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS10aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtY3JlYXRlL3NhbXBsZS10aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtY3JlYXRlLmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKlxuICogPGV4YW1wbGUgbmFtZT1cInRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1yZXF1ZXN0XCIgdGl0bGU9XCJUb3R2cyBQYWdlIENoYW5nZSBQYXNzd29yZCBSZXF1ZXN0XCI+XG4gKiAgPGZpbGUgbmFtZT1cInNhbXBsZS10aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQtcmVxdWVzdC9zYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLXJlcXVlc3QuY29tcG9uZW50Lmh0bWxcIj4gPC9maWxlPlxuICogIDxmaWxlIG5hbWU9XCJzYW1wbGUtdGhmLXBhZ2UtY2hhbmdlLXBhc3N3b3JkLXJlcXVlc3Qvc2FtcGxlLXRoZi1wYWdlLWNoYW5nZS1wYXNzd29yZC1yZXF1ZXN0LmNvbXBvbmVudC50c1wiPiA8L2ZpbGU+XG4gKiA8L2V4YW1wbGU+XG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RoZi1wYWdlLWNoYW5nZS1wYXNzd29yZCcsXG4gIHRlbXBsYXRlVXJsOiAnLi90aGYtcGFnZS1jaGFuZ2UtcGFzc3dvcmQuY29tcG9uZW50Lmh0bWwnXG59KVxuXG5leHBvcnQgY2xhc3MgVGhmUGFnZUNoYW5nZVBhc3N3b3JkQ29tcG9uZW50IGV4dGVuZHMgVGhmUGFnZUNoYW5nZVBhc3N3b3JkQmFzZUNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSwgT25Jbml0IHtcblxuICBwcml2YXRlIG5ld1Bhc3N3b3JkU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cbiAgcmVhZG9ubHkgbGl0ZXJhbHM6IHsgYmFja0J1dHRvbjogc3RyaW5nLCBjb25maXJtUGFzc3dvcmQ6IHN0cmluZywgY3JlYXRlTmV3UGFzc3dvcmQ6IHN0cmluZywgY3JlYXRlTmV3UGFzc3dvcmRQaHJhc2U6IHN0cmluZyxcbiAgICBjdXJyZW50UGFzc3dvcmQ6IHN0cmluZywgZW50ZXJTeXN0ZW1CdXR0b246IHN0cmluZywgZm9yZ290UGFzc3dvcmQ6IHN0cmluZywgbmV3UGFzc3dvcmQ6IHN0cmluZywgcGFzc3dvcmRTdWNjZXNzZnVsbHlDcmVhdGVkOiBzdHJpbmcsXG4gICAgcGFzc3dvcmRTdWNjZXNzZnVsbHlVcGRhdGVkOiBzdHJpbmcsIHNhZmV0eVRpcHM6IHN0cmluZywgc2FmZXR5VGlwc1BocmFzZTogc3RyaW5nLCBzYWZldHlUaXBzRmlyc3Q6IHN0cmluZywgc2FmZXR5VGlwc1NlY29uZDogc3RyaW5nLFxuICAgIHNhZmV0eVRpcHNUaGlyZDogc3RyaW5nLCBzYXZlQnV0dG9uOiBzdHJpbmcgfSA9XG4gICAge1xuICAgICAgLi4udGhmUGFnZUNoYW5nZVBhc3N3b3JkTGl0ZXJhbHNbdGhmTG9jYWxlRGVmYXVsdF0sXG4gICAgICAuLi50aGZQYWdlQ2hhbmdlUGFzc3dvcmRMaXRlcmFsc1ticm93c2VyTGFuZ3VhZ2UoKV0sXG4gICAgfTtcblxuICBwcml2YXRlIGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPGFueT4gPSBudWxsO1xuXG4gIG1vZGFsQWN0aW9uOiBUaGZNb2RhbEFjdGlvbiA9IHtcbiAgICBhY3Rpb246IHRoaXMubmF2aWdhdGVUby5iaW5kKHRoaXMsIHRoaXMudXJsSG9tZSksXG4gICAgbGFiZWw6IHRoaXMubGl0ZXJhbHMuZW50ZXJTeXN0ZW1CdXR0b25cbiAgfTtcblxuICBwYXJlbnRSZWY6IGFueTtcblxuICBAVmlld0NoaWxkKFRoZk1vZGFsQ29tcG9uZW50LCB7IHN0YXRpYzogdHJ1ZSB9KSBtb2RhbDogVGhmTW9kYWxDb21wb25lbnQ7XG4gIEBWaWV3Q2hpbGQoJ3BhZ2VDaGFuZ2VQYXNzd29yZCcsIHsgcmVhZDogVmlld0NvbnRhaW5lclJlZiwgc3RhdGljOiB0cnVlIH0pIHBhZ2VDaGFuZ2VQYXNzd29yZDogVmlld0NvbnRhaW5lclJlZjtcbiAgQFZpZXdDaGlsZCgncGFzc3dvcmRGb3JtJywgeyByZWFkOiBOZ0Zvcm0sIHN0YXRpYzogdHJ1ZSB9KSBwYXNzd29yZEZvcm06IE5nRm9ybTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGFjdGl2YXRlZFJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcbiAgICBwcml2YXRlIHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxuICAgIHByaXZhdGUgc2VydmljZTogVGhmUGFnZUNoYW5nZVBhc3N3b3JkU2VydmljZSxcbiAgICBwcml2YXRlIHRoZkNvbXBvbmVudEluamVjdG9yOiBUaGZDb21wb25lbnRJbmplY3RvclNlcnZpY2UsXG4gICAgdmlld1JlZjogVmlld0NvbnRhaW5lclJlZikge1xuICAgICAgc3VwZXIoKTtcbiAgICAgIHRoaXMucGFyZW50UmVmID0gdmlld1JlZlsnX3ZpZXcnXVsnY29tcG9uZW50J107XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgaWYgKHRoaXMudXJsTmV3UGFzc3dvcmQpIHtcbiAgICAgIHRoaXMuc3Vic2NyaWJlVG9Ub2tlblBhcmFtZXRlcigpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIGlmICh0aGlzLm5ld1Bhc3N3b3JkU3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLm5ld1Bhc3N3b3JkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5jaGVja2luZ0ZvclJvdXRlTWV0YWRhdGEodGhpcy5hY3RpdmF0ZWRSb3V0ZS5zbmFwc2hvdC5kYXRhKTtcbiAgfVxuXG4gIG5hdmlnYXRlVG8odXJsOiBzdHJpbmcpIHtcbiAgICBpc0V4dGVybmFsTGluayh1cmwpID8gIHdpbmRvdy5vcGVuKHVybCkgOiB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbdXJsIHx8ICcvJ10pO1xuICB9XG5cbiAgb25Gb3Jnb3RQYXNzd29yZENsaWNrKHJlY292ZXJ5KTogdm9pZCB7XG4gICAgaWYgKGlzVHlwZW9mKHJlY292ZXJ5LCAnZnVuY3Rpb24nKSkge1xuICAgICAgcmVjb3ZlcnkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jcmVhdGVNb2RhbFBhc3N3b3JkUmVjb3ZlcnlDb21wb25lbnQocmVjb3ZlcnkpO1xuICAgIH1cbiAgfVxuXG4gIG9uTG9naW5TdWJtaXQoKTogdm9pZCB7XG5cbiAgICBjb25zdCBmb3JtID0gdGhpcy5nZXRMb2dpbkZvcm0oKTtcblxuICAgIGlmICh0aGlzLnVybE5ld1Bhc3N3b3JkKSB7XG4gICAgICB0aGlzLnBvc3RVcmxOZXdQYXNzd29yZChmb3JtKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3VibWl0ICYmIHRoaXMuc3VibWl0Lm9ic2VydmVycy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuZW1pdFN1Ym1pdChmb3JtKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWJyZSB1bWEgbW9kYWwgZGUgY29uZmlybWHDp8OjbyBjb20gdGV4dG8sIGltYWdlbSBlIGJvdMOjbyBxdWUgcmVkaXJlY2lvbmEgcGFyYSBvIGxpbmsgZGVmaW5pZG8gbmEgcHJvcHJpZWRhZGUgYHQtdXJsLWhvbWVgXHUwMDFjXG4gICAqL1xuICBvcGVuQ29uZmlybWF0aW9uKCkge1xuICAgIHRoaXMubW9kYWwub3BlbigpO1xuICB9XG5cbiAgdmFsaWRhdGVQYXNzd29yZCgpIHtcbiAgICBjb25zdCBjb250cm9scyA9ICB0aGlzLnBhc3N3b3JkRm9ybS5mb3JtLmNvbnRyb2xzO1xuICAgIGNvbnN0IGNvbnRyb2xDb25maXJtUGFzc3dvcmQgPSBjb250cm9sc1snY29uZmlybVBhc3N3b3JkJ107XG4gICAgY29uc3QgY29udHJvbE5ld1Bhc3N3b3JkID0gY29udHJvbHNbJ25ld1Bhc3N3b3JkJ107XG5cbiAgICBpZiAoIXRoaXMubmV3UGFzc3dvcmQpIHtcbiAgICAgIHRoaXMuc2V0Rm9ybUVycm9ycyh7J3JlcXVpcmVkJzogdHJ1ZX0sIFtjb250cm9sTmV3UGFzc3dvcmRdKTtcbiAgICB9IGVsc2UgaWYgKCF0aGlzLmNvbmZpcm1QYXNzd29yZCkge1xuICAgICAgdGhpcy5zZXRGb3JtRXJyb3JzKHsncmVxdWlyZWQnOiB0cnVlfSwgW2NvbnRyb2xDb25maXJtUGFzc3dvcmRdKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMubmV3UGFzc3dvcmQgJiYgdGhpcy5jb25maXJtUGFzc3dvcmQgJiYgdGhpcy5uZXdQYXNzd29yZCAhPT0gdGhpcy5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgIHRoaXMuc2V0Rm9ybUVycm9ycyh7J2VxdWFsUGFzc3dvcmQnOiB0cnVlfSwgW2NvbnRyb2xOZXdQYXNzd29yZCwgY29udHJvbENvbmZpcm1QYXNzd29yZF0pO1xuICAgIH0gIGVsc2Uge1xuICAgICAgdGhpcy5zZXRGb3JtRXJyb3JzKG51bGwsIFtjb250cm9sQ29uZmlybVBhc3N3b3JkLCBjb250cm9sTmV3UGFzc3dvcmRdKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5yZXF1aXJlbWVudHMubGVuZ3RoICYmIHRoaXMucmVxdWlyZW1lbnRzLmZpbmQocmVxdWlyZW1lbnQgPT4gIHRoaXMudmFsaWRhdGVSZXF1aXJlbWVudChyZXF1aXJlbWVudCkgPT09IGZhbHNlKSkge1xuICAgICAgdGhpcy5zZXRGb3JtRXJyb3JzKHsncmVxdWlyZW1lbnQnOiB0cnVlfSwgW2NvbnRyb2xOZXdQYXNzd29yZF0pO1xuICAgIH1cbiAgfVxuXG4gIHZhbGlkYXRlUmVxdWlyZW1lbnQocmVxdWlyZW1lbnQ6IFRoZlBhZ2VDaGFuZ2VQYXNzd29yZFJlcXVpcmVtZW50KSB7XG4gICAgcmV0dXJuIHR5cGVvZiByZXF1aXJlbWVudC5zdGF0dXMgPT09ICdmdW5jdGlvbicgPyByZXF1aXJlbWVudC5zdGF0dXMuY2FsbCh0aGlzLnBhcmVudFJlZiwgdGhpcy5uZXdQYXNzd29yZCkgOiByZXF1aXJlbWVudC5zdGF0dXM7XG4gIH1cblxuICBwcml2YXRlIGNoZWNraW5nRm9yTWV0YWRhdGFQcm9wZXJ0eShvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSkge1xuICAgICAgcmV0dXJuIG9iamVjdFtwcm9wZXJ0eV07XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjaGVja2luZ0ZvclJvdXRlTWV0YWRhdGEoZGF0YSkge1xuICAgIGlmIChPYmplY3Qua2V5cyhkYXRhKS5sZW5ndGggIT09IDApIHtcbiAgICAgIHRoaXMudXJsTmV3UGFzc3dvcmQgPSB0aGlzLmNoZWNraW5nRm9yTWV0YWRhdGFQcm9wZXJ0eShkYXRhLCAnc2VydmljZUFwaScpIHx8IHRoaXMudXJsTmV3UGFzc3dvcmQ7XG4gICAgICB0aGlzLnJlY292ZXJ5ID0gdGhpcy5jaGVja2luZ0Zvck1ldGFkYXRhUHJvcGVydHkoZGF0YSwgJ3JlY292ZXJ5JykgfHwgdGhpcy5yZWNvdmVyeTtcbiAgICAgIHRoaXMuaGlkZUN1cnJlbnRQYXNzd29yZCA9IHRoaXMuY2hlY2tpbmdGb3JNZXRhZGF0YVByb3BlcnR5KGRhdGEsICdoaWRlQ3VycmVudFBhc3N3b3JkJykgfHwgdGhpcy5oaWRlQ3VycmVudFBhc3N3b3JkO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KHJlY292ZXJ5OiBUaGZQYWdlQ2hhbmdlUGFzc3dvcmRSZWNvdmVyeSkge1xuICAgIGlmICh0aGlzLmNvbXBvbmVudFJlZikge1xuICAgICAgdGhpcy50aGZDb21wb25lbnRJbmplY3Rvci5kZXN0cm95Q29tcG9uZW50SW5BcHBsaWNhdGlvbih0aGlzLmNvbXBvbmVudFJlZik7XG4gICAgfVxuXG4gICAgdGhpcy5jb21wb25lbnRSZWYgPSB0aGlzLnRoZkNvbXBvbmVudEluamVjdG9yLmNyZWF0ZUNvbXBvbmVudEluQXBwbGljYXRpb24oVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5Q29tcG9uZW50KTtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5yZWNvdmVyeSA9IHJlY292ZXJ5LnVybDtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5jb250YWN0RW1haWwgPSByZWNvdmVyeS5jb250YWN0TWFpbDtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5waG9uZU1hc2sgPSByZWNvdmVyeS5waG9uZU1hc2s7XG4gICAgdGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UudHlwZSA9IHJlY292ZXJ5LnR5cGUgfHwgVGhmTW9kYWxQYXNzd29yZFJlY292ZXJ5VHlwZS5FbWFpbDtcbiAgICB0aGlzLmNvbXBvbmVudFJlZi5jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5vcGVuKCk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGVtaXRTdWJtaXQoZm9ybTogVGhmUGFnZUNoYW5nZVBhc3N3b3JkKSB7XG4gICAgdGhpcy5zdWJtaXQuZW1pdChmb3JtKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TG9naW5Gb3JtKCk6IFRoZlBhZ2VDaGFuZ2VQYXNzd29yZCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGN1cnJlbnRQYXNzd29yZDogdGhpcy5jdXJyZW50UGFzc3dvcmQsXG4gICAgICBuZXdQYXNzd29yZDogdGhpcy5uZXdQYXNzd29yZFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIHBvc3RVcmxOZXdQYXNzd29yZChmb3JtOiBUaGZQYWdlQ2hhbmdlUGFzc3dvcmQpIHtcblxuICAgIGZvcm1bJ3Rva2VuJ10gPSB0aGlzLnRva2VuO1xuXG4gICAgdGhpcy5zZXJ2aWNlLnBvc3QodGhpcy51cmxOZXdQYXNzd29yZCwgZm9ybSkuc3Vic2NyaWJlKHJlc3BvbnNlID0+IHtcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwNCkge1xuICAgICAgICB0aGlzLm9wZW5Db25maXJtYXRpb24oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0Rm9ybUVycm9ycyhlcnJvcjogYW55LCBjb250cm9scz86IEFycmF5PGFueT4pIHtcbiAgICBjb250cm9scy5mb3JFYWNoKGNvbnRyb2wgPT4ge1xuICAgICAgY29udHJvbC5zZXRFcnJvcnMoZXJyb3IpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzdWJzY3JpYmVUb1Rva2VuUGFyYW1ldGVyKCkge1xuICAgIHRoaXMucm91dGUucXVlcnlQYXJhbXMuc3Vic2NyaWJlKHBhcmFtcyA9PiB7XG4gICAgICBjb25zdCB0b2tlbiA9IHBhcmFtc1sndG9rZW4nXTtcblxuICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgIHRoaXMudG9rZW4gPSB0b2tlbjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG59XG4iXX0=