/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild } from '@angular/core';
import { browserLanguage, thfLocaleDefault } from '../../utils/util';
import { ThfDialogType } from './thf-dialog.enum';
import { ThfModalComponent } from '../../components/thf-modal/thf-modal.component';
/** @type {?} */
export const thfDialogAlertLiteralsDefault = {
    en: (/** @type {?} */ ({ ok: 'Ok' })),
    es: (/** @type {?} */ ({ ok: 'Ok' })),
    pt: (/** @type {?} */ ({ ok: 'Ok' }))
};
/** @type {?} */
export const thfDialogConfirmLiteralsDefault = {
    en: (/** @type {?} */ ({ cancel: 'Cancel', confirm: 'Confirm' })),
    es: (/** @type {?} */ ({ cancel: 'Cancelar', confirm: 'Confirmar' })),
    pt: (/** @type {?} */ ({ cancel: 'Cancelar', confirm: 'Confirmar' }))
};
/**
 * \@docsPrivate
 *
 * \@description
 *
 * Componente que serve como container do thf-dialog.service
 */
export class ThfDialogComponent {
    constructor() {
        // Objeto primary do thfModal
        this.primaryAction = { label: 'ok', action: (/**
             * @return {?}
             */
            () => { }) };
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.closeSubscription.unsubscribe();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.closeSubscription = this.thfModal.onXClosed.subscribe((/**
         * @param {?} close
         * @return {?}
         */
        close => this.destroy()));
    }
    // Fecha o thfModal
    /**
     * @return {?}
     */
    close() {
        this.thfModal.close();
        this.destroy();
    }
    /**
     * @return {?}
     */
    destroy() {
        if (this.componentRef) {
            this.componentRef.destroy();
        }
    }
    // Insere os valores recebidos de this.open para o thfModal
    /**
     * @param {?=} primaryLabel
     * @param {?=} primaryAction
     * @param {?=} secondaryLabel
     * @param {?=} secondaryAction
     * @return {?}
     */
    configDialog(primaryLabel, primaryAction, secondaryLabel, secondaryAction) {
        this.primaryAction = {
            label: primaryLabel,
            action: (/**
             * @return {?}
             */
            () => {
                if (primaryAction) {
                    primaryAction();
                }
                this.close();
            })
        };
        if (secondaryLabel) {
            this.secondaryAction = {
                label: secondaryLabel,
                action: (/**
                 * @return {?}
                 */
                () => {
                    if (secondaryAction) {
                        secondaryAction();
                    }
                    this.close();
                })
            };
        }
    }
    // Insere os valores recebidos de thf-dialog.service de acordo com o tipo de di√°lago solicitado
    /**
     * @param {?} dialogOptions
     * @param {?} dialogType
     * @param {?=} componentRef
     * @return {?}
     */
    open(dialogOptions, dialogType, componentRef) {
        this.title = dialogOptions.title;
        this.message = dialogOptions.message;
        this.componentRef = componentRef;
        this.setDialogLiterals(dialogOptions, dialogType);
        switch (dialogType) {
            case ThfDialogType.Confirm: {
                this.configDialog(this.literalsConfirm.confirm, ((/** @type {?} */ (dialogOptions))).confirm, this.literalsConfirm.cancel, ((/** @type {?} */ (dialogOptions))).cancel);
                break;
            }
            case ThfDialogType.Alert: {
                this.configDialog(this.literalsAlert.ok, ((/** @type {?} */ (dialogOptions))).ok);
                break;
            }
        }
        this.thfModal.open();
    }
    /**
     * @private
     * @param {?} dialogOptions
     * @param {?} dialogType
     * @return {?}
     */
    setDialogLiterals(dialogOptions, dialogType) {
        /** @type {?} */
        const alertLiterals = thfDialogAlertLiteralsDefault;
        /** @type {?} */
        const confirmLiterals = thfDialogConfirmLiteralsDefault;
        /** @type {?} */
        const literals = dialogOptions.literals;
        if (dialogType === ThfDialogType.Alert) {
            this.literalsAlert = Object.assign({}, alertLiterals[thfLocaleDefault], alertLiterals[browserLanguage()], literals);
        }
        else {
            this.literalsConfirm = Object.assign({}, confirmLiterals[thfLocaleDefault], confirmLiterals[browserLanguage()], literals);
        }
    }
}
ThfDialogComponent.decorators = [
    { type: Component, args: [{
                template: "<thf-modal\n  [t-title]=\"title\"\n  [t-primary-action]=\"primaryAction\"\n  [t-secondary-action]=\"secondaryAction\">\n  {{ message }}\n</thf-modal>\n"
            }] }
];
ThfDialogComponent.propDecorators = {
    thfModal: [{ type: ViewChild, args: [ThfModalComponent, { static: true },] }]
};
if (false) {
    /** @type {?} */
    ThfDialogComponent.prototype.thfModal;
    /** @type {?} */
    ThfDialogComponent.prototype.title;
    /** @type {?} */
    ThfDialogComponent.prototype.message;
    /** @type {?} */
    ThfDialogComponent.prototype.primaryAction;
    /** @type {?} */
    ThfDialogComponent.prototype.secondaryAction;
    /** @type {?} */
    ThfDialogComponent.prototype.literalsAlert;
    /** @type {?} */
    ThfDialogComponent.prototype.literalsConfirm;
    /**
     * @type {?}
     * @private
     */
    ThfDialogComponent.prototype.componentRef;
    /**
     * @type {?}
     * @private
     */
    ThfDialogComponent.prototype.closeSubscription;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhmLWRpYWxvZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdG90dnMvdGhmLXVpLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL3RoZi1kaWFsb2cvdGhmLWRpYWxvZy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQW1DLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUl0RixPQUFPLEVBQUUsZUFBZSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFLckUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRWxELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdEQUFnRCxDQUFDOztBQUVuRixNQUFNLE9BQU8sNkJBQTZCLEdBQUc7SUFDM0MsRUFBRSxFQUFFLG1CQUF5QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBQTtJQUN6QyxFQUFFLEVBQUUsbUJBQXlCLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFBO0lBQ3pDLEVBQUUsRUFBRSxtQkFBeUIsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUE7Q0FDMUM7O0FBRUQsTUFBTSxPQUFPLCtCQUErQixHQUFHO0lBQzdDLEVBQUUsRUFBRSxtQkFBMkIsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsRUFBQTtJQUN2RSxFQUFFLEVBQUUsbUJBQTJCLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFLEVBQUE7SUFDM0UsRUFBRSxFQUFFLG1CQUEyQixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxFQUFBO0NBQzVFOzs7Ozs7OztBQWFELE1BQU0sT0FBTyxrQkFBa0I7SUFIL0I7O1FBY0Usa0JBQWEsR0FBbUIsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE1BQU07OztZQUFF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YUFBYSxDQUFDLGdCQUFnQixDQUFDLEVBQUssYUFBYSxDQUFDLGVBQWUsRUFBRSxDQUFDLEVBQUssUUFBUSxDQUFDLENBQUM7U0FDN0c7YUFBTTtZQUNMLElBQUksQ0FBQyxlQUFlLHFCQUFPLGVBQWUsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFLLGVBQWUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxFQUFLLFFBQVEsQ0FBQyxDQUFDO1NBQ25IO0lBQ0gsQ0FBQzs7O1lBakhGLFNBQVMsU0FBQztnQkFDVCxtS0FBMEM7YUFDM0M7Ozt1QkFHRSxTQUFTLFNBQUMsaUJBQWlCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzs7O0lBQTlDLHNDQUE0RTs7SUFHNUUsbUNBQWM7O0lBR2QscUNBQWdCOztJQUdoQiwyQ0FBbUU7O0lBR25FLDZDQUFnQzs7SUFHaEMsMkNBQXNDOztJQUd0Qyw2Q0FBMEM7Ozs7O0lBRzFDLDBDQUF1RDs7Ozs7SUFDdkQsK0NBQXdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBDb21wb25lbnRSZWYsIE9uRGVzdHJveSwgT25Jbml0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IGJyb3dzZXJMYW5ndWFnZSwgdGhmTG9jYWxlRGVmYXVsdCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWwnO1xuXG5pbXBvcnQgeyBUaGZEaWFsb2dBbGVydExpdGVyYWxzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3RoZi1kaWFsb2ctYWxlcnQtbGl0ZXJhbHMuaW50ZXJmYWNlJztcbmltcG9ydCB7IFRoZkRpYWxvZ0FsZXJ0T3B0aW9ucywgVGhmRGlhbG9nQ29uZmlybU9wdGlvbnMgfSBmcm9tICcuL2ludGVyZmFjZXMvdGhmLWRpYWxvZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgVGhmRGlhbG9nQ29uZmlybUxpdGVyYWxzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3RoZi1kaWFsb2ctY29uZmlybS1saXRlcmFscy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgVGhmRGlhbG9nVHlwZSB9IGZyb20gJy4vdGhmLWRpYWxvZy5lbnVtJztcbmltcG9ydCB7IFRoZk1vZGFsQWN0aW9uIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy90aGYtbW9kYWwvdGhmLW1vZGFsLWFjdGlvbi5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgVGhmTW9kYWxDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3RoZi1tb2RhbC90aGYtbW9kYWwuY29tcG9uZW50JztcblxuZXhwb3J0IGNvbnN0IHRoZkRpYWxvZ0FsZXJ0TGl0ZXJhbHNEZWZhdWx0ID0ge1xuICBlbjogPFRoZkRpYWxvZ0FsZXJ0TGl0ZXJhbHM+IHsgb2s6ICdPaycgfSxcbiAgZXM6IDxUaGZEaWFsb2dBbGVydExpdGVyYWxzPiB7IG9rOiAnT2snIH0sXG4gIHB0OiA8VGhmRGlhbG9nQWxlcnRMaXRlcmFscz4geyBvazogJ09rJyB9XG59O1xuXG5leHBvcnQgY29uc3QgdGhmRGlhbG9nQ29uZmlybUxpdGVyYWxzRGVmYXVsdCA9IHtcbiAgZW46IDxUaGZEaWFsb2dDb25maXJtTGl0ZXJhbHM+IHsgY2FuY2VsOiAnQ2FuY2VsJywgY29uZmlybTogJ0NvbmZpcm0nIH0sXG4gIGVzOiA8VGhmRGlhbG9nQ29uZmlybUxpdGVyYWxzPiB7IGNhbmNlbDogJ0NhbmNlbGFyJywgY29uZmlybTogJ0NvbmZpcm1hcicgfSxcbiAgcHQ6IDxUaGZEaWFsb2dDb25maXJtTGl0ZXJhbHM+IHsgY2FuY2VsOiAnQ2FuY2VsYXInLCBjb25maXJtOiAnQ29uZmlybWFyJyB9XG59O1xuXG4vKipcbiAqIEBkb2NzUHJpdmF0ZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIENvbXBvbmVudGUgcXVlIHNlcnZlIGNvbW8gY29udGFpbmVyIGRvIHRoZi1kaWFsb2cuc2VydmljZVxuICovXG5cbkBDb21wb25lbnQoe1xuICB0ZW1wbGF0ZVVybDogJy4vdGhmLWRpYWxvZy5jb21wb25lbnQuaHRtbCdcbn0pXG5leHBvcnQgY2xhc3MgVGhmRGlhbG9nQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95LCBPbkluaXQge1xuICAvLyBWaWV3Q2hpbGQgcGFyYSBvIHVzbyBkbyB0aGYtbW9kYWwuY29tcG9uZW50XG4gIEBWaWV3Q2hpbGQoVGhmTW9kYWxDb21wb25lbnQsIHsgc3RhdGljOiB0cnVlIH0pIHRoZk1vZGFsOiBUaGZNb2RhbENvbXBvbmVudDtcblxuICAvLyBUaXRsZSBkbyB0aGZNb2RhbFxuICB0aXRsZTogc3RyaW5nO1xuXG4gIC8vIE1lc3NhZ2UgZG8gdGhmTW9kYWxcbiAgbWVzc2FnZTogc3RyaW5nO1xuXG4gIC8vIE9iamV0byBwcmltYXJ5IGRvIHRoZk1vZGFsXG4gIHByaW1hcnlBY3Rpb246IFRoZk1vZGFsQWN0aW9uID0geyBsYWJlbDogJ29rJywgYWN0aW9uOiAoKSA9PiB7IH0gfTtcblxuICAvLyBPYmpldG8gc2Vjb25kYXJ5IGRvIHRoZk1vZGFsXG4gIHNlY29uZGFyeUFjdGlvbjogVGhmTW9kYWxBY3Rpb247XG5cbiAgLy8gTGl0ZXJhaXMgdXNhZGFzIG5vcyBib3TDo28gZGUgYWxlcnRhIGRvIHRoZk1vZGFsXG4gIGxpdGVyYWxzQWxlcnQ6IFRoZkRpYWxvZ0FsZXJ0TGl0ZXJhbHM7XG5cbiAgLy8gTGl0ZXJhaXMgdXNhZGFzIG5vcyBib3TDtWVzIGRlIGNvbmZpcm1hw6fDo28gZG8gdGhmTW9kYWxcbiAgbGl0ZXJhbHNDb25maXJtOiBUaGZEaWFsb2dDb25maXJtTGl0ZXJhbHM7XG5cbiAgLy8gQXRyaWJ1dG8gcGFyYSBhcm1hemVuYXIgYSByZWZlcmVuY2lhIGRvIGNvbXBvbmVudGUgY3JpYWRvIHZpYSBzZXJ2acOnby5cbiAgcHJpdmF0ZSBjb21wb25lbnRSZWY6IENvbXBvbmVudFJlZjxUaGZEaWFsb2dDb21wb25lbnQ+O1xuICBwcml2YXRlIGNsb3NlU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5jbG9zZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5jbG9zZVN1YnNjcmlwdGlvbiA9IHRoaXMudGhmTW9kYWwub25YQ2xvc2VkLnN1YnNjcmliZShjbG9zZSA9PiB0aGlzLmRlc3Ryb3koKSk7XG4gIH1cblxuICAgIC8vIEZlY2hhIG8gdGhmTW9kYWxcbiAgY2xvc2UoKTogdm9pZCB7XG4gICAgdGhpcy50aGZNb2RhbC5jbG9zZSgpO1xuICAgIHRoaXMuZGVzdHJveSgpO1xuICB9XG5cbiAgZGVzdHJveSgpIHtcbiAgICBpZiAodGhpcy5jb21wb25lbnRSZWYpIHtcbiAgICAgIHRoaXMuY29tcG9uZW50UmVmLmRlc3Ryb3koKTtcbiAgICB9XG4gIH1cblxuICAvLyBJbnNlcmUgb3MgdmFsb3JlcyByZWNlYmlkb3MgZGUgdGhpcy5vcGVuIHBhcmEgbyB0aGZNb2RhbFxuICBjb25maWdEaWFsb2cocHJpbWFyeUxhYmVsPywgcHJpbWFyeUFjdGlvbj8sIHNlY29uZGFyeUxhYmVsPywgc2Vjb25kYXJ5QWN0aW9uPykge1xuXG4gICAgdGhpcy5wcmltYXJ5QWN0aW9uID0ge1xuICAgICAgbGFiZWw6IHByaW1hcnlMYWJlbCxcbiAgICAgIGFjdGlvbjogKCkgPT4ge1xuICAgICAgICAgIGlmIChwcmltYXJ5QWN0aW9uKSB7XG4gICAgICAgICAgICBwcmltYXJ5QWN0aW9uKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKHNlY29uZGFyeUxhYmVsKSB7XG4gICAgICB0aGlzLnNlY29uZGFyeUFjdGlvbiA9IHtcbiAgICAgICAgbGFiZWw6IHNlY29uZGFyeUxhYmVsLFxuICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICBpZiAoc2Vjb25kYXJ5QWN0aW9uKSB7XG4gICAgICAgICAgICBzZWNvbmRhcnlBY3Rpb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIEluc2VyZSBvcyB2YWxvcmVzIHJlY2ViaWRvcyBkZSB0aGYtZGlhbG9nLnNlcnZpY2UgZGUgYWNvcmRvIGNvbSBvIHRpcG8gZGUgZGnDoWxhZ28gc29saWNpdGFkb1xuICBvcGVuKGRpYWxvZ09wdGlvbnM6IChUaGZEaWFsb2dDb25maXJtT3B0aW9ucyB8IFRoZkRpYWxvZ0FsZXJ0T3B0aW9ucyksXG4gICAgICAgZGlhbG9nVHlwZTogVGhmRGlhbG9nVHlwZSxcbiAgICAgICBjb21wb25lbnRSZWY/OiBDb21wb25lbnRSZWY8VGhmRGlhbG9nQ29tcG9uZW50Pik6IHZvaWQge1xuXG4gICAgdGhpcy50aXRsZSA9IGRpYWxvZ09wdGlvbnMudGl0bGU7XG4gICAgdGhpcy5tZXNzYWdlID0gZGlhbG9nT3B0aW9ucy5tZXNzYWdlO1xuXG4gICAgdGhpcy5jb21wb25lbnRSZWYgPSBjb21wb25lbnRSZWY7XG5cbiAgICB0aGlzLnNldERpYWxvZ0xpdGVyYWxzKGRpYWxvZ09wdGlvbnMsIGRpYWxvZ1R5cGUpO1xuXG4gICAgc3dpdGNoIChkaWFsb2dUeXBlKSB7XG4gICAgICBjYXNlIFRoZkRpYWxvZ1R5cGUuQ29uZmlybToge1xuICAgICAgICB0aGlzLmNvbmZpZ0RpYWxvZyhcbiAgICAgICAgICB0aGlzLmxpdGVyYWxzQ29uZmlybS5jb25maXJtLCAoPFRoZkRpYWxvZ0NvbmZpcm1PcHRpb25zPmRpYWxvZ09wdGlvbnMpLmNvbmZpcm0sXG4gICAgICAgICAgdGhpcy5saXRlcmFsc0NvbmZpcm0uY2FuY2VsLCAoPFRoZkRpYWxvZ0NvbmZpcm1PcHRpb25zPmRpYWxvZ09wdGlvbnMpLmNhbmNlbCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBUaGZEaWFsb2dUeXBlLkFsZXJ0OiB7XG4gICAgICAgIHRoaXMuY29uZmlnRGlhbG9nKHRoaXMubGl0ZXJhbHNBbGVydC5vaywgKDxUaGZEaWFsb2dBbGVydE9wdGlvbnM+ZGlhbG9nT3B0aW9ucykub2spO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnRoZk1vZGFsLm9wZW4oKTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0RGlhbG9nTGl0ZXJhbHMoZGlhbG9nT3B0aW9uczogVGhmRGlhbG9nQ29uZmlybU9wdGlvbnMgfCBUaGZEaWFsb2dBbGVydE9wdGlvbnMsIGRpYWxvZ1R5cGU6IFRoZkRpYWxvZ1R5cGUpIHtcbiAgICBjb25zdCBhbGVydExpdGVyYWxzID0gdGhmRGlhbG9nQWxlcnRMaXRlcmFsc0RlZmF1bHQ7XG4gICAgY29uc3QgY29uZmlybUxpdGVyYWxzID0gdGhmRGlhbG9nQ29uZmlybUxpdGVyYWxzRGVmYXVsdDtcbiAgICBjb25zdCBsaXRlcmFscyA9IGRpYWxvZ09wdGlvbnMubGl0ZXJhbHM7XG5cbiAgICBpZiAoZGlhbG9nVHlwZSA9PT0gVGhmRGlhbG9nVHlwZS5BbGVydCkge1xuICAgICAgdGhpcy5saXRlcmFsc0FsZXJ0ID0gey4uLmFsZXJ0TGl0ZXJhbHNbdGhmTG9jYWxlRGVmYXVsdF0sIC4uLmFsZXJ0TGl0ZXJhbHNbYnJvd3Nlckxhbmd1YWdlKCldLCAuLi5saXRlcmFsc307XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGl0ZXJhbHNDb25maXJtID0gey4uLmNvbmZpcm1MaXRlcmFsc1t0aGZMb2NhbGVEZWZhdWx0XSwgLi4uY29uZmlybUxpdGVyYWxzW2Jyb3dzZXJMYW5ndWFnZSgpXSwgLi4ubGl0ZXJhbHN9O1xuICAgIH1cbiAgfVxufVxuIl19