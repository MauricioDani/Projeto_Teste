/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { isMobile, setYearFrom0To100, validateDateRange } from '../../../../utils/util';
import { ThfCalendarLangService } from './thf-calendar.lang.service';
import { ThfCalendarService } from './thf-calendar.service';
/** @type {?} */
const thfCalendarLocaleDefault = 'pt';
/** @type {?} */
const thfCalendarLocales = ['pt', 'en', 'es'];
/**
 * \@docsPrivate
 *
 * \@description
 *
 * Componente de calendário de uso interno
 */
export class ThfCalendarComponent {
    /**
     * @param {?} thfCalendarService
     * @param {?} thfCalendarLangService
     */
    constructor(thfCalendarService, thfCalendarLangService) {
        this.thfCalendarService = thfCalendarService;
        this.thfCalendarLangService = thfCalendarLangService;
        this.dayVisible = false;
        this.displayMonths = Array();
        this.displayWeedDays = Array();
        this.monthVisible = false;
        this.overlayInvisible = true;
        this.visible = false;
        this.yearVisible = false;
        this.isMobile = isMobile;
        this.today = new Date();
        this.selectedDateChange = new EventEmitter();
        this.submit = new EventEmitter();
    }
    /**
     * \@optional
     *
     * \@description
     *
     * Data máxima possível de ser selecionada no calendário.
     * @param {?} val
     * @return {?}
     */
    set dateEnd(val) {
        if (val && val instanceof Date) {
            /** @type {?} */
            const year = val.getFullYear();
            /** @type {?} */
            const month = val.getMonth();
            /** @type {?} */
            const day = val.getDate();
            /** @type {?} */
            const date = new Date(year, month, day, 23, 59, 59);
            setYearFrom0To100(date, year);
            this._dateEnd = date;
        }
        else {
            this._dateEnd = undefined;
        }
    }
    /**
     * @return {?}
     */
    get dateEnd() {
        return this._dateEnd;
    }
    /**
     * \@optional
     *
     * \@description
     *
     * Idioma do calendário.
     *
     * Valores válidos:
     *  - `pt`
     *  - `en`
     *  - `es`
     * @param {?} locale
     * @return {?}
     */
    set locale(locale) {
        this._locale = thfCalendarLocales.includes(locale) ? locale : thfCalendarLocaleDefault;
        this.initializeLanguage();
    }
    /**
     * @return {?}
     */
    get locale() {
        return this._locale;
    }
    /**
     * \@optional
     *
     * \@description
     *
     * Data selecionada no calendário.
     * @param {?} selectedDate
     * @return {?}
     */
    set selectedDate(selectedDate) {
        this._selectedDate = selectedDate && selectedDate instanceof Date ? selectedDate : undefined;
    }
    /**
     * @return {?}
     */
    get selectedDate() {
        return this._selectedDate;
    }
    /**
     * \@optional
     *
     * \@description
     *
     * Data mínima possível de ser selecionada no calendário.
     * @param {?} val
     * @return {?}
     */
    set dateStart(val) {
        if (val && val instanceof Date) {
            /** @type {?} */
            const year = val.getFullYear();
            /** @type {?} */
            const month = val.getMonth();
            /** @type {?} */
            const day = val.getDate();
            /** @type {?} */
            const date = new Date(year, month, day, 0, 0, 0);
            setYearFrom0To100(date, year);
            this._dateStart = date;
        }
        else {
            this._dateStart = undefined;
        }
    }
    /**
     * @return {?}
     */
    get dateStart() {
        return this._dateStart;
    }
    /**
     * @return {?}
     */
    close() {
        this.overlayInvisible = true;
        this.visible = false;
    }
    // Obtém um array de todos os anos desta década
    /**
     * @param {?} year
     * @return {?}
     */
    getArrayDecade(year) {
        this.displayDecade = Array();
        if (year % 10 !== 0) {
            while (year % 10 !== 0) {
                year--;
            }
        }
        this.updateDecade(year);
    }
    /**
     * @param {?} displayValue
     * @param {?} propertyValue
     * @return {?}
     */
    getBackgroundColor(displayValue, propertyValue) {
        return (displayValue === propertyValue) ? 'thf-calendar-box-background-selected' : 'thf-calendar-box-background';
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getDayBackgroundColor(date) {
        if (this.equalsDate(date, this.selectedDate)) {
            return 'thf-calendar-box-background-selected';
        }
        else if (this.equalsDate(date, this.today)) {
            return 'thf-calendar-box-background-today';
        }
        else if (date) {
            if (validateDateRange(date, this.dateStart, this.dateEnd)) {
                return 'thf-calendar-box-background';
            }
            else {
                return 'thf-calendar-box-background-disabled';
            }
        }
        else {
            return '';
        }
    }
    /**
     * @param {?} date
     * @return {?}
     */
    getDayForegroundColor(date) {
        if (this.equalsDate(date, this.selectedDate)) {
            return 'thf-calendar-box-foreground-selected';
        }
        else if (this.equalsDate(date, this.today)) {
            return 'thf-calendar-box-foreground-today';
        }
        else {
            if (validateDateRange(date, this.dateStart, this.dateEnd)) {
                return 'thf-calendar-box-foreground';
            }
            else {
                return 'thf-calendar-box-foreground-disabled';
            }
        }
    }
    /**
     * @param {?} displayValue
     * @param {?} propertyValue
     * @return {?}
     */
    getForegroundColor(displayValue, propertyValue) {
        return (displayValue === propertyValue) ? 'thf-calendar-box-foreground-selected' : 'thf-calendar-box-foreground';
    }
    /**
     * @return {?}
     */
    getWordMonth() {
        return this.thfCalendarLangService.getWordMonth();
    }
    /**
     * @return {?}
     */
    getWordYear() {
        return this.thfCalendarLangService.getWordYear();
    }
    /**
     * @return {?}
     */
    init() {
        this.selectedDate ? this.updateDate(this.selectedDate) : this.updateDate(this.today);
        this.initializeLanguage();
        this.selectDay();
        if (this.isMobile()) {
            this.overlayInvisible = false;
        }
        this.visible = true;
    }
    /**
     * @return {?}
     */
    initializeLanguage() {
        this.thfCalendarLangService.setLanguage(this.locale);
        this.displayWeedDays = this.thfCalendarLangService.getArrayWeekDays();
        this.displayMonths = this.thfCalendarLangService.getArrayMonths();
    }
    /**
     * @return {?}
     */
    onNextMonth() {
        if (this.displayMonthNumber < 11) {
            this.updateDisplay(this.displayYear, this.displayMonthNumber + 1);
        }
        else {
            this.updateDisplay(this.displayYear + 1, 0);
        }
    }
    /**
     * @return {?}
     */
    onPrevMonth() {
        if (this.displayMonthNumber > 0) {
            this.updateDisplay(this.displayYear, this.displayMonthNumber - 1);
        }
        else {
            this.updateDisplay(this.displayYear - 1, 11);
        }
    }
    // Ao selecionar uma data
    /**
     * @param {?} date
     * @return {?}
     */
    onSelectDate(date) {
        if (validateDateRange(date, this.dateStart, this.dateEnd)) {
            this.selectedDate = date;
            this.selectedDateChange.emit(date);
            this.submit.emit(date);
        }
    }
    // Ao selecionar um mês
    /**
     * @param {?} year
     * @param {?} month
     * @return {?}
     */
    onSelectMonth(year, month) {
        this.selectDay();
        this.updateDisplay(year, month);
    }
    // Ao selecionar um ano
    /**
     * @param {?} year
     * @param {?} month
     * @return {?}
     */
    onSelectYear(year, month) {
        // Se veio da tela de seleção de mês
        this.lastDisplay === 'month' ? this.selectMonth() : this.selectDay();
        this.currentYear = year;
        this.updateDisplay(year, month);
    }
    /**
     * @return {?}
     */
    selectDay() {
        this.dayVisible = true;
        this.monthVisible = false;
        this.yearVisible = false;
        this.lastDisplay = 'day';
    }
    /**
     * @return {?}
     */
    selectMonth() {
        this.dayVisible = false;
        this.monthVisible = true;
        this.yearVisible = false;
        this.lastDisplay = 'month';
    }
    /**
     * @return {?}
     */
    selectYear() {
        this.dayVisible = false;
        this.monthVisible = false;
        this.yearVisible = true;
    }
    /**
     * @return {?}
     */
    setMobileVisualization() {
        return this.isMobile() ? 'thf-calendar thf-calendar-mobile' : 'thf-calendar';
    }
    /**
     * @param {?} value
     * @return {?}
     */
    updateYear(value) {
        this.updateDisplay(this.displayYear + value, this.displayMonthNumber);
    }
    /**
     * @private
     * @param {?} year
     * @return {?}
     */
    addAllYearsInDecade(year) {
        /** @type {?} */
        let i;
        for (i = year; i < year + 10; i++) {
            this.displayDecade.push(i);
        }
    }
    /**
     * @private
     * @param {?} date1
     * @param {?} date2
     * @return {?}
     */
    equalsDate(date1, date2) {
        try {
            return date1.getFullYear() === date2.getFullYear() &&
                date1.getMonth() === date2.getMonth() &&
                date1.getDate() === date2.getDate();
        }
        catch (error) {
            return false;
        }
    }
    /**
     * @private
     * @param {?} date
     * @return {?}
     */
    updateDate(date) {
        this.currentMonthNumber = date.getMonth();
        this.currentYear = date.getFullYear();
        this.updateDisplay(this.currentYear, this.currentMonthNumber);
    }
    /**
     * @private
     * @param {?} year
     * @return {?}
     */
    updateDecade(year) {
        this.addAllYearsInDecade(year);
        this.displayStartDecade = year;
        this.displayFinalDecade = year + 9;
    }
    /**
     * @private
     * @param {?} year
     * @param {?} month
     * @return {?}
     */
    updateDisplay(year, month) {
        /** @type {?} */
        const calendarArray = this.thfCalendarService.monthDays(year, month);
        this.displayDays = [].concat.apply([], calendarArray);
        this.displayMonthNumber = month;
        this.displayMonth = this.displayMonths[month];
        this.displayYear = year;
        this.getArrayDecade(year);
    }
}
ThfCalendarComponent.decorators = [
    { type: Component, args: [{
                selector: 'thf-calendar',
                template: "<div class=\"thf-calendar-overlay\" [class.thf-invisible]=\"overlayInvisible\"></div>\n<div *ngIf=\"visible\" [ngClass]=\"setMobileVisualization()\">\n  <div *ngIf=\"dayVisible\" #days>\n    <div class=\"thf-calendar-nav\">\n      <span (click)=\"onPrevMonth()\" class=\"thf-calendar-nav-left thf-icon thf-icon-arrow-left\"></span>\n      <div class=\"thf-calendar-nav-title\" attr-calendar>\n        <span class=\"thf-clickable thf-mr-1\" (click)=\"selectMonth()\">{{ displayMonth }}</span>\n        <span class=\"thf-clickable\" (click)=\"selectYear()\">{{ displayYear }}</span>\n      </div>\n      <span (click)=\"onNextMonth()\" class=\"thf-calendar-nav-right thf-icon thf-icon-arrow-right\"></span>\n    </div>\n    <div class=\"thf-calendar-content\">\n      <div class=\"thf-calendar-labels\">\n        <div class=\"thf-calendar-label\" *ngFor=\"let day of displayWeedDays\">\n            {{ day.toLowerCase() }}\n        </div>\n      </div>\n      <div class=\"thf-calendar-content-list-day\">\n        <div *ngFor=\"let day of displayDays\" class=\"thf-calendar-day thf-calendar-box-background\" (click)=\"onSelectDate(day)\"\n          [ngClass]=\"getDayBackgroundColor(day)\">\n          <span *ngIf=\"day != 0\" [ngClass]=\"getDayForegroundColor(day)\">\n            {{ day.getDate() }}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"monthVisible\" #months>\n    <div class=\"thf-calendar-nav\">\n      <span (click)=\"updateYear(-1)\" class=\"thf-calendar-nav-left thf-icon thf-icon-arrow-left\"></span>\n      <div class=\"thf-calendar-nav-title\" attr-calendar>\n        <span class=\"thf-clickable\" (click)=\"selectYear()\">{{ displayYear }}</span>\n      </div>\n      <span (click)=\"updateYear(1)\" class=\"thf-calendar-nav-right thf-icon thf-icon-arrow-right\"></span>\n    </div>\n    <div class=\"thf-calendar-content\">\n      <div class=\"thf-calendar-labels\">\n        <div class=\"thf-calendar-label\">\n          {{ getWordMonth() }}\n        </div>\n      </div>\n      <div class=\"thf-calendar-content-list-month\">\n        <div *ngFor=\"let month of displayMonths; let i = index;\" class=\"thf-calendar-month\"\n        (click)=\"onSelectMonth(displayYear, i)\"\n        [ngClass]=\"getBackgroundColor(i, displayMonthNumber)\" attr-calendar>\n          <span [ngClass]=\"getForegroundColor(i, displayMonthNumber)\">\n            {{ month }}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"yearVisible\" #years>\n    <div class=\"thf-calendar-nav\">\n      <span (click)=\"updateYear(-10)\" class=\"thf-calendar-nav-left thf-icon thf-icon-arrow-left\"></span>\n      <div class=\"thf-calendar-nav-title\">\n        {{ displayStartDecade }} - {{ displayFinalDecade }}\n      </div>\n      <span (click)=\"updateYear(10)\" class=\"thf-calendar-nav-right thf-icon thf-icon-arrow-right\"></span>\n    </div>\n    <div class=\"thf-calendar-content\">\n      <div class=\"thf-calendar-labels\">\n        <div class=\"thf-calendar-label\">\n          {{ getWordYear() }}\n        </div>\n      </div>\n      <div class=\"thf-calendar-content-list-year\">\n        <div *ngFor=\"let year of displayDecade; let i = index;\" class=\"thf-calendar-year\"\n        (click)=\"onSelectYear(year, displayMonthNumber)\"\n        [ngClass]=\"getBackgroundColor(year, currentYear)\" attr-calendar>\n          <span [ngClass]=\"getForegroundColor(year, currentYear)\">\n            {{ year }}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n",
                providers: [ThfCalendarService, ThfCalendarLangService]
            }] }
];
/** @nocollapse */
ThfCalendarComponent.ctorParameters = () => [
    { type: ThfCalendarService },
    { type: ThfCalendarLangService }
];
ThfCalendarComponent.propDecorators = {
    elDays: [{ type: ViewChild, args: ['days', { read: ElementRef, static: true },] }],
    elMonths: [{ type: ViewChild, args: ['months', { read: ElementRef, static: true },] }],
    elYears: [{ type: ViewChild, args: ['years', { read: ElementRef, static: true },] }],
    dateEnd: [{ type: Input, args: ['t-date-end',] }],
    locale: [{ type: Input, args: ['t-locale',] }],
    selectedDate: [{ type: Input, args: ['t-selected-date',] }],
    dateStart: [{ type: Input, args: ['t-date-start',] }],
    selectedDateChange: [{ type: Output, args: ['t-selected-dateChange',] }],
    submit: [{ type: Output, args: ['t-submit',] }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype._dateEnd;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype._dateStart;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype._locale;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype._selectedDate;
    /** @type {?} */
    ThfCalendarComponent.prototype.dayVisible;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayDays;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayDecade;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayFinalDecade;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayMonth;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayMonths;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayStartDecade;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayWeedDays;
    /** @type {?} */
    ThfCalendarComponent.prototype.displayYear;
    /** @type {?} */
    ThfCalendarComponent.prototype.monthVisible;
    /** @type {?} */
    ThfCalendarComponent.prototype.overlayInvisible;
    /** @type {?} */
    ThfCalendarComponent.prototype.visible;
    /** @type {?} */
    ThfCalendarComponent.prototype.yearVisible;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.currentMonthNumber;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.currentYear;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.displayMonthNumber;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.isMobile;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.lastDisplay;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.today;
    /** @type {?} */
    ThfCalendarComponent.prototype.elDays;
    /** @type {?} */
    ThfCalendarComponent.prototype.elMonths;
    /** @type {?} */
    ThfCalendarComponent.prototype.elYears;
    /** @type {?} */
    ThfCalendarComponent.prototype.selectedDateChange;
    /** @type {?} */
    ThfCalendarComponent.prototype.submit;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.thfCalendarService;
    /**
     * @type {?}
     * @private
     */
    ThfCalendarComponent.prototype.thfCalendarLangService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhmLWNhbGVuZGFyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0b3R2cy90aGYtdWkvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90aGYtZmllbGQvdGhmLWRhdGVwaWNrZXIvdGhmLWNhbGVuZGFyL3RoZi1jYWxlbmRhci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUU5RixPQUFPLEVBQUUsUUFBUSxFQUFFLGlCQUFpQixFQUFFLGlCQUFpQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDeEYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDckUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7O01BRXRELHdCQUF3QixHQUFHLElBQUk7O01BQy9CLGtCQUFrQixHQUFHLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7Ozs7Ozs7O0FBYzdDLE1BQU0sT0FBTyxvQkFBb0I7Ozs7O0lBdUgvQixZQUNVLGtCQUFzQyxFQUN0QyxzQkFBOEM7UUFEOUMsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFvQjtRQUN0QywyQkFBc0IsR0FBdEIsc0JBQXNCLENBQXdCO1FBbEh4RCxlQUFVLEdBQVksS0FBSyxDQUFDO1FBSzVCLGtCQUFhLEdBQWUsS0FBSyxFQUFFLENBQUM7UUFFcEMsb0JBQWUsR0FBZSxLQUFLLEVBQUUsQ0FBQztRQUV0QyxpQkFBWSxHQUFZLEtBQUssQ0FBQztRQUM5QixxQkFBZ0IsR0FBWSxJQUFJLENBQUM7UUFDakMsWUFBTyxHQUFZLEtBQUssQ0FBQztRQUN6QixnQkFBVyxHQUFZLEtBQUssQ0FBQztRQUtyQixhQUFRLEdBQVEsUUFBUSxDQUFDO1FBRXpCLFVBQUssR0FBUyxJ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LDJDQUEyQjs7SUFDM0IsNkNBQTZCOztJQUM3QixrREFBMkI7O0lBQzNCLDRDQUFrQjs7SUFDbEIsNkNBQW9DOztJQUNwQyxrREFBMkI7O0lBQzNCLCtDQUFzQzs7SUFDdEMsMkNBQW9COztJQUNwQiw0Q0FBOEI7O0lBQzlCLGdEQUFpQzs7SUFDakMsdUNBQXlCOztJQUN6QiwyQ0FBNkI7Ozs7O0lBRTdCLGtEQUFtQzs7Ozs7SUFDbkMsMkNBQTRCOzs7OztJQUM1QixrREFBbUM7Ozs7O0lBQ25DLHdDQUFpQzs7Ozs7SUFDakMsMkNBQTRCOzs7OztJQUM1QixxQ0FBaUM7O0lBRWpDLHNDQUEwRTs7SUFDMUUsd0NBQThFOztJQUM5RSx1Q0FBNEU7O0lBc0Y1RSxrREFBK0U7O0lBQy9FLHNDQUFzRDs7Ozs7SUFHcEQsa0RBQThDOzs7OztJQUM5QyxzREFBc0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IGlzTW9iaWxlLCBzZXRZZWFyRnJvbTBUbzEwMCwgdmFsaWRhdGVEYXRlUmFuZ2UgfSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy91dGlsJztcbmltcG9ydCB7IFRoZkNhbGVuZGFyTGFuZ1NlcnZpY2UgfSBmcm9tICcuL3RoZi1jYWxlbmRhci5sYW5nLnNlcnZpY2UnO1xuaW1wb3J0IHsgVGhmQ2FsZW5kYXJTZXJ2aWNlIH0gZnJvbSAnLi90aGYtY2FsZW5kYXIuc2VydmljZSc7XG5cbmNvbnN0IHRoZkNhbGVuZGFyTG9jYWxlRGVmYXVsdCA9ICdwdCc7XG5jb25zdCB0aGZDYWxlbmRhckxvY2FsZXMgPSBbJ3B0JywgJ2VuJywgJ2VzJ107XG5cbi8qKlxuICogQGRvY3NQcml2YXRlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogQ29tcG9uZW50ZSBkZSBjYWxlbmTDoXJpbyBkZSB1c28gaW50ZXJub1xuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0aGYtY2FsZW5kYXInLFxuICB0ZW1wbGF0ZVVybDogJy4vdGhmLWNhbGVuZGFyLmNvbXBvbmVudC5odG1sJyxcbiAgcHJvdmlkZXJzOiBbVGhmQ2FsZW5kYXJTZXJ2aWNlLCBUaGZDYWxlbmRhckxhbmdTZXJ2aWNlIF1cbn0pXG5leHBvcnQgY2xhc3MgVGhmQ2FsZW5kYXJDb21wb25lbnQge1xuXG4gIHByaXZhdGUgX2RhdGVFbmQ6IERhdGU7XG4gIHByaXZhdGUgX2RhdGVTdGFydDogRGF0ZTtcbiAgcHJpdmF0ZSBfbG9jYWxlOiBzdHJpbmc7XG4gIHByaXZhdGUgX3NlbGVjdGVkRGF0ZT86IERhdGU7XG5cbiAgZGF5VmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuICBkaXNwbGF5RGF5czogQXJyYXk8bnVtYmVyPjtcbiAgZGlzcGxheURlY2FkZTogQXJyYXk8bnVtYmVyPjtcbiAgZGlzcGxheUZpbmFsRGVjYWRlOiBudW1iZXI7XG4gIGRpc3BsYXlNb250aDogYW55O1xuICBkaXNwbGF5TW9udGhzOiBBcnJheTxhbnk+ID0gQXJyYXkoKTtcbiAgZGlzcGxheVN0YXJ0RGVjYWRlOiBudW1iZXI7XG4gIGRpc3BsYXlXZWVkRGF5czogQXJyYXk8YW55PiA9IEFycmF5KCk7XG4gIGRpc3BsYXlZZWFyOiBudW1iZXI7XG4gIG1vbnRoVmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuICBvdmVybGF5SW52aXNpYmxlOiBib29sZWFuID0gdHJ1ZTtcbiAgdmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuICB5ZWFyVmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgY3VycmVudE1vbnRoTnVtYmVyOiBudW1iZXI7XG4gIHByaXZhdGUgY3VycmVudFllYXI6IG51bWJlcjtcbiAgcHJpdmF0ZSBkaXNwbGF5TW9udGhOdW1iZXI6IG51bWJlcjtcbiAgcHJpdmF0ZSBpc01vYmlsZTogYW55ID0gaXNNb2JpbGU7XG4gIHByaXZhdGUgbGFzdERpc3BsYXk6IHN0cmluZztcbiAgcHJpdmF0ZSB0b2RheTogRGF0ZSA9IG5ldyBEYXRlKCk7XG5cbiAgQFZpZXdDaGlsZCgnZGF5cycsIHsgcmVhZDogRWxlbWVudFJlZiwgc3RhdGljOiB0cnVlIH0pIGVsRGF5czogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnbW9udGhzJywgeyByZWFkOiBFbGVtZW50UmVmLCBzdGF0aWM6IHRydWUgfSkgZWxNb250aHM6IEVsZW1lbnRSZWY7XG4gIEBWaWV3Q2hpbGQoJ3llYXJzJywgeyByZWFkOiBFbGVtZW50UmVmLCBzdGF0aWM6IHRydWUgfSkgZWxZZWFyczogRWxlbWVudFJlZjtcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBEYXRhIG3DoXhpbWEgcG9zc8OtdmVsIGRlIHNlciBzZWxlY2lvbmFkYSBubyBjYWxlbmTDoXJpby5cbiAgICovXG4gIEBJbnB1dCgndC1kYXRlLWVuZCcpIHNldCBkYXRlRW5kKHZhbDogRGF0ZSkge1xuICAgIGlmICh2YWwgJiYgdmFsIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgY29uc3QgeWVhciA9IHZhbC5nZXRGdWxsWWVhcigpO1xuICAgICAgY29uc3QgbW9udGggPSB2YWwuZ2V0TW9udGgoKTtcbiAgICAgIGNvbnN0IGRheSA9IHZhbC5nZXREYXRlKCk7XG5cbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5LCAyMywgNTksIDU5KTtcbiAgICAgIHNldFllYXJGcm9tMFRvMTAwKGRhdGUsIHllYXIpO1xuXG4gICAgICB0aGlzLl9kYXRlRW5kID0gZGF0ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZGF0ZUVuZCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cbiAgZ2V0IGRhdGVFbmQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RhdGVFbmQ7XG4gIH1cblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBJZGlvbWEgZG8gY2FsZW5kw6FyaW8uXG4gICAqXG4gICAqIFZhbG9yZXMgdsOhbGlkb3M6XG4gICAqICAtIGBwdGBcbiAgICogIC0gYGVuYFxuICAgKiAgLSBgZXNgXG4gICAqL1xuICBASW5wdXQoJ3QtbG9jYWxlJykgc2V0IGxvY2FsZShsb2NhbGU6IHN0cmluZykge1xuICAgIHRoaXMuX2xvY2FsZSA9IHRoZkNhbGVuZGFyTG9jYWxlcy5pbmNsdWRlcyhsb2NhbGUpID8gbG9jYWxlIDogdGhmQ2FsZW5kYXJMb2NhbGVEZWZhdWx0O1xuICAgIHRoaXMuaW5pdGlhbGl6ZUxhbmd1YWdlKCk7XG4gIH1cbiAgZ2V0IGxvY2FsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fbG9jYWxlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRGF0YSBzZWxlY2lvbmFkYSBubyBjYWxlbmTDoXJpby5cbiAgICovXG4gIEBJbnB1dCgndC1zZWxlY3RlZC1kYXRlJykgc2V0IHNlbGVjdGVkRGF0ZShzZWxlY3RlZERhdGU6IERhdGUpIHtcbiAgICB0aGlzLl9zZWxlY3RlZERhdGUgID0gc2VsZWN0ZWREYXRlICYmIHNlbGVjdGVkRGF0ZSBpbnN0YW5jZW9mIERhdGUgPyBzZWxlY3RlZERhdGUgOiB1bmRlZmluZWQ7XG4gIH1cbiAgZ2V0IHNlbGVjdGVkRGF0ZSgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5fc2VsZWN0ZWREYXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRGF0YSBtw61uaW1hIHBvc3PDrXZlbCBkZSBzZXIgc2VsZWNpb25hZGEgbm8gY2FsZW5kw6FyaW8uXG4gICAqL1xuICBASW5wdXQoJ3QtZGF0ZS1zdGFydCcpIHNldCBkYXRlU3RhcnQodmFsOiBEYXRlKSB7XG4gICAgaWYgKHZhbCAmJiB2YWwgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICBjb25zdCB5ZWFyID0gdmFsLmdldEZ1bGxZZWFyKCk7XG4gICAgICBjb25zdCBtb250aCA9IHZhbC5nZXRNb250aCgpO1xuICAgICAgY29uc3QgZGF5ID0gdmFsLmdldERhdGUoKTtcblxuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXksIDAsIDAsIDApO1xuICAgICAgc2V0WWVhckZyb20wVG8xMDAoZGF0ZSwgeWVhcik7XG5cbiAgICAgIHRoaXMuX2RhdGVTdGFydCA9IGRhdGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2RhdGVTdGFydCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cbiAgZ2V0IGRhdGVTdGFydCgpIHtcbiAgICByZXR1cm4gdGhpcy5fZGF0ZVN0YXJ0O1xuICB9XG5cbiAgQE91dHB1dCgndC1zZWxlY3RlZC1kYXRlQ2hhbmdlJykgc2VsZWN0ZWREYXRlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxEYXRlPigpO1xuICBAT3V0cHV0KCd0LXN1Ym1pdCcpIHN1Ym1pdCA9IG5ldyBFdmVudEVtaXR0ZXI8RGF0ZT4oKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHRoZkNhbGVuZGFyU2VydmljZTogVGhmQ2FsZW5kYXJTZXJ2aWNlLFxuICAgIHByaXZhdGUgdGhmQ2FsZW5kYXJMYW5nU2VydmljZTogVGhmQ2FsZW5kYXJMYW5nU2VydmljZSkge1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5vdmVybGF5SW52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgfVxuXG4gIC8vIE9idMOpbSB1bSBhcnJheSBkZSB0b2RvcyBvcyBhbm9zIGRlc3RhIGTDqWNhZGFcbiAgZ2V0QXJyYXlEZWNhZGUoeWVhcikge1xuICAgIHRoaXMuZGlzcGxheURlY2FkZSA9IEFycmF5KCk7XG5cbiAgICBpZiAoeWVhciAlIDEwICE9PSAwKSB7XG4gICAgICB3aGlsZSAoeWVhciAlIDEwICE9PSAwKSB7XG4gICAgICAgIHllYXItLTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy51cGRhdGVEZWNhZGUoeWVhcik7XG4gIH1cblxuICBnZXRCYWNrZ3JvdW5kQ29sb3IoZGlzcGxheVZhbHVlOiBudW1iZXIsIHByb3BlcnR5VmFsdWU6IG51bWJlcikge1xuICAgIHJldHVybiAoZGlzcGxheVZhbHVlID09PSBwcm9wZXJ0eVZhbHVlKSA/ICd0aGYtY2FsZW5kYXItYm94LWJhY2tncm91bmQtc2VsZWN0ZWQnIDogJ3RoZi1jYWxlbmRhci1ib3gtYmFja2dyb3VuZCc7XG4gIH1cblxuICBnZXREYXlCYWNrZ3JvdW5kQ29sb3IoZGF0ZTogRGF0ZSkge1xuICAgIGlmICh0aGlzLmVxdWFsc0RhdGUoZGF0ZSwgdGhpcy5zZWxlY3RlZERhdGUpKSB7XG4gICAgICByZXR1cm4gJ3RoZi1jYWxlbmRhci1ib3gtYmFja2dyb3VuZC1zZWxlY3RlZCc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmVxdWFsc0RhdGUoZGF0ZSwgdGhpcy50b2RheSkpIHtcbiAgICAgIHJldHVybiAndGhmLWNhbGVuZGFyLWJveC1iYWNrZ3JvdW5kLXRvZGF5JztcbiAgICB9IGVsc2UgaWYgKGRhdGUpIHtcbiAgICAgIGlmICh2YWxpZGF0ZURhdGVSYW5nZShkYXRlLCB0aGlzLmRhdGVTdGFydCwgdGhpcy5kYXRlRW5kKSkge1xuICAgICAgICByZXR1cm4gJ3RoZi1jYWxlbmRhci1ib3gtYmFja2dyb3VuZCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ3RoZi1jYWxlbmRhci1ib3gtYmFja2dyb3VuZC1kaXNhYmxlZCc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICBnZXREYXlGb3JlZ3JvdW5kQ29sb3IoZGF0ZTogRGF0ZSkge1xuICAgIGlmICh0aGlzLmVxdWFsc0RhdGUoZGF0ZSwgdGhpcy5zZWxlY3RlZERhdGUpKSB7XG4gICAgICByZXR1cm4gJ3RoZi1jYWxlbmRhci1ib3gtZm9yZWdyb3VuZC1zZWxlY3RlZCc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmVxdWFsc0RhdGUoZGF0ZSwgdGhpcy50b2RheSkpIHtcbiAgICAgIHJldHVybiAndGhmLWNhbGVuZGFyLWJveC1mb3JlZ3JvdW5kLXRvZGF5JztcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHZhbGlkYXRlRGF0ZVJhbmdlKGRhdGUsIHRoaXMuZGF0ZVN0YXJ0LCB0aGlzLmRhdGVFbmQpKSB7XG4gICAgICAgIHJldHVybiAndGhmLWNhbGVuZGFyLWJveC1mb3JlZ3JvdW5kJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAndGhmLWNhbGVuZGFyLWJveC1mb3JlZ3JvdW5kLWRpc2FibGVkJztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRGb3JlZ3JvdW5kQ29sb3IoZGlzcGxheVZhbHVlOiBudW1iZXIsIHByb3BlcnR5VmFsdWU6IG51bWJlcikge1xuICAgIHJldHVybiAoZGlzcGxheVZhbHVlID09PSBwcm9wZXJ0eVZhbHVlKSA/ICd0aGYtY2FsZW5kYXItYm94LWZvcmVncm91bmQtc2VsZWN0ZWQnIDogJ3RoZi1jYWxlbmRhci1ib3gtZm9yZWdyb3VuZCc7XG4gIH1cblxuICBnZXRXb3JkTW9udGgoKSB7XG4gICAgcmV0dXJuIHRoaXMudGhmQ2FsZW5kYXJMYW5nU2VydmljZS5nZXRXb3JkTW9udGgoKTtcbiAgfVxuXG4gIGdldFdvcmRZZWFyKCkge1xuICAgIHJldHVybiB0aGlzLnRoZkNhbGVuZGFyTGFuZ1NlcnZpY2UuZ2V0V29yZFllYXIoKTtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5zZWxlY3RlZERhdGUgPyB0aGlzLnVwZGF0ZURhdGUodGhpcy5zZWxlY3RlZERhdGUpIDogdGhpcy51cGRhdGVEYXRlKHRoaXMudG9kYXkpO1xuXG4gICAgdGhpcy5pbml0aWFsaXplTGFuZ3VhZ2UoKTtcblxuICAgIHRoaXMuc2VsZWN0RGF5KCk7XG5cbiAgICBpZiAodGhpcy5pc01vYmlsZSgpKSB7XG4gICAgICB0aGlzLm92ZXJsYXlJbnZpc2libGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuICB9XG5cbiAgaW5pdGlhbGl6ZUxhbmd1YWdlKCkge1xuICAgIHRoaXMudGhmQ2FsZW5kYXJMYW5nU2VydmljZS5zZXRMYW5ndWFnZSh0aGlzLmxvY2FsZSk7XG4gICAgdGhpcy5kaXNwbGF5V2VlZERheXMgPSB0aGlzLnRoZkNhbGVuZGFyTGFuZ1NlcnZpY2UuZ2V0QXJyYXlXZWVrRGF5cygpO1xuICAgIHRoaXMuZGlzcGxheU1vbnRocyA9IHRoaXMudGhmQ2FsZW5kYXJMYW5nU2VydmljZS5nZXRBcnJheU1vbnRocygpO1xuICB9XG5cbiAgb25OZXh0TW9udGgoKSB7XG4gICAgaWYgKHRoaXMuZGlzcGxheU1vbnRoTnVtYmVyIDwgMTEpIHtcbiAgICAgIHRoaXMudXBkYXRlRGlzcGxheSh0aGlzLmRpc3BsYXlZZWFyLCB0aGlzLmRpc3BsYXlNb250aE51bWJlciArIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVwZGF0ZURpc3BsYXkodGhpcy5kaXNwbGF5WWVhciArIDEsIDApO1xuICAgIH1cbiAgfVxuXG4gIG9uUHJldk1vbnRoKCkge1xuICAgIGlmICh0aGlzLmRpc3BsYXlNb250aE51bWJlciA+IDApIHtcbiAgICAgIHRoaXMudXBkYXRlRGlzcGxheSh0aGlzLmRpc3BsYXlZZWFyLCB0aGlzLmRpc3BsYXlNb250aE51bWJlciAtIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVwZGF0ZURpc3BsYXkodGhpcy5kaXNwbGF5WWVhciAtIDEsIDExKTtcbiAgICB9XG4gIH1cblxuICAvLyBBbyBzZWxlY2lvbmFyIHVtYSBkYXRhXG4gIG9uU2VsZWN0RGF0ZShkYXRlOiBEYXRlKSB7XG4gICAgaWYgKHZhbGlkYXRlRGF0ZVJhbmdlKGRhdGUsIHRoaXMuZGF0ZVN0YXJ0LCB0aGlzLmRhdGVFbmQpKSB7XG4gICAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IGRhdGU7XG4gICAgICB0aGlzLnNlbGVjdGVkRGF0ZUNoYW5nZS5lbWl0KGRhdGUpO1xuICAgICAgdGhpcy5zdWJtaXQuZW1pdChkYXRlKTtcbiAgICB9XG4gIH1cblxuICAvLyBBbyBzZWxlY2lvbmFyIHVtIG3DqnNcbiAgb25TZWxlY3RNb250aCh5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXIpIHtcbiAgICB0aGlzLnNlbGVjdERheSgpO1xuICAgIHRoaXMudXBkYXRlRGlzcGxheSh5ZWFyLCBtb250aCk7XG4gIH1cblxuICAvLyBBbyBzZWxlY2lvbmFyIHVtIGFub1xuICBvblNlbGVjdFllYXIoeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyKSB7XG4gICAgLy8gU2UgdmVpbyBkYSB0ZWxhIGRlIHNlbGXDp8OjbyBkZSBtw6pzXG4gICAgdGhpcy5sYXN0RGlzcGxheSA9PT0gJ21vbnRoJyA/IHRoaXMuc2VsZWN0TW9udGgoKSA6IHRoaXMuc2VsZWN0RGF5KCk7XG5cbiAgICB0aGlzLmN1cnJlbnRZZWFyID0geWVhcjtcbiAgICB0aGlzLnVwZGF0ZURpc3BsYXkoeWVhciwgbW9udGgpO1xuICB9XG5cbiAgc2VsZWN0RGF5KCkge1xuICAgIHRoaXMuZGF5VmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy5tb250aFZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLnllYXJWaXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5sYXN0RGlzcGxheSA9ICdkYXknO1xuICB9XG5cbiAgc2VsZWN0TW9udGgoKSB7XG4gICAgdGhpcy5kYXlWaXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5tb250aFZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMueWVhclZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmxhc3REaXNwbGF5ID0gJ21vbnRoJztcbiAgfVxuXG4gIHNlbGVjdFllYXIoKSB7XG4gICAgdGhpcy5kYXlWaXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5tb250aFZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLnllYXJWaXNpYmxlID0gdHJ1ZTtcbiAgfVxuXG4gIHNldE1vYmlsZVZpc3VhbGl6YXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNNb2JpbGUoKSA/ICd0aGYtY2FsZW5kYXIgdGhmLWNhbGVuZGFyLW1vYmlsZScgOiAndGhmLWNhbGVuZGFyJztcbiAgfVxuXG4gIHVwZGF0ZVllYXIodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMudXBkYXRlRGlzcGxheSh0aGlzLmRpc3BsYXlZZWFyICsgdmFsdWUsIHRoaXMuZGlzcGxheU1vbnRoTnVtYmVyKTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkQWxsWWVhcnNJbkRlY2FkZSh5ZWFyOiBudW1iZXIpIHtcbiAgICBsZXQgaTtcbiAgICBmb3IgKGkgPSB5ZWFyOyBpIDwgeWVhciArIDEwOyBpKyspIHtcbiAgICAgIHRoaXMuZGlzcGxheURlY2FkZS5wdXNoKGkpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZXF1YWxzRGF0ZShkYXRlMTogRGF0ZSwgZGF0ZTI6IERhdGUpOiBib29sZWFuIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGRhdGUxLmdldEZ1bGxZZWFyKCkgPT09IGRhdGUyLmdldEZ1bGxZZWFyKCkgJiZcbiAgICAgICAgZGF0ZTEuZ2V0TW9udGgoKSA9PT0gZGF0ZTIuZ2V0TW9udGgoKSAmJlxuICAgICAgICBkYXRlMS5nZXREYXRlKCkgPT09IGRhdGUyLmdldERhdGUoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlRGF0ZShkYXRlOiBEYXRlKSB7XG4gICAgdGhpcy5jdXJyZW50TW9udGhOdW1iZXIgPSBkYXRlLmdldE1vbnRoKCk7XG4gICAgdGhpcy5jdXJyZW50WWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICB0aGlzLnVwZGF0ZURpc3BsYXkodGhpcy5jdXJyZW50WWVhciwgdGhpcy5jdXJyZW50TW9udGhOdW1iZXIpO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVEZWNhZGUoeWVhcjogbnVtYmVyKSB7XG4gICAgdGhpcy5hZGRBbGxZZWFyc0luRGVjYWRlKHllYXIpO1xuICAgIHRoaXMuZGlzcGxheVN0YXJ0RGVjYWRlID0geWVhcjtcbiAgICB0aGlzLmRpc3BsYXlGaW5hbERlY2FkZSA9IHllYXIgKyA5O1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVEaXNwbGF5KHllYXI6IG51bWJlciwgbW9udGg6IG51bWJlcikge1xuICAgIGNvbnN0IGNhbGVuZGFyQXJyYXkgPSB0aGlzLnRoZkNhbGVuZGFyU2VydmljZS5tb250aERheXMoeWVhciwgbW9udGgpO1xuICAgIHRoaXMuZGlzcGxheURheXMgPSBbXS5jb25jYXQuYXBwbHkoW10sIGNhbGVuZGFyQXJyYXkpO1xuICAgIHRoaXMuZGlzcGxheU1vbnRoTnVtYmVyID0gbW9udGg7XG4gICAgdGhpcy5kaXNwbGF5TW9udGggPSB0aGlzLmRpc3BsYXlNb250aHNbbW9udGhdO1xuICAgIHRoaXMuZGlzcGxheVllYXIgPSB5ZWFyO1xuICAgIHRoaXMuZ2V0QXJyYXlEZWNhZGUoeWVhcik7XG4gIH1cblxufVxuIl19