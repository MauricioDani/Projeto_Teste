/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ElementRef, Injectable } from '@angular/core';
/**
 * \@docsPrivate
 * \@description
 *
 * Serviço responsável por gerenciar as posições de um elemento em relação a um elemento alvo. Ele pode receber as
 * seguintes posições:
 *
 * - `right`: Posiciona o elemento no lado direito do componente alvo.
 * - `right-bottom`: Posiciona o elemento no lado direito inferior do componente alvo.
 * - `right-top`: Posiciona o elemento no lado direito superior do componente alvo.
 * - `bottom`: Posiciona o elemento abaixo do componente alvo.
 * - `bottom-left`: Posiciona o elemento abaixo e à esquerda do componente alvo.
 * - `bottom-right`: Posiciona o elemento abaixo e à direita do componente alvo.
 * - `left`: Posiciona o elemento no lado esquerdo do componente alvo.
 * - `left-top`: Posiciona o elemento no lado esquerdo superior do componente alvo.
 * - `left-bottom`: Posiciona o elemento no lado esquerdo inferior do componente alvo.
 * - `top`: Posiciona o elemento acima do componente alvo.
 * - `top-right`: Posiciona o elemento acima e à direita do componente alvo.
 * - `top-left`: Posiciona o elemento acima e à esquerda do componente alvo.
 *
 * Caso o elemento não caiba na tela na posição indicada ele será rotacionado automaticamente para se adequar,
 * inicialmente no lado definido como padrão e em seguida seguindo o sentido horário.
 * @type {?}
 */
var thfControlPositionSidesDefault = [
    'bottom', 'bottom-left', 'bottom-right',
    'left', 'left-top', 'left-bottom',
    'top', 'top-right', 'top-left',
    'right', 'right-bottom', 'right-top'
];
var ThfControlPositionService = /** @class */ (function () {
    function ThfControlPositionService() {
        this.differenceDiagonalToWidthArrow = 3;
        this.isSetElementWidth = false;
        // offset da seta em relação ao canto do componente
        this.offsetArrow = 12;
    }
    /**
     * @description Ajusta a posição do elemento, caso não couber em tela irá para próxima posição.
     *
     * @param value posição para exibição do elemento
     */
    /**
     * \@description Ajusta a posição do elemento, caso não couber em tela irá para próxima posição.
     *
     * @param {?} value posição para exibição do elemento
     * @return {?}
     */
    ThfControlPositionService.prototype.adjustPosition = /**
     * \@description Ajusta a posição do elemento, caso não couber em tela irá para próxima posição.
     *
     * @param {?} value posição para exibição do elemento
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var position = value || 'bottom';
        this.elementPosition(position);
        this.customPositions && this.customPositions.length ? this.adjustCustomPosition(position) : this.adjustDefaultPosition(position);
    };
    /**
     * @description Retorna a direção da seta, conforme a posição do elemento.
     */
    /**
     * \@description Retorna a direção da seta, conforme a posição do elemento.
     * @return {?}
     */
    ThfControlPositionService.prototype.getArrowDirection = /**
     * \@description Retorna a direção da seta, conforme a posição do elemento.
     * @return {?}
     */
    function () {
        return this.arrowDirection;
    };
    /**
     * @description Método responsável por definir as propriedades utilizadas para exibir o elemento na posição correta.
     *
     * @param element elemento que será exibido
     * @param elementOffset offSet do elemento
     * @param targetElement elemento de onde deve partir a exibição
     * @param customPositions posições que sobrescreve as posições padrões
     * @param isSetElementWidth indica se deve definir o tamanho do elemento a ser exibido, caso for verdadeiro será igual do targetElement
     * @param isCornerAligned indica se o elemento filho será alinhado nos cantos do elemneto pai.
     */
    /**
     * \@description Método responsável por definir as propriedades utilizadas para exibir o elemento na posição correta.
     *
     * @param {?} element elemento que será exibido
     * @param {?} elementOffset offSet do elemento
     * @param {?} targetElement elemento de onde deve partir a exibição
     * @param {?=} customPositions posições que sobrescreve as posições padrões
     * @param {?=} isSetElementWidth indica se deve definir o tamanho do elemento a ser exibido, caso for verdadeiro será igual do targetElement
     * @param {?=} isCornerAligned indica se o elemento filho será alinhado nos cantos do elemneto pai.
     * @return {?}
     */
    ThfControlPositionService.prototype.setElements = /**
     * \@description Método responsável por definir as propriedades utilizadas para exibir o elemento na posição correta.
     *
     * @param {?} element elemento que será exibido
     * @param {?} elementOffset offSet do elemento
     * @param {?} targetElement elemento de onde deve partir a exibição
     * @param {?=} customPositions posições que sobrescreve as posições padrões
     * @param {?=} isSetElementWidth indica se deve definir o tamanho do elemento a ser exibido, caso for verdadeiro será igual do targetElement
     * @param {?=} isCornerAligned indica se o elemento filho será alinhado nos cantos do elemneto pai.
     * @return {?}
     */
    function (element, elementOffset, targetElement, customPositions, isSetElementWidth, isCornerAligned) {
        if (isSetElementWidth === void 0) { isSetElementWidth = false; }
        if (isCornerAligned === void 0) { isCornerAligned = false; }
        this.element = (element instanceof ElementRef) ? element.nativeElement : element;
        this.targetElement = (targetElement instanceof ElementRef) ? targetElement.nativeElement : targetElement;
        this.elementOffset = elementOffset;
        this.customPositions = customPositions;
        this.isSetElementWidth = isSetElementWidth;
        this.isCornerAligned = isCornerAligned;
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.adjustCustomPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var positionLength = this.customPositions.length;
        /** @type {?} */
        var sidesCount = 0;
        while (sidesCount++ < positionLength) {
            if (this.overflowAllSides(position)) {
                position = this.nextPosition(position, this.customPositions);
                this.elementPosition(position);
            }
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.adjustDefaultPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var mainPositions = this.getMainPositions();
        /** @type {?} */
        var mainPositionLength = mainPositions.length;
        /** @type {?} */
        var mainSidesCount = 0;
        while (mainSidesCount++ < mainPositionLength) {
            /** @type {?} */
            var mainPosition = this.getMainPosition(position);
            this.elementPosition(position);
            if (this.overflowMain(mainPosition)) {
                position = this.nextPosition(mainPosition, mainPositions);
                continue;
            }
            else if (this.overflowAllSides(position)) {
                this.verifySubPositions(position);
                return;
            }
            return;
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.elementPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        this.isCornerAligned ? this.setAlignedElementPosition(position) : this.setElementPosition(position);
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.getMainPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        return (position.indexOf('-') > -1) ? position.substring(0, position.indexOf('-')) : position;
    };
    /**
     * @private
     * @return {?}
     */
    ThfControlPositionService.prototype.getMainPositions = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var defaultMainPositions = ['top', 'right', 'bottom', 'left'];
        return this.customPositions && this.customPositions.length ?
            this.getMainPositionsByCustomPositions(this.customPositions) : defaultMainPositions;
    };
    /**
     * @private
     * @param {?} customPositions
     * @return {?}
     */
    ThfControlPositionService.prototype.getMainPositionsByCustomPositions = /**
     * @private
     * @param {?} customPositions
     * @return {?}
     */
    function (customPositions) {
        /** @type {?} */
        var mainPositions = [];
        /** @type {?} */
        var customPositionsLength = customPositions.length;
        for (var i = 0; i < customPositionsLength; i++) {
            /** @type {?} */
            var position = customPositions[i];
            /** @type {?} */
            var mainPosition = this.getMainPosition(position);
            if (!mainPositions.includes(mainPosition)) {
                mainPositions.push(mainPosition);
            }
        }
        return mainPositions;
    };
    /**
     * @private
     * @return {?}
     */
    ThfControlPositionService.prototype.getOverflows = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var sizesAndPositions = this.getSizesAndPositions();
        return {
            right: (sizesAndPositions.element.right > sizesAndPositions.window.innerWidth),
            top: (sizesAndPositions.element.top <= 0),
            left: (sizesAndPositions.element.left <= 0),
            bottom: (sizesAndPositions.element.bottom > sizesAndPositions.window.innerHeight)
        };
    };
    /**
     * @private
     * @return {?}
     */
    ThfControlPositionService.prototype.getSizesAndPositions = /**
     * @private
     * @return {?}
     */
    function () {
        return {
            window: {
                scrollY: window.scrollY,
                scrollX: window.scrollX,
                innerWidth: window.innerWidth,
                innerHeight: window.innerHeight
            },
            element: this.element.getBoundingClientRect(),
            target: this.targetElement ? this.targetElement.getBoundingClientRect() : { top: 0, bottom: 0, right: 0, left: 0 }
        };
    };
    /**
     * @private
     * @param {?} position
     * @param {?=} positions
     * @return {?}
     */
    ThfControlPositionService.prototype.nextPosition = /**
     * @private
     * @param {?} position
     * @param {?=} positions
     * @return {?}
     */
    function (position, positions) {
        if (positions === void 0) { positions = []; }
        /** @type {?} */
        var index = positions.indexOf(position);
        /** @type {?} */
        var nextIndex = index + 1;
        if (index > -1 && nextIndex < positions.length) {
            return positions[nextIndex];
        }
        else {
            return positions[0];
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.overflowAllSides = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var overflows = this.getOverflows();
        switch (position) {
            case 'top': return overflows.top || overflows.right || overflows.left;
            case 'top-right': return overflows.top || overflows.right;
            case 'top-left': return overflows.top || overflows.left;
            case 'right': return overflows.right || overflows.top || overflows.bottom;
            case 'right-top': return overflows.right || overflows.top;
            case 'right-bottom': return overflows.right || overflows.bottom;
            case 'bottom': return overflows.bottom || overflows.right || overflows.left;
            case 'bottom-right': return overflows.bottom || overflows.right;
            case 'bottom-left': return overflows.bottom || overflows.left;
            case 'left': return overflows.left || overflows.top || overflows.bottom;
            case 'left-top': return overflows.left || overflows.top;
            case 'left-bottom': return overflows.left || overflows.bottom;
        }
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.overflowMain = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        /** @type {?} */
        var overflows = this.getOverflows();
        switch (position) {
            case 'top': return overflows.top;
            case 'right': return overflows.right;
            case 'bottom': return overflows.bottom;
            case 'left': return overflows.left;
        }
    };
    /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    ThfControlPositionService.prototype.setAlignedArrowDirection = /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    function (elementPosition) {
        switch (elementPosition) {
            case 'top-left': return 'bottom-left';
            case 'top-right': return 'bottom-right';
            case 'bottom-right': return 'top-right';
            case 'bottom-left': return 'top-left';
        }
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    ThfControlPositionService.prototype.setAlignedBottomPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.bottom + this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left - displacement + 'px';
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.setAlignedElementPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        this.setElementWidth();
        /** @type {?} */
        var sizesAndPositions = this.getSizesAndPositions();
        switch (position) {
            case 'bottom-left':
                this.setAlignedBottomPositions(0, sizesAndPositions);
                break;
            case 'bottom-right':
                this.setAlignedBottomPositions(sizesAndPositions.element.width - sizesAndPositions.target.width, sizesAndPositions);
                break;
            case 'top-left':
                this.setAlignedTopPositions(0, sizesAndPositions);
                break;
            case 'top-right':
                this.setAlignedTopPositions(sizesAndPositions.element.width - sizesAndPositions.target.width, sizesAndPositions);
                break;
        }
        this.arrowDirection = this.setAlignedArrowDirection(position);
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    ThfControlPositionService.prototype.setAlignedTopPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - sizesAndPositions.element.height - this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left - displacement + 'px';
    };
    /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    ThfControlPositionService.prototype.setArrowDirection = /**
     * @private
     * @param {?} elementPosition
     * @return {?}
     */
    function (elementPosition) {
        switch (elementPosition) {
            case 'top': return 'bottom';
            case 'top-left': return 'bottom-right';
            case 'top-right': return 'bottom-left';
            case 'right': return 'left';
            case 'right-top': return 'left-bottom';
            case 'right-bottom': return 'left-top';
            case 'bottom': return 'top';
            case 'bottom-right': return 'top-left';
            case 'bottom-left': return 'top-right';
            case 'left': return 'right';
            case 'left-bottom': return 'right-top';
            case 'left-top': return 'right-bottom';
        }
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    ThfControlPositionService.prototype.setBottomPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.bottom + this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left + (sizesAndPositions.target.width / 2) - displacement + 'px';
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.setElementPosition = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        this.setElementWidth();
        /** @type {?} */
        var sizesAndPositions = this.getSizesAndPositions();
        switch (position) {
            case 'top':
                this.setTopPositions((sizesAndPositions.element.width / 2), sizesAndPositions);
                break;
            case 'top-left':
                this.setTopPositions((sizesAndPositions.element.width - this.offsetArrow - this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'top-right':
                this.setTopPositions((this.offsetArrow + this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'right':
                this.setRightPositions((sizesAndPositions.element.height / 2), sizesAndPositions);
                break;
            case 'right-top':
                this.setRightPositions((sizesAndPositions.element.height - this.offsetArrow - this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'right-bottom':
                this.setRightPositions(this.offsetArrow, sizesAndPositions);
                break;
            case 'bottom':
                this.setBottomPositions((sizesAndPositions.element.width / 2), sizesAndPositions);
                break;
            case 'bottom-right':
                this.setBottomPositions((this.offsetArrow + this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'bottom-left':
                this.setBottomPositions((sizesAndPositions.element.width - this.offsetArrow - this.differenceDiagonalToWidthArrow), sizesAndPositions);
                break;
            case 'left':
                this.setLeftPositions((sizesAndPositions.element.height / 2), sizesAndPositions);
                break;
            case 'left-bottom':
                this.setLeftPositions(this.offsetArrow, sizesAndPositions);
                break;
            case 'left-top':
                this.setLeftPositions((sizesAndPositions.element.height - this.offsetArrow), sizesAndPositions);
                break;
        }
        this.arrowDirection = this.setArrowDirection(position);
    };
    /**
     * @private
     * @return {?}
     */
    ThfControlPositionService.prototype.setElementWidth = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.isSetElementWidth && this.targetElement) {
            this.element.style.width = this.targetElement.clientWidth + "px";
        }
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    ThfControlPositionService.prototype.setLeftPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - displacement + (sizesAndPositions.target.height / 2) + 'px';
        this.element.style.left = sizesAndPositions.target.left - sizesAndPositions.element.width - this.elementOffset + 'px';
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    ThfControlPositionService.prototype.setRightPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - displacement + (sizesAndPositions.target.height / 2) + 'px';
        this.element.style.left = sizesAndPositions.target.right + this.elementOffset + 'px';
    };
    /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    ThfControlPositionService.prototype.setTopPositions = /**
     * @private
     * @param {?} displacement
     * @param {?} sizesAndPositions
     * @return {?}
     */
    function (displacement, sizesAndPositions) {
        this.element.style.top = sizesAndPositions.target.top - sizesAndPositions.element.height - this.elementOffset + 'px';
        this.element.style.left = sizesAndPositions.target.left + (sizesAndPositions.target.width / 2) - displacement + 'px';
    };
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    ThfControlPositionService.prototype.verifySubPositions = /**
     * @private
     * @param {?} position
     * @return {?}
     */
    function (position) {
        if (position.indexOf('-') > -1) {
            position = position.substring(0, position.indexOf('-'));
            this.elementPosition(position);
        }
        /** @type {?} */
        var align = 0;
        while (align++ < 3) {
            if (this.overflowAllSides(position)) {
                position = this.nextPosition(position, thfControlPositionSidesDefault);
                this.elementPosition(position);
            }
            else {
                return null;
            }
        }
    };
    ThfControlPositionService.decorators = [
        { type: Injectable }
    ];
    return ThfControlPositionService;
}());
export { ThfControlPositionService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.arrowDirection;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.customPositions;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.differenceDiagonalToWidthArrow;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.element;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.elementOffset;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.isCornerAligned;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.isSetElementWidth;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.offsetArrow;
    /**
     * @type {?}
     * @private
     */
    ThfControlPositionService.prototype.targetElement;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhmLWNvbnRyb2wtcG9zaXRpb24uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0b3R2cy90aGYtdWkvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvdGhmLWNvbnRyb2wtcG9zaXRpb24vdGhmLWNvbnRyb2wtcG9zaXRpb24uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUEwQmpELDhCQUE4QixHQUFrQjtJQUNwRCxRQUFRLEVBQUUsYUFBYSxFQUFFLGNBQWM7SUFDdkMsTUFBTSxFQUFFLFVBQVUsRUFBRSxhQUFhO0lBQ2pDLEtBQUssRUFBRSxXQUFXLEVBQUUsVUFBVTtJQUM5QixPQUFPLEVBQUUsY0FBYyxFQUFFLFdBQVc7Q0FDckM7QUFFRDtJQUFBO1FBS1UsbUNBQThCLEdBQVcsQ0FBQyxDQUFDO1FBSTNDLHNCQUFpQixHQUFZLEtBQUssQ0FBQzs7UUFFbkMsZ0JBQVcsR0FBVyxFQUFFLENBQUM7SUEwVW5DLENBQUM7SUF2VUM7Ozs7T0FJRzs7Ozs7OztJQUNILGtEQUFjOzs7Ozs7SUFBZCxVQUFlLEtBQWE7O1lBQ3BCLFFBQVEsR0FBRyxLQUFLLElBQUksUUFBUTtRQUNsQyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQy9CLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ25JLENBQUM7SUFFRDs7T0FFRzs7Ozs7SUFDSCxxREFBaUI7Ozs7SUFBakI7UUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDN0IsQ0FBQztJQUVEOzs7Ozs7Ozs7T0FTRzs7Ozs7Ozs7Ozs7O0lBQ0gsK0NBQVc7Ozs7Ozs7Ozs7O0lBQVgsVUFBWSxPQUFpQyxFQUFFLGFBQXFCLEVBQUUsYUFBdUMsRUFDakcsZUFBK0IsRUFBRSxpQkFBa0MsRUFBRSxlQUFnQztRQUFwRSxrQ0FBQSxFQUFBLHlCQUFrQztRQUFFLGdDQUFBLEVBQUEsdUJBQWdDO1FBRS9HLElBQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQyxPQUFPLFlBQVksVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztRQUNqRixJQUFJLENBQUMsYUFBYSxHQUFHLENBQUMsYUFBYSxZQUFZLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUM7UUFFekcsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7UUFFbkMsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7UUFDdkMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLGlCQUFpQixDQUFDO1FBQzNDLElBQUksQ0FBQyxlQUFlLEdBQUcsZUFBZSxDQUFDO0lBQ3pDLENBQUM7Ozs7OztJQUVPLHdEQUFvQjs7Ozs7SUFBNUIsVUFBNkIsUUFBZ0I7O1lBQ3JDLGNBQWMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU07O1lBRTlDLFVBQVUsR0FBRyxDQUFDO1FBRWxCLE9BQU8sVUFBVSxFQUFFLEdBQUcsY0FBYyxFQUFFO1lBQ3BDLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUNuQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO2dCQUM3RCxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQ2hDO1NBQ0Y7SUFDSCxDQUFDOzs7Ozs7SUFFTyx5REFBcUI7Ozs7O0lBQTdCLFVBQThCLFFBQWdCOztZQUN0QyxhQUFhLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixFQUFFOztZQUN2QyxrQkFBa0IsR0FBRyxhQUFhLENBQUMsTUFBTTs7WUFFM0MsY0FBYyxHQUFHLENBQUM7UUFFdEIsT0FBTyxjQUFjLEVBQUUsR0FBRyxrQkFBa0IsRUFBRTs7Z0JBQ3RDLFlBQVksR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQztZQUNuRCxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRS9CLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsRUFBRTtnQkFDbkMsUUFBUSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsWUFBWSxFQUFFLGFBQWEsQ0FBQyxDQUFDO2dCQUMxRCxTQUFTO2FBQ1Y7aUJBQU0sSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLEVBQUU7Z0JBQzFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDbEMsT0FBTzthQUNSO1lBRUQsT0FBTztTQUNSO0lBQ0gsQ0FBQzs7Ozs7O0lBRU8sbURBQWU7Ozs7O0lBQXZCLFVBQXdCLFFBQWdCO1FBQ3RDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3RHLENBQUM7Ozs7OztJQUVPLG1EQUFlOzs7OztJQUF2QixVQUF3QixRQUFnQjtRQUN0QyxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztJQUNoRyxDQUFDOzs7OztJQUVPLG9EQUFnQjs7OztJQUF4Qjs7WUFDUSxvQkFBb0IsR0FBRyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQztRQUUvRCxPQUFPLElBQUksQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUMxRCxJQUFJLENBQUMsaUNBQWlDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztJQUN4RixDQUFDOzs7Ozs7SUFFTyxxRUFBaUM7Ozs7O0lBQXpDLFVBQTBDLGVBQThCOztZQUNoRSxhQUFhLEdBQUcsRUFBRTs7WUFDbEIscUJBQXFCLEdBQUcsZUFBZSxDQUFDLE1BQU07UUFFcEQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLHFCQUFxQixFQUFFLENBQUMsRUFBRSxFQUFFOztnQkFDeEMsUUFBUSxHQUFHLGVBQWUsQ0FBQyxDQUFDLENBQUM7O2dCQUU3QixZQUFZLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUM7WUFFbkQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLEVBQUU7Z0JBQ3pDLGFBQWEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7YUFDbEM7U0FDRjtRQUVELE9BQU8sYUFBYSxDQUFDO0lBQ3ZCLENBQUM7Ozs7O0lBRU8sZ0RBQVk7Ozs7SUFBcEI7O1lBQ1EsaUJBQWlCLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixFQUFFO1FBRXJELE9BQU87WUFDTCxLQUFLLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsS0FBSyxHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUM7WUFDOUUsR0FBRyxFQUFFLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7WUFDekMsSUFBSSxFQUFFLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUM7WUFDM0MsTUFBTSxFQUFFLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDO1NBQ2xGLENBQUM7SUFDSixDQUFDOzs7OztJQUVPLHdEQUFvQjs7OztJQUE1QjtRQUNFLE9BQU87WUFDTCxNQUFNLEVBQUU7Z0JBQ04sT0FBTyxFQUFFLE1BQU0sQ0FBQyxPQUFPO2dCQUN2QixPQUFPLEVBQUUsTUFBTSxDQUFDLE9BQU87Z0JBQ3ZCLFVBQVUsRUFBRSxNQUFNLENBQUMsVUFBVTtnQkFDN0IsV0FBVyxFQUFFLE1BQU0sQ0FBQyxXQUFXO2FBQ2hDO1lBQ0QsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMscUJBQXFCLEVBQUU7WUFDN0MsTUFBTSxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFO1NBQ25ILENBQUM7SUFDSixDQUFDOzs7Ozs7O0lBRU8sZ0RBQVk7Ozs7OztJQUFwQixVQUFxQixRQUFnQixFQUFFLFNBQTZCO1FBQTdCLDBCQUFBLEVBQUEsY0FBNkI7O1lBQzVELEtBQUssR0FBRyxTQUFTLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQzs7WUFDbkMsU0FBUyxHQUFHLEtBQUssR0FBRyxDQUFDO1FBRTNCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxJQUFJLFNBQVMsR0FBRyxTQUFTLENBQUMsTUFBTSxFQUFFO1lBRTlDLE9BQU8sU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQzdCO2FBQU07WUFDTCxPQUFPLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNyQjtJQUVILENBQUM7Ozs7OztJQUVPLG9EQUFnQjs7Ozs7SUFBeEIsVUFBeUIsUUFBZ0I7O1lBQ2pDLFNBQVMsR0FBRyxJQUFJLENBQUMsWUFBWSxFQUFFO1FBRXJDLFFBQVEsUUFBUSxFQUFFO1lBQ2hCLEtBQUssS0FBSyxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsR0FBRyxJQUFJLFNBQVMsQ0FBQyxLQUFLLElBQUksU0FBUyxDQUFDLElBQUksQ0FBQztZQUN0RSxLQUFLLFdBQVcsQ0FBQyxDQUFDLE9BQU8sU0FBUyxDQUFDLEdBQUcsSUFBSSxTQUFTLENBQUMsS0FBSyxDQUFDO1lBQzFELEtBQUssVUFBVSxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsR0FBRyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUM7WUFDeEQsS0FBSyxPQUFPLENBQUMsQ0FBQyxPQUFPLFNBQVMsQ0FBQyxLQUFLLElBQUksU0FBUyxDQUFDLEdBQUcsSUFBSSxTQUFTLENBQUMsTUFBTSxDQUFDO1lBQzFFLEtBQUssV0FBVyxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsS0FBSyxJQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUM7WUFDMUQsS0FBSyxjQUFjLENBQUMsQ0FBQyxPQUFPLFNBQVMsQ0FBQyxLQUFLLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQztZQUNoRSxLQUFLLFFBQVEsQ0FBQyxDQUFDLE9BQU8sU0FBUyxDQUFDLE1BQU0sSUFBSSxTQUFTLENBQUMsS0FBSyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUM7WUFDNUUsS0FBSyxjQUFjLENBQUMsQ0FBQyxPQUFPLFNBQVMsQ0FBQyxNQUFNLElBQUksU0FBUyxDQUFDLEtBQUssQ0FBQztZQUNoRSxLQUFLLGFBQWEsQ0FBQyxDQUFDLE9BQU8sU0FBUyxDQUFDLE1BQU0sSUFBSSxTQUFTLENBQUMsSUFBSSxDQUFDO1lBQzlELEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsSUFBSSxJQUFJLFNBQVMsQ0FBQyxHQUFHLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQztZQUN4RSxLQUFLLFVBQVUsQ0FBQyxDQUFDLE9BQU8sU0FBUyxDQUFDLElBQUksSUFBSSxTQUFTLENBQUMsR0FBRyxDQUFDO1lBQ3hELEtBQUssYUFBYSxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsSUFBSSxJQUFJLFNBQVMsQ0FBQyxNQUFNLENBQUM7U0FDL0Q7SUFDSCxDQUFDOzs7Ozs7SUFFTyxnREFBWTs7Ozs7SUFBcEIsVUFBcUIsUUFBZ0I7O1lBQzdCLFNBQVMsR0FBRyxJQUFJLENBQUMsWUFBWSxFQUFFO1FBRXJDLFFBQVEsUUFBUSxFQUFFO1lBQ2hCLEtBQUssS0FBSyxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsR0FBRyxDQUFDO1lBQ2pDLEtBQUssT0FBTyxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsS0FBSyxDQUFDO1lBQ3JDLEtBQUssUUFBUSxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsTUFBTSxDQUFDO1lBQ3ZDLEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTyxTQUFTLENBQUMsSUFBSSxDQUFDO1NBQ3BDO0lBQ0gsQ0FBQzs7Ozs7O0lBRU8sNERBQXdCOzs7OztJQUFoQyxVQUFpQyxlQUF1QjtRQUN0RCxRQUFRLGVBQWUsRUFBRTtZQUN2QixLQUFLLFVBQVUsQ0FBQyxDQUFDLE9BQU8sYUFBYSxDQUFDO1lBQ3RDLEtBQUssV0FBVyxDQUFDLENBQUMsT0FBTyxjQUFjLENBQUM7WUFDeEMsS0FBSyxjQUFjLENBQUMsQ0FBQyxPQUFPLFdBQVcsQ0FBQztZQUN4QyxLQUFLLGFBQWEsQ0FBQyxDQUFDLE9BQU8sVUFBVSxDQUFDO1NBQ3ZDO0lBQ0gsQ0FBQzs7Ozs7OztJQUVPLDZEQUF5Qjs7Ozs7O0lBQWpDLFVBQWtDLFlBQW9CLEVBQUUsaUJBQWlCO1FBQ3ZFLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ3JGLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsSUFBSSxHQUFHLFlBQVksR0FBRyxJQUFJLENBQUM7SUFDaEYsQ0FBQzs7Ozs7O0lBRU8sNkRBQXlCOzs7OztJQUFqQyxVQUFrQyxRQUFnQjtRQUNoRCxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7O1lBRWpCLGlCQUFpQixHQUFRLElBQUksQ0FBQyxvQkFBb0IsRUFBRTtRQUUxRCxRQUFRLFFBQVEsRUFBRTtZQUNoQixLQUFLLGFBQWE7Z0JBQ2hCLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztnQkFDckQsTUFBTTtZQUNSLEtBQUssY0FBYztnQkFDakIsSUFBSSxDQUFDLHlCQUF5QixDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxLQUFLLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO2dCQUNwSCxNQUFNO1lBQ1IsS0FBSyxVQUFVO2dCQUNiLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztnQkFDbEQsTUFBTTtZQUNSLEtBQUssV0FBVztnQkFDZCxJQUFJLENBQUMsc0JBQXNCLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLGlCQUFpQixDQUFDLENBQUM7Z0JBQ2pILE1BQU07U0FDVDtRQUVELElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRWhFLENBQUM7Ozs7Ozs7SUFFTywwREFBc0I7Ozs7OztJQUE5QixVQUErQixZQUFvQixFQUFFLGlCQUFpQjtRQUNwRSxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ3JILElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsSUFBSSxHQUFHLFlBQVksR0FBRyxJQUFJLENBQUM7SUFDaEYsQ0FBQzs7Ozs7O0lBRU8scURBQWlCOzs7OztJQUF6QixVQUEwQixlQUF1QjtRQUMvQyxRQUFRLGVBQWUsRUFBRTtZQUN2QixLQUFLLEtBQUssQ0FBQyxDQUFDLE9BQU8sUUFBUSxDQUFDO1lBQzVCLEtBQUssVUFBVSxDQUFDLENBQUMsT0FBTyxjQUFjLENBQUM7WUFDdkMsS0FBSyxXQUFXLENBQUMsQ0FBQyxPQUFPLGFBQWEsQ0FBQztZQUN2QyxLQUFLLE9BQU8sQ0FBQyxDQUFDLE9BQU8sTUFBTSxDQUFDO1lBQzVCLEtBQUssV0FBVyxDQUFDLENBQUMsT0FBTyxhQUFhLENBQUM7WUFDdkMsS0FBSyxjQUFjLENBQUMsQ0FBQyxPQUFPLFVBQVUsQ0FBQztZQUN2QyxLQUFLLFFBQVEsQ0FBQyxDQUFDLE9BQU8sS0FBSyxDQUFDO1lBQzVCLEtBQUssY0FBYyxDQUFDLENBQUMsT0FBTyxVQUFVLENBQUM7WUFDdkMsS0FBSyxhQUFhLENBQUMsQ0FBQyxPQUFPLFdBQVcsQ0FBQztZQUN2QyxLQUFLLE1BQU0sQ0FBQyxDQUFDLE9BQU8sT0FBTyxDQUFDO1lBQzVCLEtBQUssYUFBYSxDQUFDLENBQUMsT0FBTyxXQUFXLENBQUM7WUFDdkMsS0FBSyxVQUFVLENBQUMsQ0FBQyxPQUFPLGNBQWMsQ0FBQztTQUN4QztJQUNILENBQUM7Ozs7Ozs7SUFFTyxzREFBa0I7Ozs7OztJQUExQixVQUEyQixZQUFvQixFQUFFLGlCQUFpQjtRQUNoRSxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztRQUNyRixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLElBQUksR0FBRyxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsWUFBWSxHQUFHLElBQUksQ0FBQztJQUN2SCxDQUFDOzs7Ozs7SUFFTyxzREFBa0I7Ozs7O0lBQTFCLFVBQTJCLFFBQWdCO1FBQ3pDLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQzs7WUFFakIsaUJBQWlCLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixFQUFFO1FBRXJELFFBQVEsUUFBUSxFQUFFO1lBQ2hCLEtBQUssS0FBSztnQkFDUixJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO2dCQUMvRSxNQUFNO1lBQ1IsS0FBSyxVQUFVO2dCQUNiLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLDhCQUE4QixDQUFDLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztnQkFDcEksTUFBTTtZQUNSLEtBQUssV0FBVztnQkFDZCxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsOEJBQThCLENBQUMsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO2dCQUNsRyxNQUFNO1lBQ1IsS0FBSyxPQUFPO2dCQUNWLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztnQkFDbEYsTUFBTTtZQUNSLEtBQUssV0FBVztnQkFDZCxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLDhCQUE4QixDQUFDLEVBQ2hILGlCQUFpQixDQUFDLENBQUM7Z0JBQ3JCLE1BQU07WUFDUixLQUFLLGNBQWM7Z0JBQ2pCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLGlCQUFpQixDQUFDLENBQUM7Z0JBQzVELE1BQU07WUFDUixLQUFLLFFBQVE7Z0JBQ1gsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO2dCQUNsRixNQUFNO1lBQ1IsS0FBSyxjQUFjO2dCQUNqQixJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxFQUFFLGlCQUFpQixDQUFDLENBQUM7Z0JBQ3JHLE1BQU07WUFDUixLQUFLLGFBQWE7Z0JBQ2hCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsOEJBQThCLENBQUMsRUFDaEgsaUJBQWlCLENBQUMsQ0FBQztnQkFDckIsTUFBTTtZQUNSLEtBQUssTUFBTTtnQkFDVCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLGlCQUFpQixDQUFDLENBQUM7Z0JBQ2pGLE1BQU07WUFDUixLQUFLLGFBQWE7Z0JBQ2hCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLGlCQUFpQixDQUFDLENBQUM7Z0JBQzNELE1BQU07WUFDUixLQUFLLFVBQVU7Z0JBQ2IsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztnQkFDaEcsTUFBTTtTQUNUO1FBRUQsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDekQsQ0FBQzs7Ozs7SUFFTyxtREFBZTs7OztJQUF2QjtRQUNFLElBQUksSUFBSSxDQUFDLGlCQUFpQixJQUFJLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDaEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxPQUFJLENBQUM7U0FDbEU7SUFDSCxDQUFDOzs7Ozs7O0lBRU8sb0RBQWdCOzs7Ozs7SUFBeEIsVUFBeUIsWUFBb0IsRUFBRSxpQkFBaUI7UUFDOUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsWUFBWSxHQUFHLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDcEgsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxJQUFJLEdBQUcsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztJQUN4SCxDQUFDOzs7Ozs7O0lBRU8scURBQWlCOzs7Ozs7SUFBekIsVUFBMEIsWUFBb0IsRUFBRSxpQkFBaUI7UUFDL0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsWUFBWSxHQUFHLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDcEgsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7SUFDdkYsQ0FBQzs7Ozs7OztJQUVPLG1EQUFlOzs7Ozs7SUFBdkIsVUFBd0IsWUFBb0IsRUFBRSxpQkFBaUI7UUFDN0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsaUJBQWlCLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztRQUNySCxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLElBQUksR0FBRyxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsWUFBWSxHQUFHLElBQUksQ0FBQztJQUN2SCxDQUFDOzs7Ozs7SUFFTyxzREFBa0I7Ozs7O0lBQTFCLFVBQTJCLFFBQWdCO1FBQ3pDLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtZQUM5QixRQUFRLEdBQUcsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ3hELElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDaEM7O1lBRUcsS0FBSyxHQUFHLENBQUM7UUFDYixPQUFPLEtBQUssRUFBRSxHQUFHLENBQUMsRUFBRTtZQUNsQixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsRUFBRTtnQkFDbkMsUUFBUSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLDhCQUE4QixDQUFDLENBQUM7Z0JBQ3ZFLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUM7YUFDaEM7aUJBQU07Z0JBQ0wsT0FBTyxJQUFJLENBQUM7YUFDYjtTQUNGO0lBQ0gsQ0FBQzs7Z0JBblZGLFVBQVU7O0lBcVZYLGdDQUFDO0NBQUEsQUFyVkQsSUFxVkM7U0FwVlkseUJBQXlCOzs7Ozs7SUFFcEMsbURBQStCOzs7OztJQUMvQixvREFBdUM7Ozs7O0lBQ3ZDLG1FQUFtRDs7Ozs7SUFDbkQsNENBQTZCOzs7OztJQUM3QixrREFBOEI7Ozs7O0lBQzlCLG9EQUFpQzs7Ozs7SUFDakMsc0RBQTJDOzs7OztJQUUzQyxnREFBaUM7Ozs7O0lBQ2pDLGtEQUFtQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVsZW1lbnRSZWYsIEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuIC8qKlxuICAqIEBkb2NzUHJpdmF0ZVxuICAqIEBkZXNjcmlwdGlvblxuICAqXG4gICogU2VydmnDp28gcmVzcG9uc8OhdmVsIHBvciBnZXJlbmNpYXIgYXMgcG9zacOnw7VlcyBkZSB1bSBlbGVtZW50byBlbSByZWxhw6fDo28gYSB1bSBlbGVtZW50byBhbHZvLiBFbGUgcG9kZSByZWNlYmVyIGFzXG4gICogc2VndWludGVzIHBvc2nDp8O1ZXM6XG4gICpcbiAgKiAtIGByaWdodGA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIG5vIGxhZG8gZGlyZWl0byBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgcmlnaHQtYm90dG9tYDogUG9zaWNpb25hIG8gZWxlbWVudG8gbm8gbGFkbyBkaXJlaXRvIGluZmVyaW9yIGRvIGNvbXBvbmVudGUgYWx2by5cbiAgKiAtIGByaWdodC10b3BgOiBQb3NpY2lvbmEgbyBlbGVtZW50byBubyBsYWRvIGRpcmVpdG8gc3VwZXJpb3IgZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYGJvdHRvbWA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIGFiYWl4byBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgYm90dG9tLWxlZnRgOiBQb3NpY2lvbmEgbyBlbGVtZW50byBhYmFpeG8gZSDDoCBlc3F1ZXJkYSBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgYm90dG9tLXJpZ2h0YDogUG9zaWNpb25hIG8gZWxlbWVudG8gYWJhaXhvIGUgw6AgZGlyZWl0YSBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgbGVmdGA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIG5vIGxhZG8gZXNxdWVyZG8gZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqIC0gYGxlZnQtdG9wYDogUG9zaWNpb25hIG8gZWxlbWVudG8gbm8gbGFkbyBlc3F1ZXJkbyBzdXBlcmlvciBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgbGVmdC1ib3R0b21gOiBQb3NpY2lvbmEgbyBlbGVtZW50byBubyBsYWRvIGVzcXVlcmRvIGluZmVyaW9yIGRvIGNvbXBvbmVudGUgYWx2by5cbiAgKiAtIGB0b3BgOiBQb3NpY2lvbmEgbyBlbGVtZW50byBhY2ltYSBkbyBjb21wb25lbnRlIGFsdm8uXG4gICogLSBgdG9wLXJpZ2h0YDogUG9zaWNpb25hIG8gZWxlbWVudG8gYWNpbWEgZSDDoCBkaXJlaXRhIGRvIGNvbXBvbmVudGUgYWx2by5cbiAgKiAtIGB0b3AtbGVmdGA6IFBvc2ljaW9uYSBvIGVsZW1lbnRvIGFjaW1hIGUgw6AgZXNxdWVyZGEgZG8gY29tcG9uZW50ZSBhbHZvLlxuICAqXG4gICogQ2FzbyBvIGVsZW1lbnRvIG7Do28gY2FpYmEgbmEgdGVsYSBuYSBwb3Npw6fDo28gaW5kaWNhZGEgZWxlIHNlcsOhIHJvdGFjaW9uYWRvIGF1dG9tYXRpY2FtZW50ZSBwYXJhIHNlIGFkZXF1YXIsXG4gICogaW5pY2lhbG1lbnRlIG5vIGxhZG8gZGVmaW5pZG8gY29tbyBwYWRyw6NvIGUgZW0gc2VndWlkYSBzZWd1aW5kbyBvIHNlbnRpZG8gaG9yw6FyaW8uXG4gICovXG5cbmNvbnN0IHRoZkNvbnRyb2xQb3NpdGlvblNpZGVzRGVmYXVsdDogQXJyYXk8c3RyaW5nPiA9IFtcbiAgJ2JvdHRvbScsICdib3R0b20tbGVmdCcsICdib3R0b20tcmlnaHQnLFxuICAnbGVmdCcsICdsZWZ0LXRvcCcsICdsZWZ0LWJvdHRvbScsXG4gICd0b3AnLCAndG9wLXJpZ2h0JywgJ3RvcC1sZWZ0JyxcbiAgJ3JpZ2h0JywgJ3JpZ2h0LWJvdHRvbScsICdyaWdodC10b3AnXG5dO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgVGhmQ29udHJvbFBvc2l0aW9uU2VydmljZSB7XG5cbiAgcHJpdmF0ZSBhcnJvd0RpcmVjdGlvbjogc3RyaW5nO1xuICBwcml2YXRlIGN1c3RvbVBvc2l0aW9uczogQXJyYXk8c3RyaW5nPjtcbiAgcHJpdmF0ZSBkaWZmZXJlbmNlRGlhZ29uYWxUb1dpZHRoQXJyb3c6IG51bWJlciA9IDM7XG4gIHByaXZhdGUgZWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gIHByaXZhdGUgZWxlbWVudE9mZnNldDogbnVtYmVyO1xuICBwcml2YXRlIGlzQ29ybmVyQWxpZ25lZDogYm9vbGVhbjtcbiAgcHJpdmF0ZSBpc1NldEVsZW1lbnRXaWR0aDogYm9vbGVhbiA9IGZhbHNlO1xuICAvLyBvZmZzZXQgZGEgc2V0YSBlbSByZWxhw6fDo28gYW8gY2FudG8gZG8gY29tcG9uZW50ZVxuICBwcml2YXRlIG9mZnNldEFycm93OiBudW1iZXIgPSAxMjtcbiAgcHJpdmF0ZSB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudDtcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIEFqdXN0YSBhIHBvc2nDp8OjbyBkbyBlbGVtZW50bywgY2FzbyBuw6NvIGNvdWJlciBlbSB0ZWxhIGlyw6EgcGFyYSBwcsOzeGltYSBwb3Npw6fDo28uXG4gICAqXG4gICAqIEBwYXJhbSB2YWx1ZSBwb3Npw6fDo28gcGFyYSBleGliacOnw6NvIGRvIGVsZW1lbnRvXG4gICAqL1xuICBhZGp1c3RQb3NpdGlvbih2YWx1ZTogc3RyaW5nKSB7XG4gICAgY29uc3QgcG9zaXRpb24gPSB2YWx1ZSB8fCAnYm90dG9tJztcbiAgICB0aGlzLmVsZW1lbnRQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgdGhpcy5jdXN0b21Qb3NpdGlvbnMgJiYgdGhpcy5jdXN0b21Qb3NpdGlvbnMubGVuZ3RoID8gdGhpcy5hZGp1c3RDdXN0b21Qb3NpdGlvbihwb3NpdGlvbikgOiB0aGlzLmFkanVzdERlZmF1bHRQb3NpdGlvbihwb3NpdGlvbik7XG4gIH1cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIFJldG9ybmEgYSBkaXJlw6fDo28gZGEgc2V0YSwgY29uZm9ybWUgYSBwb3Npw6fDo28gZG8gZWxlbWVudG8uXG4gICAqL1xuICBnZXRBcnJvd0RpcmVjdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5hcnJvd0RpcmVjdGlvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gTcOpdG9kbyByZXNwb25zw6F2ZWwgcG9yIGRlZmluaXIgYXMgcHJvcHJpZWRhZGVzIHV0aWxpemFkYXMgcGFyYSBleGliaXIgbyBlbGVtZW50byBuYSBwb3Npw6fDo28gY29ycmV0YS5cbiAgICpcbiAgICogQHBhcmFtIGVsZW1lbnQgZWxlbWVudG8gcXVlIHNlcsOhIGV4aWJpZG9cbiAgICogQHBhcmFtIGVsZW1lbnRPZmZzZXQgb2ZmU2V0IGRvIGVsZW1lbnRvXG4gICAqIEBwYXJhbSB0YXJnZXRFbGVtZW50IGVsZW1lbnRvIGRlIG9uZGUgZGV2ZSBwYXJ0aXIgYSBleGliacOnw6NvXG4gICAqIEBwYXJhbSBjdXN0b21Qb3NpdGlvbnMgcG9zacOnw7VlcyBxdWUgc29icmVzY3JldmUgYXMgcG9zacOnw7VlcyBwYWRyw7Vlc1xuICAgKiBAcGFyYW0gaXNTZXRFbGVtZW50V2lkdGggaW5kaWNhIHNlIGRldmUgZGVmaW5pciBvIHRhbWFuaG8gZG8gZWxlbWVudG8gYSBzZXIgZXhpYmlkbywgY2FzbyBmb3IgdmVyZGFkZWlybyBzZXLDoSBpZ3VhbCBkbyB0YXJnZXRFbGVtZW50XG4gICAqIEBwYXJhbSBpc0Nvcm5lckFsaWduZWQgaW5kaWNhIHNlIG8gZWxlbWVudG8gZmlsaG8gc2Vyw6EgYWxpbmhhZG8gbm9zIGNhbnRvcyBkbyBlbGVtbmV0byBwYWkuXG4gICAqL1xuICBzZXRFbGVtZW50cyhlbGVtZW50OiBFbGVtZW50UmVmIHwgSFRNTEVsZW1lbnQsIGVsZW1lbnRPZmZzZXQ6IG51bWJlciwgdGFyZ2V0RWxlbWVudDogRWxlbWVudFJlZiB8IEhUTUxFbGVtZW50LFxuICAgICAgICAgICAgICBjdXN0b21Qb3NpdGlvbnM/OiBBcnJheTxzdHJpbmc+LCBpc1NldEVsZW1lbnRXaWR0aDogYm9vbGVhbiA9IGZhbHNlLCBpc0Nvcm5lckFsaWduZWQ6IGJvb2xlYW4gPSBmYWxzZSkge1xuXG4gICAgdGhpcy5lbGVtZW50ID0gKGVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50UmVmKSA/IGVsZW1lbnQubmF0aXZlRWxlbWVudCA6IGVsZW1lbnQ7XG4gICAgdGhpcy50YXJnZXRFbGVtZW50ID0gKHRhcmdldEVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50UmVmKSA/IHRhcmdldEVsZW1lbnQubmF0aXZlRWxlbWVudCA6IHRhcmdldEVsZW1lbnQ7XG5cbiAgICB0aGlzLmVsZW1lbnRPZmZzZXQgPSBlbGVtZW50T2Zmc2V0O1xuXG4gICAgdGhpcy5jdXN0b21Qb3NpdGlvbnMgPSBjdXN0b21Qb3NpdGlvbnM7XG4gICAgdGhpcy5pc1NldEVsZW1lbnRXaWR0aCA9IGlzU2V0RWxlbWVudFdpZHRoO1xuICAgIHRoaXMuaXNDb3JuZXJBbGlnbmVkID0gaXNDb3JuZXJBbGlnbmVkO1xuICB9XG5cbiAgcHJpdmF0ZSBhZGp1c3RDdXN0b21Qb3NpdGlvbihwb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgY29uc3QgcG9zaXRpb25MZW5ndGggPSB0aGlzLmN1c3RvbVBvc2l0aW9ucy5sZW5ndGg7XG5cbiAgICBsZXQgc2lkZXNDb3VudCA9IDA7XG5cbiAgICB3aGlsZSAoc2lkZXNDb3VudCsrIDwgcG9zaXRpb25MZW5ndGgpIHtcbiAgICAgIGlmICh0aGlzLm92ZXJmbG93QWxsU2lkZXMocG9zaXRpb24pKSB7XG4gICAgICAgIHBvc2l0aW9uID0gdGhpcy5uZXh0UG9zaXRpb24ocG9zaXRpb24sIHRoaXMuY3VzdG9tUG9zaXRpb25zKTtcbiAgICAgICAgdGhpcy5lbGVtZW50UG9zaXRpb24ocG9zaXRpb24pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYWRqdXN0RGVmYXVsdFBvc2l0aW9uKHBvc2l0aW9uOiBzdHJpbmcpIHtcbiAgICBjb25zdCBtYWluUG9zaXRpb25zID0gdGhpcy5nZXRNYWluUG9zaXRpb25zKCk7XG4gICAgY29uc3QgbWFpblBvc2l0aW9uTGVuZ3RoID0gbWFpblBvc2l0aW9ucy5sZW5ndGg7XG5cbiAgICBsZXQgbWFpblNpZGVzQ291bnQgPSAwO1xuXG4gICAgd2hpbGUgKG1haW5TaWRlc0NvdW50KysgPCBtYWluUG9zaXRpb25MZW5ndGgpIHtcbiAgICAgIGNvbnN0IG1haW5Qb3NpdGlvbiA9IHRoaXMuZ2V0TWFpblBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICAgIHRoaXMuZWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uKTtcblxuICAgICAgaWYgKHRoaXMub3ZlcmZsb3dNYWluKG1haW5Qb3NpdGlvbikpIHtcbiAgICAgICAgcG9zaXRpb24gPSB0aGlzLm5leHRQb3NpdGlvbihtYWluUG9zaXRpb24sIG1haW5Qb3NpdGlvbnMpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vdmVyZmxvd0FsbFNpZGVzKHBvc2l0aW9uKSkge1xuICAgICAgICB0aGlzLnZlcmlmeVN1YlBvc2l0aW9ucyhwb3NpdGlvbik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uOiBzdHJpbmcpIHtcbiAgICB0aGlzLmlzQ29ybmVyQWxpZ25lZCA/IHRoaXMuc2V0QWxpZ25lZEVsZW1lbnRQb3NpdGlvbihwb3NpdGlvbikgOiB0aGlzLnNldEVsZW1lbnRQb3NpdGlvbihwb3NpdGlvbik7XG4gIH1cblxuICBwcml2YXRlIGdldE1haW5Qb3NpdGlvbihwb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgcmV0dXJuIChwb3NpdGlvbi5pbmRleE9mKCctJykgPiAtMSkgPyBwb3NpdGlvbi5zdWJzdHJpbmcoMCwgcG9zaXRpb24uaW5kZXhPZignLScpKSA6IHBvc2l0aW9uO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRNYWluUG9zaXRpb25zKCkge1xuICAgIGNvbnN0IGRlZmF1bHRNYWluUG9zaXRpb25zID0gWyd0b3AnLCAncmlnaHQnLCAnYm90dG9tJywgJ2xlZnQnXTtcblxuICAgIHJldHVybiB0aGlzLmN1c3RvbVBvc2l0aW9ucyAmJiB0aGlzLmN1c3RvbVBvc2l0aW9ucy5sZW5ndGggP1xuICAgICAgdGhpcy5nZXRNYWluUG9zaXRpb25zQnlDdXN0b21Qb3NpdGlvbnModGhpcy5jdXN0b21Qb3NpdGlvbnMpIDogZGVmYXVsdE1haW5Qb3NpdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIGdldE1haW5Qb3NpdGlvbnNCeUN1c3RvbVBvc2l0aW9ucyhjdXN0b21Qb3NpdGlvbnM6IEFycmF5PHN0cmluZz4pIHtcbiAgICBjb25zdCBtYWluUG9zaXRpb25zID0gW107XG4gICAgY29uc3QgY3VzdG9tUG9zaXRpb25zTGVuZ3RoID0gY3VzdG9tUG9zaXRpb25zLmxlbmd0aDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3VzdG9tUG9zaXRpb25zTGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHBvc2l0aW9uID0gY3VzdG9tUG9zaXRpb25zW2ldO1xuXG4gICAgICBjb25zdCBtYWluUG9zaXRpb24gPSB0aGlzLmdldE1haW5Qb3NpdGlvbihwb3NpdGlvbik7XG5cbiAgICAgIGlmICghbWFpblBvc2l0aW9ucy5pbmNsdWRlcyhtYWluUG9zaXRpb24pKSB7XG4gICAgICAgIG1haW5Qb3NpdGlvbnMucHVzaChtYWluUG9zaXRpb24pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBtYWluUG9zaXRpb25zO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRPdmVyZmxvd3MoKSB7XG4gICAgY29uc3Qgc2l6ZXNBbmRQb3NpdGlvbnMgPSB0aGlzLmdldFNpemVzQW5kUG9zaXRpb25zKCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcmlnaHQ6IChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LnJpZ2h0ID4gc2l6ZXNBbmRQb3NpdGlvbnMud2luZG93LmlubmVyV2lkdGgpLFxuICAgICAgdG9wOiAoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC50b3AgPD0gMCksXG4gICAgICBsZWZ0OiAoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC5sZWZ0IDw9IDApLFxuICAgICAgYm90dG9tOiAoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC5ib3R0b20gPiBzaXplc0FuZFBvc2l0aW9ucy53aW5kb3cuaW5uZXJIZWlnaHQpXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0U2l6ZXNBbmRQb3NpdGlvbnMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpbmRvdzoge1xuICAgICAgICBzY3JvbGxZOiB3aW5kb3cuc2Nyb2xsWSxcbiAgICAgICAgc2Nyb2xsWDogd2luZG93LnNjcm9sbFgsXG4gICAgICAgIGlubmVyV2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICBpbm5lckhlaWdodDogd2luZG93LmlubmVySGVpZ2h0XG4gICAgICB9LFxuICAgICAgZWxlbWVudDogdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgdGFyZ2V0OiB0aGlzLnRhcmdldEVsZW1lbnQgPyB0aGlzLnRhcmdldEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiB7IHRvcDogMCwgYm90dG9tOiAwLCByaWdodDogMCwgbGVmdDogMCB9XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgbmV4dFBvc2l0aW9uKHBvc2l0aW9uOiBzdHJpbmcsIHBvc2l0aW9uczogQXJyYXk8c3RyaW5nPiA9IFtdKTogc3RyaW5nIHtcbiAgICBjb25zdCBpbmRleCA9IHBvc2l0aW9ucy5pbmRleE9mKHBvc2l0aW9uKTtcbiAgICBjb25zdCBuZXh0SW5kZXggPSBpbmRleCArIDE7XG5cbiAgICBpZiAoaW5kZXggPiAtMSAmJiBuZXh0SW5kZXggPCBwb3NpdGlvbnMubGVuZ3RoKSB7XG5cbiAgICAgIHJldHVybiBwb3NpdGlvbnNbbmV4dEluZGV4XTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHBvc2l0aW9uc1swXTtcbiAgICB9XG5cbiAgfVxuXG4gIHByaXZhdGUgb3ZlcmZsb3dBbGxTaWRlcyhwb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgY29uc3Qgb3ZlcmZsb3dzID0gdGhpcy5nZXRPdmVyZmxvd3MoKTtcblxuICAgIHN3aXRjaCAocG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ3RvcCc6IHJldHVybiBvdmVyZmxvd3MudG9wIHx8IG92ZXJmbG93cy5yaWdodCB8fCBvdmVyZmxvd3MubGVmdDtcbiAgICAgIGNhc2UgJ3RvcC1yaWdodCc6IHJldHVybiBvdmVyZmxvd3MudG9wIHx8IG92ZXJmbG93cy5yaWdodDtcbiAgICAgIGNhc2UgJ3RvcC1sZWZ0JzogcmV0dXJuIG92ZXJmbG93cy50b3AgfHwgb3ZlcmZsb3dzLmxlZnQ7XG4gICAgICBjYXNlICdyaWdodCc6IHJldHVybiBvdmVyZmxvd3MucmlnaHQgfHwgb3ZlcmZsb3dzLnRvcCB8fCBvdmVyZmxvd3MuYm90dG9tO1xuICAgICAgY2FzZSAncmlnaHQtdG9wJzogcmV0dXJuIG92ZXJmbG93cy5yaWdodCB8fCBvdmVyZmxvd3MudG9wO1xuICAgICAgY2FzZSAncmlnaHQtYm90dG9tJzogcmV0dXJuIG92ZXJmbG93cy5yaWdodCB8fCBvdmVyZmxvd3MuYm90dG9tO1xuICAgICAgY2FzZSAnYm90dG9tJzogcmV0dXJuIG92ZXJmbG93cy5ib3R0b20gfHwgb3ZlcmZsb3dzLnJpZ2h0IHx8IG92ZXJmbG93cy5sZWZ0O1xuICAgICAgY2FzZSAnYm90dG9tLXJpZ2h0JzogcmV0dXJuIG92ZXJmbG93cy5ib3R0b20gfHwgb3ZlcmZsb3dzLnJpZ2h0O1xuICAgICAgY2FzZSAnYm90dG9tLWxlZnQnOiByZXR1cm4gb3ZlcmZsb3dzLmJvdHRvbSB8fCBvdmVyZmxvd3MubGVmdDtcbiAgICAgIGNhc2UgJ2xlZnQnOiByZXR1cm4gb3ZlcmZsb3dzLmxlZnQgfHwgb3ZlcmZsb3dzLnRvcCB8fCBvdmVyZmxvd3MuYm90dG9tO1xuICAgICAgY2FzZSAnbGVmdC10b3AnOiByZXR1cm4gb3ZlcmZsb3dzLmxlZnQgfHwgb3ZlcmZsb3dzLnRvcDtcbiAgICAgIGNhc2UgJ2xlZnQtYm90dG9tJzogcmV0dXJuIG92ZXJmbG93cy5sZWZ0IHx8IG92ZXJmbG93cy5ib3R0b207XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBvdmVyZmxvd01haW4ocG9zaXRpb246IHN0cmluZykge1xuICAgIGNvbnN0IG92ZXJmbG93cyA9IHRoaXMuZ2V0T3ZlcmZsb3dzKCk7XG5cbiAgICBzd2l0Y2ggKHBvc2l0aW9uKSB7XG4gICAgICBjYXNlICd0b3AnOiByZXR1cm4gb3ZlcmZsb3dzLnRvcDtcbiAgICAgIGNhc2UgJ3JpZ2h0JzogcmV0dXJuIG92ZXJmbG93cy5yaWdodDtcbiAgICAgIGNhc2UgJ2JvdHRvbSc6IHJldHVybiBvdmVyZmxvd3MuYm90dG9tO1xuICAgICAgY2FzZSAnbGVmdCc6IHJldHVybiBvdmVyZmxvd3MubGVmdDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldEFsaWduZWRBcnJvd0RpcmVjdGlvbihlbGVtZW50UG9zaXRpb246IHN0cmluZykge1xuICAgIHN3aXRjaCAoZWxlbWVudFBvc2l0aW9uKSB7XG4gICAgICBjYXNlICd0b3AtbGVmdCc6IHJldHVybiAnYm90dG9tLWxlZnQnO1xuICAgICAgY2FzZSAndG9wLXJpZ2h0JzogcmV0dXJuICdib3R0b20tcmlnaHQnO1xuICAgICAgY2FzZSAnYm90dG9tLXJpZ2h0JzogcmV0dXJuICd0b3AtcmlnaHQnO1xuICAgICAgY2FzZSAnYm90dG9tLWxlZnQnOiByZXR1cm4gJ3RvcC1sZWZ0JztcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldEFsaWduZWRCb3R0b21Qb3NpdGlvbnMoZGlzcGxhY2VtZW50OiBudW1iZXIsIHNpemVzQW5kUG9zaXRpb25zKSB7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC5ib3R0b20gKyB0aGlzLmVsZW1lbnRPZmZzZXQgKyAncHgnO1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LmxlZnQgLSBkaXNwbGFjZW1lbnQgKyAncHgnO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRBbGlnbmVkRWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uOiBzdHJpbmcpIHtcbiAgICB0aGlzLnNldEVsZW1lbnRXaWR0aCgpO1xuXG4gICAgY29uc3Qgc2l6ZXNBbmRQb3NpdGlvbnM6IGFueSA9IHRoaXMuZ2V0U2l6ZXNBbmRQb3NpdGlvbnMoKTtcblxuICAgIHN3aXRjaCAocG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ2JvdHRvbS1sZWZ0JzpcbiAgICAgICAgdGhpcy5zZXRBbGlnbmVkQm90dG9tUG9zaXRpb25zKDAsIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdib3R0b20tcmlnaHQnOlxuICAgICAgICB0aGlzLnNldEFsaWduZWRCb3R0b21Qb3NpdGlvbnMoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC53aWR0aCAtIHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC53aWR0aCwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RvcC1sZWZ0JzpcbiAgICAgICAgdGhpcy5zZXRBbGlnbmVkVG9wUG9zaXRpb25zKDAsIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0b3AtcmlnaHQnOlxuICAgICAgICB0aGlzLnNldEFsaWduZWRUb3BQb3NpdGlvbnMoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC53aWR0aCAtIHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC53aWR0aCwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICB0aGlzLmFycm93RGlyZWN0aW9uID0gdGhpcy5zZXRBbGlnbmVkQXJyb3dEaXJlY3Rpb24ocG9zaXRpb24pO1xuXG4gIH1cblxuICBwcml2YXRlIHNldEFsaWduZWRUb3BQb3NpdGlvbnMoZGlzcGxhY2VtZW50OiBudW1iZXIsIHNpemVzQW5kUG9zaXRpb25zKSB7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC50b3AgLSBzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmhlaWdodCAtIHRoaXMuZWxlbWVudE9mZnNldCArICdweCc7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQubGVmdCAtIGRpc3BsYWNlbWVudCArICdweCc7XG4gIH1cblxuICBwcml2YXRlIHNldEFycm93RGlyZWN0aW9uKGVsZW1lbnRQb3NpdGlvbjogc3RyaW5nKSB7XG4gICAgc3dpdGNoIChlbGVtZW50UG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ3RvcCc6IHJldHVybiAnYm90dG9tJztcbiAgICAgIGNhc2UgJ3RvcC1sZWZ0JzogcmV0dXJuICdib3R0b20tcmlnaHQnO1xuICAgICAgY2FzZSAndG9wLXJpZ2h0JzogcmV0dXJuICdib3R0b20tbGVmdCc7XG4gICAgICBjYXNlICdyaWdodCc6IHJldHVybiAnbGVmdCc7XG4gICAgICBjYXNlICdyaWdodC10b3AnOiByZXR1cm4gJ2xlZnQtYm90dG9tJztcbiAgICAgIGNhc2UgJ3JpZ2h0LWJvdHRvbSc6IHJldHVybiAnbGVmdC10b3AnO1xuICAgICAgY2FzZSAnYm90dG9tJzogcmV0dXJuICd0b3AnO1xuICAgICAgY2FzZSAnYm90dG9tLXJpZ2h0JzogcmV0dXJuICd0b3AtbGVmdCc7XG4gICAgICBjYXNlICdib3R0b20tbGVmdCc6IHJldHVybiAndG9wLXJpZ2h0JztcbiAgICAgIGNhc2UgJ2xlZnQnOiByZXR1cm4gJ3JpZ2h0JztcbiAgICAgIGNhc2UgJ2xlZnQtYm90dG9tJzogcmV0dXJuICdyaWdodC10b3AnO1xuICAgICAgY2FzZSAnbGVmdC10b3AnOiByZXR1cm4gJ3JpZ2h0LWJvdHRvbSc7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXRCb3R0b21Qb3NpdGlvbnMoZGlzcGxhY2VtZW50OiBudW1iZXIsIHNpemVzQW5kUG9zaXRpb25zKSB7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC5ib3R0b20gKyB0aGlzLmVsZW1lbnRPZmZzZXQgKyAncHgnO1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LmxlZnQgKyAoc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LndpZHRoIC8gMikgLSBkaXNwbGFjZW1lbnQgKyAncHgnO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRFbGVtZW50UG9zaXRpb24ocG9zaXRpb246IHN0cmluZykge1xuICAgIHRoaXMuc2V0RWxlbWVudFdpZHRoKCk7XG5cbiAgICBjb25zdCBzaXplc0FuZFBvc2l0aW9ucyA9IHRoaXMuZ2V0U2l6ZXNBbmRQb3NpdGlvbnMoKTtcblxuICAgIHN3aXRjaCAocG9zaXRpb24pIHtcbiAgICAgIGNhc2UgJ3RvcCc6XG4gICAgICAgIHRoaXMuc2V0VG9wUG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LndpZHRoIC8gMiksIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0b3AtbGVmdCc6XG4gICAgICAgIHRoaXMuc2V0VG9wUG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LndpZHRoIC0gdGhpcy5vZmZzZXRBcnJvdyAtIHRoaXMuZGlmZmVyZW5jZURpYWdvbmFsVG9XaWR0aEFycm93KSwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RvcC1yaWdodCc6XG4gICAgICAgIHRoaXMuc2V0VG9wUG9zaXRpb25zKCh0aGlzLm9mZnNldEFycm93ICsgdGhpcy5kaWZmZXJlbmNlRGlhZ29uYWxUb1dpZHRoQXJyb3cpLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICB0aGlzLnNldFJpZ2h0UG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LmhlaWdodCAvIDIpLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAncmlnaHQtdG9wJzpcbiAgICAgICAgdGhpcy5zZXRSaWdodFBvc2l0aW9ucygoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC5oZWlnaHQgLSB0aGlzLm9mZnNldEFycm93IC0gdGhpcy5kaWZmZXJlbmNlRGlhZ29uYWxUb1dpZHRoQXJyb3cpLFxuICAgICAgICAgIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyaWdodC1ib3R0b20nOlxuICAgICAgICB0aGlzLnNldFJpZ2h0UG9zaXRpb25zKHRoaXMub2Zmc2V0QXJyb3csIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdib3R0b20nOlxuICAgICAgICB0aGlzLnNldEJvdHRvbVBvc2l0aW9ucygoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC53aWR0aCAvIDIpLCBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnYm90dG9tLXJpZ2h0JzpcbiAgICAgICAgdGhpcy5zZXRCb3R0b21Qb3NpdGlvbnMoKHRoaXMub2Zmc2V0QXJyb3cgKyB0aGlzLmRpZmZlcmVuY2VEaWFnb25hbFRvV2lkdGhBcnJvdyksIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdib3R0b20tbGVmdCc6XG4gICAgICAgIHRoaXMuc2V0Qm90dG9tUG9zaXRpb25zKChzaXplc0FuZFBvc2l0aW9ucy5lbGVtZW50LndpZHRoIC0gdGhpcy5vZmZzZXRBcnJvdyAtIHRoaXMuZGlmZmVyZW5jZURpYWdvbmFsVG9XaWR0aEFycm93KSxcbiAgICAgICAgICBzaXplc0FuZFBvc2l0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgIHRoaXMuc2V0TGVmdFBvc2l0aW9ucygoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC5oZWlnaHQgLyAyKSwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2xlZnQtYm90dG9tJzpcbiAgICAgICAgdGhpcy5zZXRMZWZ0UG9zaXRpb25zKHRoaXMub2Zmc2V0QXJyb3csIHNpemVzQW5kUG9zaXRpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdsZWZ0LXRvcCc6XG4gICAgICAgIHRoaXMuc2V0TGVmdFBvc2l0aW9ucygoc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC5oZWlnaHQgLSB0aGlzLm9mZnNldEFycm93KSwgc2l6ZXNBbmRQb3NpdGlvbnMpO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICB0aGlzLmFycm93RGlyZWN0aW9uID0gdGhpcy5zZXRBcnJvd0RpcmVjdGlvbihwb3NpdGlvbik7XG4gIH1cblxuICBwcml2YXRlIHNldEVsZW1lbnRXaWR0aCgpIHtcbiAgICBpZiAodGhpcy5pc1NldEVsZW1lbnRXaWR0aCAmJiB0aGlzLnRhcmdldEVsZW1lbnQpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3RoaXMudGFyZ2V0RWxlbWVudC5jbGllbnRXaWR0aH1weGA7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXRMZWZ0UG9zaXRpb25zKGRpc3BsYWNlbWVudDogbnVtYmVyLCBzaXplc0FuZFBvc2l0aW9ucykge1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQudG9wIC0gZGlzcGxhY2VtZW50ICsgKHNpemVzQW5kUG9zaXRpb25zLnRhcmdldC5oZWlnaHQgLyAyKSArICdweCc7XG4gICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQubGVmdCAtIHNpemVzQW5kUG9zaXRpb25zLmVsZW1lbnQud2lkdGggLSB0aGlzLmVsZW1lbnRPZmZzZXQgKyAncHgnO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRSaWdodFBvc2l0aW9ucyhkaXNwbGFjZW1lbnQ6IG51bWJlciwgc2l6ZXNBbmRQb3NpdGlvbnMpIHtcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LnRvcCAtIGRpc3BsYWNlbWVudCArIChzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQuaGVpZ2h0IC8gMikgKyAncHgnO1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LnJpZ2h0ICsgdGhpcy5lbGVtZW50T2Zmc2V0ICsgJ3B4JztcbiAgfVxuXG4gIHByaXZhdGUgc2V0VG9wUG9zaXRpb25zKGRpc3BsYWNlbWVudDogbnVtYmVyLCBzaXplc0FuZFBvc2l0aW9ucykge1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSBzaXplc0FuZFBvc2l0aW9ucy50YXJnZXQudG9wIC0gc2l6ZXNBbmRQb3NpdGlvbnMuZWxlbWVudC5oZWlnaHQgLSB0aGlzLmVsZW1lbnRPZmZzZXQgKyAncHgnO1xuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LmxlZnQgKyAoc2l6ZXNBbmRQb3NpdGlvbnMudGFyZ2V0LndpZHRoIC8gMikgLSBkaXNwbGFjZW1lbnQgKyAncHgnO1xuICB9XG5cbiAgcHJpdmF0ZSB2ZXJpZnlTdWJQb3NpdGlvbnMocG9zaXRpb246IHN0cmluZykge1xuICAgIGlmIChwb3NpdGlvbi5pbmRleE9mKCctJykgPiAtMSkge1xuICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbi5zdWJzdHJpbmcoMCwgcG9zaXRpb24uaW5kZXhPZignLScpKTtcbiAgICAgIHRoaXMuZWxlbWVudFBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICB9XG5cbiAgICBsZXQgYWxpZ24gPSAwO1xuICAgIHdoaWxlIChhbGlnbisrIDwgMykge1xuICAgICAgaWYgKHRoaXMub3ZlcmZsb3dBbGxTaWRlcyhwb3NpdGlvbikpIHtcbiAgICAgICAgcG9zaXRpb24gPSB0aGlzLm5leHRQb3NpdGlvbihwb3NpdGlvbiwgdGhmQ29udHJvbFBvc2l0aW9uU2lkZXNEZWZhdWx0KTtcbiAgICAgICAgdGhpcy5lbGVtZW50UG9zaXRpb24ocG9zaXRpb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cbiJdfQ==