/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { EventEmitter, Input, Output } from '@angular/core';
import { browserLanguage, thfLocaleDefault, convertToBoolean } from '../../utils/util';
/** @type {?} */
export var thfListViewLiteralsDefault = {
    en: (/** @type {?} */ ({
        hideDetails: 'Hide details',
        loadMoreData: 'Load more data',
        noData: 'No data found',
        selectAll: 'Select all',
        showDetails: 'Show details'
    })),
    es: (/** @type {?} */ ({
        hideDetails: 'Ocultar detalles',
        loadMoreData: 'Cargar más resultados',
        noData: 'Datos no encontrados',
        selectAll: 'Seleccionar todos',
        showDetails: 'Mostrar detalles'
    })),
    pt: (/** @type {?} */ ({
        hideDetails: 'Ocultar detalhes',
        loadMoreData: 'Carregar mais resultados',
        noData: 'Nenhum dado encontrado',
        selectAll: 'Selecionar todos',
        showDetails: 'Exibir detalhes'
    }))
};
/**
 * \@description
 *
 * Componente de lista que recebe um array de objetos e renderiza de forma dinâmica os dados de
 * acordo com a necessidade de cada tela e deve ser utilizado em conjunto com as diretivas de *templates*
 *  **[t-list-view-content-template](/documentation/thf-list-view-content-template)** e
 * **[t-list-view-detail-template](/documentation/thf-list-view-detail-template)**.
 *
 * O componente disponibiliza uma área específica para exibição informações adicionais,
 * através da diretiva **[t-list-view-detail-template](/documentation/thf-list-view-detail-template)**.
 */
var ThfListViewBaseComponent = /** @class */ (function () {
    function ThfListViewBaseComponent() {
        this.selectAll = false;
        this.showHeader = false;
        /**
         * Recebe uma ação, que será executada quando clicar no botão "Carregar mais resultados".
         *
         * > Caso nenhuma ação for definida o mesmo não ficará visível.
         */
        this.showMore = new EventEmitter();
        /**
         * Ação que será executada ao clicar no título.
         *
         * Ao ser disparado, o método inserido na ação irá receber como parâmetro o item da lista clicado.
         */
        this.titleAction = new EventEmitter();
    }
    Object.defineProperty(ThfListViewBaseComponent.prototype, "actions", {
        get: /**
         * @return {?}
         */
        function () {
            return this._actions;
        },
        /**
         * @optional
         *
         * @description
         *
         * Lista de ações que serão exibidas no componente.
         */
        set: /**
         * \@optional
         *
         * \@description
         *
         * Lista de ações que serão exibidas no componente.
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._actions = Array.isArray(value) ? value : [];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThfListViewBaseComponent.prototype, "height", {
        get: /**
         * @return {?}
         */
        function () {
            return this._height;
        },
        /**
         * @optional
         *
         * @description
         *
         * Define a altura do `thf-list-view` em *pixels*.
         */
        set: /**
         * \@optional
         *
         * \@description
         *
         * Define a altura do `thf-list-view` em *pixels*.
         * @param {?} height
         * @return {?}
         */
        function (height) {
            this._height = height;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThfListViewBaseComponent.prototype, "hideSelectAll", {
        get: /**
         * @return {?}
         */
        function () {
            return this._hideSelectAll;
        },
        /**
         * @description
         *
         * Esconde o *checkbox* para seleção de todos os itens.
         *
         * @default `false`
         */
        set: /**
         * \@description
         *
         * Esconde o *checkbox* para seleção de todos os itens.
         *
         * \@default `false`
         * @param {?} hideSelectAll
         * @return {?}
         */
        function (hideSelectAll) {
            this._hideSelectAll = convertToBoolean(hideSelectAll);
            this.showMainHeader();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThfListViewBaseComponent.prototype, "items", {
        get: /**
         * @return {?}
         */
        function () {
            return this._items;
        },
        /** Lista de itens que serão exibidos no componente. */
        set: /**
         * Lista de itens que serão exibidos no componente.
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._items = Array.isArray(value) ? value : [];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThfListViewBaseComponent.prototype, "literals", {
        get: /**
         * @return {?}
         */
        function () {
            return this._literals || thfListViewLiteralsDefault[browserLanguage()];
        },
        /**
         * @optional
         *
         * @description
         *
         * Objeto com as literais usadas no `thf-list-view`.
         *
         * Existem duas maneiras de customizar o componente, passando um objeto com todas as literais disponíveis:
         *
         * ```
         *  const customLiterals: ThfListViewLiterals = {
         *    hideDetail: 'Ocultar detalhes completamente',
         *    loadMoreData: 'Mais dados',
         *    showDetail: 'Mostrar mais detalhes',
         *    selectAll: 'Selecionar todos os itens'
         *  };
         * ```
         *
         * Ou passando apenas as literais que deseja customizar:
         *
         * ```
         *  const customLiterals: ThfListViewLiterals = {
         *    showDetail: 'Mostrar mais detalhes'
         *  };
         * ```
         *
         * E para carregar as literais customizadas, basta apenas passar o objeto para o componente.
         *
         * ```
         * <thf-list-view
         *   [t-literals]="customLiterals">
         * </thf-list-view>
         * ```
         *
         * > O objeto padrão de literais será traduzido de acordo com o idioma do browser (pt, en, es).
         */
        set: /**
         * \@optional
         *
         * \@description
         *
         * Objeto com as literais usadas no `thf-list-view`.
         *
         * Existem duas maneiras de customizar o componente, passando um objeto com todas as literais disponíveis:
         *
         * ```
         *  const customLiterals: ThfListViewLiterals = {
         *    hideDetail: 'Ocultar detalhes completamente',
         *    loadMoreData: 'Mais dados',
         *    showDetail: 'Mostrar mais detalhes',
         *    selectAll: 'Selecionar todos os itens'
         *  };
         * ```
         *
         * Ou passando apenas as literais que deseja customizar:
         *
         * ```
         *  const customLiterals: ThfListViewLiterals = {
         *    showDetail: 'Mostrar mais detalhes'
         *  };
         * ```
         *
         * E para carregar as literais customizadas, basta apenas passar o objeto para o componente.
         *
         * ```
         * <thf-list-view
         *   [t-literals]="customLiterals">
         * </thf-list-view>
         * ```
         *
         * > O objeto padrão de literais será traduzido de acordo com o idioma do browser (pt, en, es).
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value instanceof Object && !(value instanceof Array)) {
                this._literals = tslib_1.__assign({}, thfListViewLiteralsDefault[thfLocaleDefault], thfListViewLiteralsDefault[browserLanguage()], value);
            }
            else {
                this._literals = thfListViewLiteralsDefault[browserLanguage()];
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThfListViewBaseComponent.prototype, "select", {
        get: /**
         * @return {?}
         */
        function () {
            return this._select;
        },
        /**
         * @optional
         *
         * @description
         *
         * Habilita um *checkbox* para cada item da lista. Todos os items possuem a propriedade dinâmica `$selected` para identificar se o
         * item está selecionado, por exemplo:
         *
         * ```
         *  item.$selected
         *
         *  // ou
         *
         *  item['$selected']
         * ```
         *
         * @default `false`
         */
        set: /**
         * \@optional
         *
         * \@description
         *
         * Habilita um *checkbox* para cada item da lista. Todos os items possuem a propriedade dinâmica `$selected` para identificar se o
         * item está selecionado, por exemplo:
         *
         * ```
         *  item.$selected
         *
         *  // ou
         *
         *  item['$selected']
         * ```
         *
         * \@default `false`
         * @param {?} select
         * @return {?}
         */
        function (select) {
            this._select = convertToBoolean(select);
            this.showMainHeader();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThfListViewBaseComponent.prototype, "showMoreDisabled", {
        get: /**
         * @return {?}
         */
        function () {
            return this._showMoreDisabled;
        },
        /**
         * @optional
         *
         * @description
         *
         * Indica que o botão `Carregar Mais Resultados` será desabilitado.
         */
        set: /**
         * \@optional
         *
         * \@description
         *
         * Indica que o botão `Carregar Mais Resultados` será desabilitado.
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._showMoreDisabled = convertToBoolean(value);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} listViewAction
     * @param {?} item
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.onClickAction = /**
     * @param {?} listViewAction
     * @param {?} item
     * @return {?}
     */
    function (listViewAction, item) {
        /** @type {?} */
        var cleanItem = this.deleteInternalAttrs(item);
        if (listViewAction.action) {
            listViewAction.action(cleanItem);
        }
    };
    /**
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.onShowMore = /**
     * @return {?}
     */
    function () {
        this.showMore.emit();
    };
    /**
     * @param {?} listItem
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.runTitleAction = /**
     * @param {?} listItem
     * @return {?}
     */
    function (listItem) {
        /** @type {?} */
        var itemWithPublicProperties = this.deleteInternalAttrs(listItem);
        this.titleAction.emit(itemWithPublicProperties);
    };
    /**
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.selectAllListItems = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.hideSelectAll) {
            this.selectAll = !this.selectAll;
            this.items.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.$selected = _this.selectAll;
            }));
        }
    };
    /**
     * @param {?} row
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.selectListItem = /**
     * @param {?} row
     * @return {?}
     */
    function (row) {
        row.$selected = !row.$selected;
        this.selectAll = this.checkIfItemsAreSelected(this.items);
    };
    /**
     * @private
     * @param {?} item
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.deleteInternalAttrs = /**
     * @private
     * @param {?} item
     * @return {?}
     */
    function (item) {
        /** @type {?} */
        var itemCopy = item ? tslib_1.__assign({}, item) : undefined;
        for (var key in itemCopy) {
            if (itemCopy.hasOwnProperty(key) && key.startsWith('$')) {
                delete itemCopy[key];
            }
        }
        return itemCopy;
    };
    /**
     * @private
     * @param {?} items
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.checkIfItemsAreSelected = /**
     * @private
     * @param {?} items
     * @return {?}
     */
    function (items) {
        /** @type {?} */
        var someCheckedOrIndeterminate = (/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.$selected || item.$selected === null; });
        /** @type {?} */
        var everyChecked = (/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.$selected; });
        if (items.every(everyChecked)) {
            return true;
        }
        if (items.some(someCheckedOrIndeterminate)) {
            return null;
        }
        return false;
    };
    /**
     * @private
     * @return {?}
     */
    ThfListViewBaseComponent.prototype.showMainHeader = /**
     * @private
     * @return {?}
     */
    function () {
        this.showHeader = !!(this.select && !this.hideSelectAll && this.items && this.items.length);
    };
    ThfListViewBaseComponent.propDecorators = {
        actions: [{ type: Input, args: ['t-actions',] }],
        height: [{ type: Input, args: ['t-height',] }],
        hideSelectAll: [{ type: Input, args: ['t-hide-select-all',] }],
        items: [{ type: Input, args: ['t-items',] }],
        literals: [{ type: Input, args: ['t-literals',] }],
        propertyLink: [{ type: Input, args: ['t-property-link',] }],
        propertyTitle: [{ type: Input, args: ['t-property-title',] }],
        select: [{ type: Input, args: ['t-select',] }],
        showMoreDisabled: [{ type: Input, args: ['t-show-more-disabled',] }],
        showMore: [{ type: Output, args: ['t-show-more',] }],
        titleAction: [{ type: Output, args: ['t-title-action',] }]
    };
    return ThfListViewBaseComponent;
}());
export { ThfListViewBaseComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ThfListViewBaseComponent.prototype._actions;
    /**
     * @type {?}
     * @private
     */
    ThfListViewBaseComponent.prototype._height;
    /**
     * @type {?}
     * @private
     */
    ThfListViewBaseComponent.prototype._hideSelectAll;
    /**
     * @type {?}
     * @private
     */
    ThfListViewBaseComponent.prototype._items;
    /**
     * @type {?}
     * @private
     */
    ThfListViewBaseComponent.prototype._literals;
    /**
     * @type {?}
     * @private
     */
    ThfListViewBaseComponent.prototype._select;
    /**
     * @type {?}
     * @private
     */
    ThfListViewBaseComponent.prototype._showMoreDisabled;
    /** @type {?} */
    ThfListViewBaseComponent.prototype.popupTarget;
    /** @type {?} */
    ThfListViewBaseComponent.prototype.selectAll;
    /** @type {?} */
    ThfListViewBaseComponent.prototype.showHeader;
    /**
     * Recebe uma propriedade que será utilizada para recuperar o valor do objeto que será usado como link para o título.
     * @type {?}
     */
    ThfListViewBaseComponent.prototype.propertyLink;
    /**
     * Recebe uma propriedade que será utilizada para recuperar o valor do objeto que será exibido como o título de cada item.
     * @type {?}
     */
    ThfListViewBaseComponent.prototype.propertyTitle;
    /**
     * Recebe uma ação, que será executada quando clicar no botão "Carregar mais resultados".
     *
     * > Caso nenhuma ação for definida o mesmo não ficará visível.
     * @type {?}
     */
    ThfListViewBaseComponent.prototype.showMore;
    /**
     * Ação que será executada ao clicar no título.
     *
     * Ao ser disparado, o método inserido na ação irá receber como parâmetro o item da lista clicado.
     * @type {?}
     */
    ThfListViewBaseComponent.prototype.titleAction;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhmLWxpc3Qtdmlldy1iYXNlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0b3R2cy90aGYtdWkvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90aGYtbGlzdC12aWV3L3RoZi1saXN0LXZpZXctYmFzZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFNUQsT0FBTyxFQUFFLGVBQWUsRUFBRSxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGtCQUFrQixDQUFDOztBQUt2RixNQUFNLEtBQU8sMEJBQTBCLEdBQUc7SUFDeEMsRUFBRSxFQUFFLG1CQUFzQjtRQUN4QixXQUFXLEVBQUUsY0FBYztRQUMzQixZQUFZLEVBQUUsZ0JBQWdCO1FBQzlCLE1BQU0sRUFBRSxlQUFlO1FBQ3ZCLFNBQVMsRUFBRSxZQUFZO1FBQ3ZCLFdBQVcsRUFBRSxjQUFjO0tBQzVCLEVBQUE7SUFDRCxFQUFFLEVBQUUsbUJBQXNCO1FBQ3hCLFdBQVcsRUFBRSxrQkFBa0I7UUFDL0IsWUFBWSxFQUFFLHVCQUF1QjtRQUNyQyxNQUFNLEVBQUUsc0JBQXNCO1FBQzlCLFNBQVMsRUFBRSxtQkFBbUI7UUFDOUIsV0FBVyxFQUFFLGtCQUFrQjtLQUNoQyxFQUFBO0lBQ0QsRUFBRSxFQUFFLG1CQUFzQjtRQUN4QixXQUFXLEVBQUUsa0JBQWtCO1FBQy9CLFlBQVksRUFBRSwwQkFBMEI7UUFDeEMsTUFBTSxFQUFFLHdCQUF3QjtRQUNoQyxTQUFTLEVBQUUsa0JBQWtCO1FBQzdCLFdBQVcsRUFBRSxpQkFBaUI7S0FDL0IsRUFBQTtDQUNGOzs7Ozs7Ozs7Ozs7QUFhRDtJQUFBO1FBV0UsY0FBUyxHQUFZLEtBQUssQ0FBQztRQUMzQixlQUFVLEdBQVksS0FBSyxDQUFDOzs7Ozs7UUFrS0wsYUFBUSxHQUF1QixJQUFJLFlBQVksRUFBTyxD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SyxTQUFDLGtCQUFrQjt5QkFvQnhCLEtBQUssU0FBQyxVQUFVO21DQWdCaEIsS0FBSyxTQUFDLHNCQUFzQjsyQkFhNUIsTUFBTSxTQUFDLGFBQWE7OEJBT3BCLE1BQU0sU0FBQyxnQkFBZ0I7O0lBaUUxQiwrQkFBQztDQUFBLEFBdFBELElBc1BDO1NBdFBZLHdCQUF3Qjs7Ozs7O0lBRW5DLDRDQUEyQzs7Ozs7SUFDM0MsMkNBQXdCOzs7OztJQUN4QixrREFBZ0M7Ozs7O0lBQ2hDLDBDQUEyQjs7Ozs7SUFDM0IsNkNBQXVDOzs7OztJQUN2QywyQ0FBeUI7Ozs7O0lBQ3pCLHFEQUFtQzs7SUFFbkMsK0NBQWlCOztJQUNqQiw2Q0FBMkI7O0lBQzNCLDhDQUE0Qjs7Ozs7SUE4RzVCLGdEQUFnRDs7Ozs7SUFHaEQsaURBQWtEOzs7Ozs7O0lBaURsRCw0Q0FBOEU7Ozs7Ozs7SUFPOUUsK0NBQW9GIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT3V0cHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IGJyb3dzZXJMYW5ndWFnZSwgdGhmTG9jYWxlRGVmYXVsdCwgY29udmVydFRvQm9vbGVhbiB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWwnO1xuXG5pbXBvcnQgeyBUaGZMaXN0Vmlld0FjdGlvbiB9IGZyb20gJy4vaW50ZXJmYWNlcy90aGYtbGlzdC12aWV3LWFjdGlvbi5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgVGhmTGlzdFZpZXdMaXRlcmFscyB9IGZyb20gJy4vaW50ZXJmYWNlcy90aGYtbGlzdC12aWV3LWxpdGVyYWxzLmludGVyZmFjZSc7XG5cbmV4cG9ydCBjb25zdCB0aGZMaXN0Vmlld0xpdGVyYWxzRGVmYXVsdCA9IHtcbiAgZW46IDxUaGZMaXN0Vmlld0xpdGVyYWxzPiB7XG4gICAgaGlkZURldGFpbHM6ICdIaWRlIGRldGFpbHMnLFxuICAgIGxvYWRNb3JlRGF0YTogJ0xvYWQgbW9yZSBkYXRhJyxcbiAgICBub0RhdGE6ICdObyBkYXRhIGZvdW5kJyxcbiAgICBzZWxlY3RBbGw6ICdTZWxlY3QgYWxsJyxcbiAgICBzaG93RGV0YWlsczogJ1Nob3cgZGV0YWlscydcbiAgfSxcbiAgZXM6IDxUaGZMaXN0Vmlld0xpdGVyYWxzPiB7XG4gICAgaGlkZURldGFpbHM6ICdPY3VsdGFyIGRldGFsbGVzJyxcbiAgICBsb2FkTW9yZURhdGE6ICdDYXJnYXIgbcOhcyByZXN1bHRhZG9zJyxcbiAgICBub0RhdGE6ICdEYXRvcyBubyBlbmNvbnRyYWRvcycsXG4gICAgc2VsZWN0QWxsOiAnU2VsZWNjaW9uYXIgdG9kb3MnLFxuICAgIHNob3dEZXRhaWxzOiAnTW9zdHJhciBkZXRhbGxlcydcbiAgfSxcbiAgcHQ6IDxUaGZMaXN0Vmlld0xpdGVyYWxzPiB7XG4gICAgaGlkZURldGFpbHM6ICdPY3VsdGFyIGRldGFsaGVzJyxcbiAgICBsb2FkTW9yZURhdGE6ICdDYXJyZWdhciBtYWlzIHJlc3VsdGFkb3MnLFxuICAgIG5vRGF0YTogJ05lbmh1bSBkYWRvIGVuY29udHJhZG8nLFxuICAgIHNlbGVjdEFsbDogJ1NlbGVjaW9uYXIgdG9kb3MnLFxuICAgIHNob3dEZXRhaWxzOiAnRXhpYmlyIGRldGFsaGVzJ1xuICB9XG59O1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvblxuICpcbiAqIENvbXBvbmVudGUgZGUgbGlzdGEgcXVlIHJlY2ViZSB1bSBhcnJheSBkZSBvYmpldG9zIGUgcmVuZGVyaXphIGRlIGZvcm1hIGRpbsOibWljYSBvcyBkYWRvcyBkZVxuICogYWNvcmRvIGNvbSBhIG5lY2Vzc2lkYWRlIGRlIGNhZGEgdGVsYSBlIGRldmUgc2VyIHV0aWxpemFkbyBlbSBjb25qdW50byBjb20gYXMgZGlyZXRpdmFzIGRlICp0ZW1wbGF0ZXMqXG4gKiAgKipbdC1saXN0LXZpZXctY29udGVudC10ZW1wbGF0ZV0oL2RvY3VtZW50YXRpb24vdGhmLWxpc3Qtdmlldy1jb250ZW50LXRlbXBsYXRlKSoqIGVcbiAqICoqW3QtbGlzdC12aWV3LWRldGFpbC10ZW1wbGF0ZV0oL2RvY3VtZW50YXRpb24vdGhmLWxpc3Qtdmlldy1kZXRhaWwtdGVtcGxhdGUpKiouXG4gKlxuICogTyBjb21wb25lbnRlIGRpc3BvbmliaWxpemEgdW1hIMOhcmVhIGVzcGVjw61maWNhIHBhcmEgZXhpYmnDp8OjbyBpbmZvcm1hw6fDtWVzIGFkaWNpb25haXMsXG4gKiBhdHJhdsOpcyBkYSBkaXJldGl2YSAqKlt0LWxpc3Qtdmlldy1kZXRhaWwtdGVtcGxhdGVdKC9kb2N1bWVudGF0aW9uL3RoZi1saXN0LXZpZXctZGV0YWlsLXRlbXBsYXRlKSoqLlxuICovXG5leHBvcnQgY2xhc3MgVGhmTGlzdFZpZXdCYXNlQ29tcG9uZW50IHtcblxuICBwcml2YXRlIF9hY3Rpb25zOiBBcnJheTxUaGZMaXN0Vmlld0FjdGlvbj47XG4gIHByaXZhdGUgX2hlaWdodDogbnVtYmVyO1xuICBwcml2YXRlIF9oaWRlU2VsZWN0QWxsOiBib29sZWFuO1xuICBwcml2YXRlIF9pdGVtczogQXJyYXk8YW55PjtcbiAgcHJpdmF0ZSBfbGl0ZXJhbHM6IFRoZkxpc3RWaWV3TGl0ZXJhbHM7XG4gIHByaXZhdGUgX3NlbGVjdDogYm9vbGVhbjtcbiAgcHJpdmF0ZSBfc2hvd01vcmVEaXNhYmxlZDogYm9vbGVhbjtcblxuICBwb3B1cFRhcmdldDogYW55O1xuICBzZWxlY3RBbGw6IGJvb2xlYW4gPSBmYWxzZTtcbiAgc2hvd0hlYWRlcjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIExpc3RhIGRlIGHDp8O1ZXMgcXVlIHNlcsOjbyBleGliaWRhcyBubyBjb21wb25lbnRlLlxuICAgKi9cbiAgQElucHV0KCd0LWFjdGlvbnMnKSBzZXQgYWN0aW9ucyh2YWx1ZTogQXJyYXk8VGhmTGlzdFZpZXdBY3Rpb24+KSB7XG4gICAgdGhpcy5fYWN0aW9ucyA9IEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbXTtcbiAgfVxuXG4gIGdldCBhY3Rpb25zKCkge1xuICAgIHJldHVybiB0aGlzLl9hY3Rpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRGVmaW5lIGEgYWx0dXJhIGRvIGB0aGYtbGlzdC12aWV3YCBlbSAqcGl4ZWxzKi5cbiAgICovXG4gIEBJbnB1dCgndC1oZWlnaHQnKSBzZXQgaGVpZ2h0KGhlaWdodDogbnVtYmVyKSB7XG4gICAgdGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG5cbiAgZ2V0IGhlaWdodCgpIHtcbiAgICByZXR1cm4gdGhpcy5faGVpZ2h0O1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBFc2NvbmRlIG8gKmNoZWNrYm94KiBwYXJhIHNlbGXDp8OjbyBkZSB0b2RvcyBvcyBpdGVucy5cbiAgICpcbiAgICogQGRlZmF1bHQgYGZhbHNlYFxuICAgKi9cbiAgQElucHV0KCd0LWhpZGUtc2VsZWN0LWFsbCcpIHNldCBoaWRlU2VsZWN0QWxsKGhpZGVTZWxlY3RBbGw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9oaWRlU2VsZWN0QWxsID0gY29udmVydFRvQm9vbGVhbihoaWRlU2VsZWN0QWxsKTtcbiAgICB0aGlzLnNob3dNYWluSGVhZGVyKCk7XG4gIH1cblxuICBnZXQgaGlkZVNlbGVjdEFsbCgpIHtcbiAgICByZXR1cm4gdGhpcy5faGlkZVNlbGVjdEFsbDtcbiAgfVxuXG4gIC8qKiBMaXN0YSBkZSBpdGVucyBxdWUgc2Vyw6NvIGV4aWJpZG9zIG5vIGNvbXBvbmVudGUuICovXG4gIEBJbnB1dCgndC1pdGVtcycpIHNldCBpdGVtcyh2YWx1ZTogQXJyYXk8YW55Pikge1xuICAgIHRoaXMuX2l0ZW1zID0gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFtdO1xuICB9XG5cbiAgZ2V0IGl0ZW1zKCkge1xuICAgIHJldHVybiB0aGlzLl9pdGVtcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAb3B0aW9uYWxcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIE9iamV0byBjb20gYXMgbGl0ZXJhaXMgdXNhZGFzIG5vIGB0aGYtbGlzdC12aWV3YC5cbiAgICpcbiAgICogRXhpc3RlbSBkdWFzIG1hbmVpcmFzIGRlIGN1c3RvbWl6YXIgbyBjb21wb25lbnRlLCBwYXNzYW5kbyB1bSBvYmpldG8gY29tIHRvZGFzIGFzIGxpdGVyYWlzIGRpc3BvbsOtdmVpczpcbiAgICpcbiAgICogYGBgXG4gICAqICBjb25zdCBjdXN0b21MaXRlcmFsczogVGhmTGlzdFZpZXdMaXRlcmFscyA9IHtcbiAgICogICAgaGlkZURldGFpbDogJ09jdWx0YXIgZGV0YWxoZXMgY29tcGxldGFtZW50ZScsXG4gICAqICAgIGxvYWRNb3JlRGF0YTogJ01haXMgZGFkb3MnLFxuICAgKiAgICBzaG93RGV0YWlsOiAnTW9zdHJhciBtYWlzIGRldGFsaGVzJyxcbiAgICogICAgc2VsZWN0QWxsOiAnU2VsZWNpb25hciB0b2RvcyBvcyBpdGVucydcbiAgICogIH07XG4gICAqIGBgYFxuICAgKlxuICAgKiBPdSBwYXNzYW5kbyBhcGVuYXMgYXMgbGl0ZXJhaXMgcXVlIGRlc2VqYSBjdXN0b21pemFyOlxuICAgKlxuICAgKiBgYGBcbiAgICogIGNvbnN0IGN1c3RvbUxpdGVyYWxzOiBUaGZMaXN0Vmlld0xpdGVyYWxzID0ge1xuICAgKiAgICBzaG93RGV0YWlsOiAnTW9zdHJhciBtYWlzIGRldGFsaGVzJ1xuICAgKiAgfTtcbiAgICogYGBgXG4gICAqXG4gICAqIEUgcGFyYSBjYXJyZWdhciBhcyBsaXRlcmFpcyBjdXN0b21pemFkYXMsIGJhc3RhIGFwZW5hcyBwYXNzYXIgbyBvYmpldG8gcGFyYSBvIGNvbXBvbmVudGUuXG4gICAqXG4gICAqIGBgYFxuICAgKiA8dGhmLWxpc3Qtdmlld1xuICAgKiAgIFt0LWxpdGVyYWxzXT1cImN1c3RvbUxpdGVyYWxzXCI+XG4gICAqIDwvdGhmLWxpc3Qtdmlldz5cbiAgICogYGBgXG4gICAqXG4gICAqID4gTyBvYmpldG8gcGFkcsOjbyBkZSBsaXRlcmFpcyBzZXLDoSB0cmFkdXppZG8gZGUgYWNvcmRvIGNvbSBvIGlkaW9tYSBkbyBicm93c2VyIChwdCwgZW4sIGVzKS5cbiAgICovXG4gIEBJbnB1dCgndC1saXRlcmFscycpIHNldCBsaXRlcmFscyh2YWx1ZTogVGhmTGlzdFZpZXdMaXRlcmFscykge1xuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCAmJiAhKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpKSB7XG4gICAgICB0aGlzLl9saXRlcmFscyA9IHtcbiAgICAgICAgLi4udGhmTGlzdFZpZXdMaXRlcmFsc0RlZmF1bHRbdGhmTG9jYWxlRGVmYXVsdF0sXG4gICAgICAgIC4uLnRoZkxpc3RWaWV3TGl0ZXJhbHNEZWZhdWx0W2Jyb3dzZXJMYW5ndWFnZSgpXSxcbiAgICAgICAgLi4udmFsdWVcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpdGVyYWxzID0gdGhmTGlzdFZpZXdMaXRlcmFsc0RlZmF1bHRbYnJvd3Nlckxhbmd1YWdlKCldO1xuICAgIH1cbiAgfVxuXG4gIGdldCBsaXRlcmFscygpIHtcbiAgICByZXR1cm4gdGhpcy5fbGl0ZXJhbHMgfHwgdGhmTGlzdFZpZXdMaXRlcmFsc0RlZmF1bHRbYnJvd3Nlckxhbmd1YWdlKCldO1xuICB9XG5cbiAgLyoqIFJlY2ViZSB1bWEgcHJvcHJpZWRhZGUgcXVlIHNlcsOhIHV0aWxpemFkYSBwYXJhIHJlY3VwZXJhciBvIHZhbG9yIGRvIG9iamV0byBxdWUgc2Vyw6EgdXNhZG8gY29tbyBsaW5rIHBhcmEgbyB0w610dWxvLiAqL1xuICBASW5wdXQoJ3QtcHJvcGVydHktbGluaycpIHByb3BlcnR5TGluaz86IHN0cmluZztcblxuICAvKiogUmVjZWJlIHVtYSBwcm9wcmllZGFkZSBxdWUgc2Vyw6EgdXRpbGl6YWRhIHBhcmEgcmVjdXBlcmFyIG8gdmFsb3IgZG8gb2JqZXRvIHF1ZSBzZXLDoSBleGliaWRvIGNvbW8gbyB0w610dWxvIGRlIGNhZGEgaXRlbS4gKi9cbiAgQElucHV0KCd0LXByb3BlcnR5LXRpdGxlJykgcHJvcGVydHlUaXRsZT86IHN0cmluZztcblxuICAvKipcbiAgICogQG9wdGlvbmFsXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBIYWJpbGl0YSB1bSAqY2hlY2tib3gqIHBhcmEgY2FkYSBpdGVtIGRhIGxpc3RhLiBUb2RvcyBvcyBpdGVtcyBwb3NzdWVtIGEgcHJvcHJpZWRhZGUgZGluw6JtaWNhIGAkc2VsZWN0ZWRgIHBhcmEgaWRlbnRpZmljYXIgc2Ugb1xuICAgKiBpdGVtIGVzdMOhIHNlbGVjaW9uYWRvLCBwb3IgZXhlbXBsbzpcbiAgICpcbiAgICogYGBgXG4gICAqICBpdGVtLiRzZWxlY3RlZFxuICAgKlxuICAgKiAgLy8gb3VcbiAgICpcbiAgICogIGl0ZW1bJyRzZWxlY3RlZCddXG4gICAqIGBgYFxuICAgKlxuICAgKiBAZGVmYXVsdCBgZmFsc2VgXG4gICAqL1xuICBASW5wdXQoJ3Qtc2VsZWN0Jykgc2V0IHNlbGVjdChzZWxlY3Q6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9zZWxlY3QgPSBjb252ZXJ0VG9Cb29sZWFuKHNlbGVjdCk7XG4gICAgdGhpcy5zaG93TWFpbkhlYWRlcigpO1xuICB9XG5cbiAgZ2V0IHNlbGVjdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fc2VsZWN0O1xuICB9XG5cbiAgLyoqXG4gICAqIEBvcHRpb25hbFxuICAgKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogSW5kaWNhIHF1ZSBvIGJvdMOjbyBgQ2FycmVnYXIgTWFpcyBSZXN1bHRhZG9zYCBzZXLDoSBkZXNhYmlsaXRhZG8uXG4gICAqL1xuICBASW5wdXQoJ3Qtc2hvdy1tb3JlLWRpc2FibGVkJykgc2V0IHNob3dNb3JlRGlzYWJsZWQodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9zaG93TW9yZURpc2FibGVkID0gY29udmVydFRvQm9vbGVhbih2YWx1ZSk7XG4gIH1cblxuICBnZXQgc2hvd01vcmVEaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fc2hvd01vcmVEaXNhYmxlZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWNlYmUgdW1hIGHDp8OjbywgcXVlIHNlcsOhIGV4ZWN1dGFkYSBxdWFuZG8gY2xpY2FyIG5vIGJvdMOjbyBcIkNhcnJlZ2FyIG1haXMgcmVzdWx0YWRvc1wiLlxuICAgKlxuICAgKiA+IENhc28gbmVuaHVtYSBhw6fDo28gZm9yIGRlZmluaWRhIG8gbWVzbW8gbsOjbyBmaWNhcsOhIHZpc8OtdmVsLlxuICAgKi9cbiAgQE91dHB1dCgndC1zaG93LW1vcmUnKSBzaG93TW9yZT86IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgLyoqXG4gICAqIEHDp8OjbyBxdWUgc2Vyw6EgZXhlY3V0YWRhIGFvIGNsaWNhciBubyB0w610dWxvLlxuICAgKlxuICAgKiBBbyBzZXIgZGlzcGFyYWRvLCBvIG3DqXRvZG8gaW5zZXJpZG8gbmEgYcOnw6NvIGlyw6EgcmVjZWJlciBjb21vIHBhcsOibWV0cm8gbyBpdGVtIGRhIGxpc3RhIGNsaWNhZG8uXG4gICAqL1xuICBAT3V0cHV0KCd0LXRpdGxlLWFjdGlvbicpIHRpdGxlQWN0aW9uPzogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBvbkNsaWNrQWN0aW9uKGxpc3RWaWV3QWN0aW9uOiBUaGZMaXN0Vmlld0FjdGlvbiwgaXRlbSkge1xuICAgIGNvbnN0IGNsZWFuSXRlbSA9IHRoaXMuZGVsZXRlSW50ZXJuYWxBdHRycyhpdGVtKTtcbiAgICBpZiAobGlzdFZpZXdBY3Rpb24uYWN0aW9uKSB7XG4gICAgICBsaXN0Vmlld0FjdGlvbi5hY3Rpb24oY2xlYW5JdGVtKTtcbiAgICB9XG4gIH1cblxuICBvblNob3dNb3JlKCk6IHZvaWQge1xuICAgIHRoaXMuc2hvd01vcmUuZW1pdCgpO1xuICB9XG5cbiAgcnVuVGl0bGVBY3Rpb24obGlzdEl0ZW06IGFueSkge1xuICAgIGNvbnN0IGl0ZW1XaXRoUHVibGljUHJvcGVydGllcyA9IHRoaXMuZGVsZXRlSW50ZXJuYWxBdHRycyhsaXN0SXRlbSk7XG4gICAgdGhpcy50aXRsZUFjdGlvbi5lbWl0KGl0ZW1XaXRoUHVibGljUHJvcGVydGllcyk7XG4gIH1cblxuICBzZWxlY3RBbGxMaXN0SXRlbXMoKSB7XG4gICAgaWYgKCF0aGlzLmhpZGVTZWxlY3RBbGwpIHtcbiAgICAgIHRoaXMuc2VsZWN0QWxsID0gIXRoaXMuc2VsZWN0QWxsO1xuXG4gICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGl0ZW0uJHNlbGVjdGVkID0gdGhpcy5zZWxlY3RBbGw7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBzZWxlY3RMaXN0SXRlbShyb3c6IGFueSkge1xuICAgIHJvdy4kc2VsZWN0ZWQgPSAhcm93LiRzZWxlY3RlZDtcblxuICAgIHRoaXMuc2VsZWN0QWxsID0gdGhpcy5jaGVja0lmSXRlbXNBcmVTZWxlY3RlZCh0aGlzLml0ZW1zKTtcbiAgfVxuXG4gIHByaXZhdGUgZGVsZXRlSW50ZXJuYWxBdHRycyhpdGVtKSB7XG4gICAgY29uc3QgaXRlbUNvcHkgPSBpdGVtID8geyAuLi5pdGVtIH0gOiB1bmRlZmluZWQ7XG5cbiAgICBmb3IgKGNvbnN0IGtleSBpbiBpdGVtQ29weSkge1xuICAgICAgaWYgKGl0ZW1Db3B5Lmhhc093blByb3BlcnR5KGtleSkgJiYga2V5LnN0YXJ0c1dpdGgoJyQnKSkge1xuICAgICAgICBkZWxldGUgaXRlbUNvcHlba2V5XTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaXRlbUNvcHk7XG4gIH1cblxuICBwcml2YXRlIGNoZWNrSWZJdGVtc0FyZVNlbGVjdGVkKGl0ZW1zOiBBcnJheTxhbnk+KTogYm9vbGVhbiB7XG4gICAgY29uc3Qgc29tZUNoZWNrZWRPckluZGV0ZXJtaW5hdGUgPSBpdGVtID0+IGl0ZW0uJHNlbGVjdGVkIHx8IGl0ZW0uJHNlbGVjdGVkID09PSBudWxsO1xuICAgIGNvbnN0IGV2ZXJ5Q2hlY2tlZCA9IGl0ZW0gPT4gaXRlbS4kc2VsZWN0ZWQ7XG5cbiAgICBpZiAoaXRlbXMuZXZlcnkoZXZlcnlDaGVja2VkKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGl0ZW1zLnNvbWUoc29tZUNoZWNrZWRPckluZGV0ZXJtaW5hdGUpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBwcml2YXRlIHNob3dNYWluSGVhZGVyKCkge1xuICAgIHRoaXMuc2hvd0hlYWRlciA9ICEhKHRoaXMuc2VsZWN0ICYmICF0aGlzLmhpZGVTZWxlY3RBbGwgJiYgdGhpcy5pdGVtcyAmJiB0aGlzLml0ZW1zLmxlbmd0aCk7XG4gIH1cblxufVxuIl19