/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, EventEmitter, HostListener, Input, Output, ViewChild } from '@angular/core';
import { ThfMultiselectSearchComponent } from './../thf-multiselect-search/thf-multiselect-search.component';
/**
 * \@docsPrivate
 *
 * \@description
 *
 * Componente que construíra o dropdown, contendo o campo de pesquisa e os itens para seleção.
 */
var ThfMultiselectDropdownComponent = /** @class */ (function () {
    function ThfMultiselectDropdownComponent() {
        this.scrollTop = 0;
        this.show = false;
        this.haveOptions = false;
        /**
         * Propriedade que indica se o campo de pesquisa deverá ser escondido.
         */
        this.hideSearch = false;
        /**
         * Propriedade que recebe a lista de opções selecionadas.
         */
        this.selectedValues = [];
        /**
         * Propriedade que recebe a lista de opções que deverão ser criadas no dropdown.
         */
        this.options = [];
        /**
         * Evento disparado a cada tecla digitada na pesquisa.
         */
        this.changeSearch = new EventEmitter();
        /**
         * Evento disparado a cada alteração na lista das opções selecionadas.
         */
        this.change = new EventEmitter();
        /**
         * Evento disparado quando for detectada uma ação que necessite fechar o dropdown.
         * Por exemplo, no caso de ser teclado TAB dentro do dropdown, então é disparado este evento
         * para notificar o componente principal que deve fechar o dropdown.
         */
        this.closeDropdown = new EventEmitter();
    }
    /**
     * @param {?} index
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.scrollTo = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.scrollTop = (index <= 2) ? 0 : (index * 44) - 88;
    };
    /**
     * @param {?} option
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.isSelectedItem = /**
     * @param {?} option
     * @return {?}
     */
    function (option) {
        return this.selectedValues.some((/**
         * @param {?} selectedItem
         * @return {?}
         */
        function (selectedItem) { return selectedItem === option.value; }));
    };
    /**
     * @param {?} check
     * @param {?} option
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.clickItem = /**
     * @param {?} check
     * @param {?} option
     * @return {?}
     */
    function (check, option) {
        this.updateSelectedValues(check, option);
        if (!this.hideSearch) {
            this.searchElement.setFocus();
        }
    };
    /**
     * @param {?} checked
     * @param {?} option
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.updateSelectedValues = /**
     * @param {?} checked
     * @param {?} option
     * @return {?}
     */
    function (checked, option) {
        if (checked) {
            this.selectedValues.push(option.value);
        }
        else {
            /** @type {?} */
            var indexSelectedValues = this.selectedValues.indexOf(option.value);
            this.selectedValues.splice(indexSelectedValues, 1);
        }
        this.change.emit(this.selectedValues);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.callChangeSearch = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.changeSearch.emit(event);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.onKeydown = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.keyCode === 9) {
            this.closeDropdown.emit();
        }
    };
    /**
     * @param {?} toOpen
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.controlVisibility = /**
     * @param {?} toOpen
     * @return {?}
     */
    function (toOpen) {
        var _this = this;
        this.show = toOpen;
        this.checkInitialOptions();
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (toOpen && _this.searchElement && !_this.hideSearch) {
                _this.searchElement.setFocus();
                _this.searchElement.clean();
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    ThfMultiselectDropdownComponent.prototype.checkInitialOptions = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.options.length) {
            this.haveOptions = true;
        }
    };
    ThfMultiselectDropdownComponent.decorators = [
        { type: Component, args: [{
                    selector: 'thf-multiselect-dropdown',
                    template: "<div #container class=\"thf-multiselect-container\" [hidden]=\"!show\">\n\n  <thf-multiselect-search #searchElement\n    *ngIf=\"!hideSearch && haveOptions\"\n    [t-literals]=\"literals\"\n    [t-placeholder]=\"placeholderSearch\"\n    (t-change)=\"callChangeSearch($event)\">\n  </thf-multiselect-search>\n\n  <ul class=\"thf-multiselect-items-container\" [scrollTop]=\"scrollTop\" #ulElement>\n    <div *ngIf=\"!options.length\" class=\"thf-multiselect-container-no-data thf-text-center\">\n      <span> {{ literals.noData }}</span>\n    </div>\n\n    <thf-multiselect-item *ngFor=\"let option of options\"\n      [t-option]=\"option\"\n      [t-selected]=\"isSelectedItem(option)\"\n      (t-change)=\"clickItem($event, option)\">\n    </thf-multiselect-item>\n  </ul>\n</div>\n"
                }] }
    ];
    ThfMultiselectDropdownComponent.propDecorators = {
        hideSearch: [{ type: Input, args: ['t-hide-search',] }],
        literals: [{ type: Input, args: ['t-literals',] }],
        placeholderSearch: [{ type: Input, args: ['t-placeholder-search',] }],
        selectedValues: [{ type: Input, args: ['t-selected-values',] }],
        options: [{ type: Input, args: ['t-options',] }],
        changeSearch: [{ type: Output, args: ['t-change-search',] }],
        change: [{ type: Output, args: ['t-change',] }],
        closeDropdown: [{ type: Output, args: ['t-close-dropdown',] }],
        container: [{ type: ViewChild, args: ['container', { read: ElementRef, static: true },] }],
        ulElement: [{ type: ViewChild, args: ['ulElement', { read: ElementRef, static: true },] }],
        searchElement: [{ type: ViewChild, args: ['searchElement', { static: false },] }],
        onKeydown: [{ type: HostListener, args: ['keydown', ['$event'],] }]
    };
    return ThfMultiselectDropdownComponent;
}());
export { ThfMultiselectDropdownComponent };
if (false) {
    /** @type {?} */
    ThfMultiselectDropdownComponent.prototype.scrollTop;
    /** @type {?} */
    ThfMultiselectDropdownComponent.prototype.show;
    /** @type {?} */
    ThfMultiselectDropdownComponent.prototype.haveOptions;
    /**
     * Propriedade que indica se o campo de pesquisa deverá ser escondido.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.hideSearch;
    /**
     * Propriedade que que recebe as literais definidas no componente `thf-multiselect`.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.literals;
    /**
     * Placeholder do campo de pesquisa.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.placeholderSearch;
    /**
     * Propriedade que recebe a lista de opções selecionadas.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.selectedValues;
    /**
     * Propriedade que recebe a lista de opções que deverão ser criadas no dropdown.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.options;
    /**
     * Evento disparado a cada tecla digitada na pesquisa.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.changeSearch;
    /**
     * Evento disparado a cada alteração na lista das opções selecionadas.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.change;
    /**
     * Evento disparado quando for detectada uma ação que necessite fechar o dropdown.
     * Por exemplo, no caso de ser teclado TAB dentro do dropdown, então é disparado este evento
     * para notificar o componente principal que deve fechar o dropdown.
     * @type {?}
     */
    ThfMultiselectDropdownComponent.prototype.closeDropdown;
    /** @type {?} */
    ThfMultiselectDropdownComponent.prototype.container;
    /** @type {?} */
    ThfMultiselectDropdownComponent.prototype.ulElement;
    /** @type {?} */
    ThfMultiselectDropdownComponent.prototype.searchElement;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhmLW11bHRpc2VsZWN0LWRyb3Bkb3duLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0b3R2cy90aGYtdWkvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90aGYtZmllbGQvdGhmLW11bHRpc2VsZWN0L3RoZi1tdWx0aXNlbGVjdC1kcm9wZG93bi90aGYtbXVsdGlzZWxlY3QtZHJvcGRvd24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSTVHLE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxNQUFNLDhEQUE4RCxDQUFDOzs7Ozs7OztBQVM3RztJQUFBO1FBTUUsY0FBUyxHQUFHLENBQUMsQ0FBQztRQUNkLFNBQUksR0FBWSxLQUFLLENBQUM7UUFDdEIsZ0JBQVcsR0FBWSxLQUFLLENBQUM7Ozs7UUFHTCxlQUFVLEdBQWEsS0FBSyxDQUFDOzs7O1FBU3pCLG1CQUFjLEdBQWUsRUFBRSxDQUFDOzs7O1FBR3hDLFlBQU8sR0FBZ0MsRUFBRSxDQUFDOzs7O1FBR25DLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7OztRQUd6QyxXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7Ozs7O1FBT3BCLGtCQUFhLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztJQThEakUsQ0FBQzs7Ozs7SUF4REMsa0RBQVE7Ozs7SUFBUixVQUFTLEtBQUs7UUFDWixJQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN4RCxDQUFDOzs7OztJQUVELHdEQUFjOzs7O0lBQWQsVUFBZSxN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QUFFLENBQUMsUUFBUSxDQUFDOztJQXlCckMsc0NBQUM7Q0FBQSxBQWxHRCxJQWtHQztTQTlGWSwrQkFBK0I7OztJQUUxQyxvREFBYzs7SUFDZCwrQ0FBc0I7O0lBQ3RCLHNEQUE2Qjs7Ozs7SUFHN0IscURBQXFEOzs7OztJQUdyRCxtREFBdUQ7Ozs7O0lBR3ZELDREQUF5RDs7Ozs7SUFHekQseURBQTREOzs7OztJQUc1RCxrREFBOEQ7Ozs7O0lBRzlELHVEQUE2RDs7Ozs7SUFHN0QsaURBQWdEOzs7Ozs7O0lBT2hELHdEQUErRDs7SUFFL0Qsb0RBQWtGOztJQUNsRixvREFBaUY7O0lBQ2pGLHdEQUE0RiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBIb3N0TGlzdGVuZXIsIElucHV0LCBPdXRwdXQsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBUaGZNdWx0aXNlbGVjdExpdGVyYWxzIH0gZnJvbSAnLi4vLi4vaW5kZXgnO1xuaW1wb3J0IHsgVGhmTXVsdGlzZWxlY3RPcHRpb24gfSBmcm9tICcuLi90aGYtbXVsdGlzZWxlY3Qtb3B0aW9uLmludGVyZmFjZSc7XG5pbXBvcnQgeyBUaGZNdWx0aXNlbGVjdFNlYXJjaENvbXBvbmVudCB9IGZyb20gJy4vLi4vdGhmLW11bHRpc2VsZWN0LXNlYXJjaC90aGYtbXVsdGlzZWxlY3Qtc2VhcmNoLmNvbXBvbmVudCc7XG5cbi8qKlxuICogQGRvY3NQcml2YXRlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKlxuICogQ29tcG9uZW50ZSBxdWUgY29uc3RydcOtcmEgbyBkcm9wZG93biwgY29udGVuZG8gbyBjYW1wbyBkZSBwZXNxdWlzYSBlIG9zIGl0ZW5zIHBhcmEgc2VsZcOnw6NvLlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0aGYtbXVsdGlzZWxlY3QtZHJvcGRvd24nLFxuICB0ZW1wbGF0ZVVybDogJy4vdGhmLW11bHRpc2VsZWN0LWRyb3Bkb3duLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBUaGZNdWx0aXNlbGVjdERyb3Bkb3duQ29tcG9uZW50IHtcblxuICBzY3JvbGxUb3AgPSAwO1xuICBzaG93OiBib29sZWFuID0gZmFsc2U7XG4gIGhhdmVPcHRpb25zOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLyoqIFByb3ByaWVkYWRlIHF1ZSBpbmRpY2Egc2UgbyBjYW1wbyBkZSBwZXNxdWlzYSBkZXZlcsOhIHNlciBlc2NvbmRpZG8uICovXG4gIEBJbnB1dCgndC1oaWRlLXNlYXJjaCcpIGhpZGVTZWFyY2g/OiBib29sZWFuID0gZmFsc2U7XG5cbiAgLyoqIFByb3ByaWVkYWRlIHF1ZSBxdWUgcmVjZWJlIGFzIGxpdGVyYWlzIGRlZmluaWRhcyBubyBjb21wb25lbnRlIGB0aGYtbXVsdGlzZWxlY3RgLiAqL1xuICBASW5wdXQoJ3QtbGl0ZXJhbHMnKSBsaXRlcmFscz86IFRoZk11bHRpc2VsZWN0TGl0ZXJhbHM7XG5cbiAgLyoqIFBsYWNlaG9sZGVyIGRvIGNhbXBvIGRlIHBlc3F1aXNhLiAqL1xuICBASW5wdXQoJ3QtcGxhY2Vob2xkZXItc2VhcmNoJykgcGxhY2Vob2xkZXJTZWFyY2g6IHN0cmluZztcblxuICAvKiogUHJvcHJpZWRhZGUgcXVlIHJlY2ViZSBhIGxpc3RhIGRlIG9ww6fDtWVzIHNlbGVjaW9uYWRhcy4gKi9cbiAgQElucHV0KCd0LXNlbGVjdGVkLXZhbHVlcycpIHNlbGVjdGVkVmFsdWVzOiBBcnJheTxhbnk+ID0gW107XG5cbiAgLyoqIFByb3ByaWVkYWRlIHF1ZSByZWNlYmUgYSBsaXN0YSBkZSBvcMOnw7VlcyBxdWUgZGV2ZXLDo28gc2VyIGNyaWFkYXMgbm8gZHJvcGRvd24uICovXG4gIEBJbnB1dCgndC1vcHRpb25zJykgb3B0aW9uczogQXJyYXk8VGhmTXVsdGlzZWxlY3RPcHRpb24+ID0gW107XG5cbiAgLyoqIEV2ZW50byBkaXNwYXJhZG8gYSBjYWRhIHRlY2xhIGRpZ2l0YWRhIG5hIHBlc3F1aXNhLiAqL1xuICBAT3V0cHV0KCd0LWNoYW5nZS1zZWFyY2gnKSBjaGFuZ2VTZWFyY2ggPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgLyoqIEV2ZW50byBkaXNwYXJhZG8gYSBjYWRhIGFsdGVyYcOnw6NvIG5hIGxpc3RhIGRhcyBvcMOnw7VlcyBzZWxlY2lvbmFkYXMuICovXG4gIEBPdXRwdXQoJ3QtY2hhbmdlJykgY2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIC8qKlxuICAgKiBFdmVudG8gZGlzcGFyYWRvIHF1YW5kbyBmb3IgZGV0ZWN0YWRhIHVtYSBhw6fDo28gcXVlIG5lY2Vzc2l0ZSBmZWNoYXIgbyBkcm9wZG93bi5cbiAgICogUG9yIGV4ZW1wbG8sIG5vIGNhc28gZGUgc2VyIHRlY2xhZG8gVEFCIGRlbnRybyBkbyBkcm9wZG93biwgZW50w6NvIMOpIGRpc3BhcmFkbyBlc3RlIGV2ZW50b1xuICAgKiBwYXJhIG5vdGlmaWNhciBvIGNvbXBvbmVudGUgcHJpbmNpcGFsIHF1ZSBkZXZlIGZlY2hhciBvIGRyb3Bkb3duLlxuICAgKi9cbiAgQE91dHB1dCgndC1jbG9zZS1kcm9wZG93bicpIGNsb3NlRHJvcGRvd24gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgQFZpZXdDaGlsZCgnY29udGFpbmVyJywgeyByZWFkOiBFbGVtZW50UmVmLCBzdGF0aWM6IHRydWUgfSkgY29udGFpbmVyOiBFbGVtZW50UmVmO1xuICBAVmlld0NoaWxkKCd1bEVsZW1lbnQnLCB7cmVhZDogRWxlbWVudFJlZiwgc3RhdGljOiB0cnVlIH0pIHVsRWxlbWVudDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnc2VhcmNoRWxlbWVudCcsIHsgc3RhdGljOiBmYWxzZSB9KSBzZWFyY2hFbGVtZW50OiBUaGZNdWx0aXNlbGVjdFNlYXJjaENvbXBvbmVudDtcblxuICBzY3JvbGxUbyhpbmRleCkge1xuICAgIHRoaXMuc2Nyb2xsVG9wID0gKGluZGV4IDw9IDIpID8gMCA6IChpbmRleCAqIDQ0KSAtIDg4O1xuICB9XG5cbiAgaXNTZWxlY3RlZEl0ZW0ob3B0aW9uOiBUaGZNdWx0aXNlbGVjdE9wdGlvbikge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdGVkVmFsdWVzLnNvbWUoc2VsZWN0ZWRJdGVtID0+IHNlbGVjdGVkSXRlbSA9PT0gb3B0aW9uLnZhbHVlKTtcbiAgfVxuXG4gIGNsaWNrSXRlbShjaGVjaywgb3B0aW9uKSB7XG4gICAgdGhpcy51cGRhdGVTZWxlY3RlZFZhbHVlcyhjaGVjaywgb3B0aW9uKTtcblxuICAgIGlmICghdGhpcy5oaWRlU2VhcmNoKSB7XG4gICAgICB0aGlzLnNlYXJjaEVsZW1lbnQuc2V0Rm9jdXMoKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVTZWxlY3RlZFZhbHVlcyhjaGVja2VkLCBvcHRpb24pIHtcbiAgICBpZiAoY2hlY2tlZCkge1xuICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcy5wdXNoKG9wdGlvbi52YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGluZGV4U2VsZWN0ZWRWYWx1ZXMgPSB0aGlzLnNlbGVjdGVkVmFsdWVzLmluZGV4T2Yob3B0aW9uLnZhbHVlKTtcbiAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMuc3BsaWNlKGluZGV4U2VsZWN0ZWRWYWx1ZXMsIDEpO1xuICAgIH1cblxuICAgIHRoaXMuY2hhbmdlLmVtaXQodGhpcy5zZWxlY3RlZFZhbHVlcyk7XG4gIH1cblxuICBjYWxsQ2hhbmdlU2VhcmNoKGV2ZW50KSB7XG4gICAgdGhpcy5jaGFuZ2VTZWFyY2guZW1pdChldmVudCk7XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcbiAgb25LZXlkb3duKGV2ZW50OiBhbnkpIHtcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gOSkge1xuICAgICAgdGhpcy5jbG9zZURyb3Bkb3duLmVtaXQoKTtcbiAgICB9XG4gIH1cblxuICBjb250cm9sVmlzaWJpbGl0eSh0b09wZW4pIHtcbiAgICB0aGlzLnNob3cgPSB0b09wZW47XG4gICAgdGhpcy5jaGVja0luaXRpYWxPcHRpb25zKCk7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmICh0b09wZW4gJiYgdGhpcy5zZWFyY2hFbGVtZW50ICYmICF0aGlzLmhpZGVTZWFyY2gpIHtcbiAgICAgICAgdGhpcy5zZWFyY2hFbGVtZW50LnNldEZvY3VzKCk7XG4gICAgICAgIHRoaXMuc2VhcmNoRWxlbWVudC5jbGVhbigpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBjaGVja0luaXRpYWxPcHRpb25zKCkge1xuICAgIGlmICh0aGlzLm9wdGlvbnMubGVuZ3RoKSB7XG4gICAgICB0aGlzLmhhdmVPcHRpb25zID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxufVxuIl19